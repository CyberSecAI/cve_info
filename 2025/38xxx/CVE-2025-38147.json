{
    "cveId": "CVE-2025-38147",
    "version": "1.0.0",
    "timestamp": "2025-07-05T08:16:57.403025+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved calipso Dont call calipso functions for AF_INET sk. syzkaller reported a null-ptr-deref in txopt_get(). [0] The offset 0x70 was of struct ipv6_txoptions in struct ipv6_pinfo, so struct ipv6_pinfo was NULL there. However, this never happens for IPv6 sockets as inet_sk(sk)->pinet6 is always set in inet6_create(), meaning the socket was not IPv6 one. The root cause is missing validation in netlbl_conn_setattr(). netlbl_conn_setattr() switches branches based on struct sockaddr.sa_family, which is passed from userspace. However, netlbl_conn_setattr() does not check if the address family matches the socket. The syzkaller must have called connect() for an IPv6 address on an IPv4 socket. We have a proper validation in tcp_v[46]_connect(), but security_socket_connect() is called in the earlier stage. Lets copy the validation to netlbl_conn_setattr(). [0] Oops general protection fault, probably for non-canonical address 0xdffffc000000000e 0000",
    "keyphrases": {
        "rootcause": "missing validation in netlbl_conn_setattr()",
        "weakness": "null-ptr-deref",
        "impact": "Oops general protection fault",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "txopt_get()"
    }
}
