{
    "cveId": "CVE-2025-38150",
    "version": "1.0.0",
    "timestamp": "2025-07-05T08:16:57.403025+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved af_packet move notifiers packet_dev_mc out of rcu critical section Syzkaller reports the following issue BUG sleeping function called from invalid context at kernel/locking/mutex.c578 __mutex_lock+0x106/0xe80 kernel/locking/mutex.c746 team_change_rx_flags+0x38/0x220 drivers/net/team/team_core.c1781 dev_change_rx_flags net/core/dev.c9145 [inline] __dev_set_promiscuity+0x3f8/0x590 net/core/dev.c9189 netif_set_promiscuity+0x50/0xe0 net/core/dev.c9201 dev_set_promiscuity+0x126/0x260 net/core/dev_api.c286 packet_dev_mc net/packet/af_packet.c3698 [inline] packet_dev_mclist_delete net/packet/af_packet.c3722 [inline] packet_notifier+0x292/0xa60 net/packet/af_packet.c4247 notifier_call_chain+0x1b3/0x3e0 kernel/notifier.c85 call_netdevice_notifiers_extack net/core/dev.c2214 [inline] call_netdevice_notifiers net/core/dev.c2228 [inline] unregister_netdevice_many_notify+0x15d8/0x2330 net/core/dev.c11972 rtnl_delete_link net/core/rtnetlink.c3522 [inline] rtnl_dellink+0x488/0x710 net/core/rtnetlink.c3564 rtnetlink_rcv_msg+0x7cf/0xb70 net/core/rtnetlink.c6955 netlink_rcv_skb+0x219/0x490 net/netlink/af_netlink.c2534 Calling `PACKET_ADD_MEMBERSHIP` on an ops-locked device can trigger the `NETDEV_UNREGISTER` notifier, which may require disabling promiscuous and/or allmulti mode. Both of these operations require acquiring the netdev instance lock. Move the call to `packet_dev_mc` outside of the RCU critical section. The `mclist` modifications (add, del, flush, unregister) are protected by the RTNL, not the RCU. The RCU only protects the `sklist` and its associated `sks`. The delayed operation on the `mclist` entry remains within the RTNL.",
    "keyphrases": {
        "rootcause": "sleeping function called from invalid context",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "af_packet move notifiers packet_dev_mc out of rcu critical section Syzkaller reports"
    }
}
