{
    "cveId": "CVE-2025-38117",
    "version": "1.0.0",
    "timestamp": "2025-07-05T08:16:57.403025+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved Bluetooth MGMT Protect mgmt_pending list with its own lock This uses a mutex to protect from concurrent access of mgmt_pending list which can cause crashes like ================================================================== BUG KASAN slab-use-after-free in hci_sock_get_channel+0x60/0x68 net/bluetooth/hci_sock.c91 Read of size 2 at addr ffff0000c48885b2 by task syz.4.334/7318 CPU 0 UID 0 PID 7318 Comm syz.4.334 Not tainted 6.15.0-rc7-syzkaller-g187899f4124a #0 PREEMPT Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 02/12/2025 Call trace show_stack+0x2c/0x3c arch/arm64/kernel/stacktrace.c466 (C) __dump_stack+0x30/0x40 lib/dump_stack.c94 dump_stack_lvl+0xd8/0x12c lib/dump_stack.c120 print_address_description+0xa8/0x254 mm/kasan/report.c408 print_report+0x68/0x84 mm/kasan/report.c521 kasan_report+0xb0/0x110 mm/kasan/report.c634 __asan_report_load2_noabort+0x20/0x2c mm/kasan/report_generic.c379 hci_sock_get_channel+0x60/0x68 net/bluetooth/hci_sock.c91 mgmt_pending_find+0x7c/0x140 net/bluetooth/mgmt_util.c223 pending_find net/bluetooth/mgmt.c947 [inline] remove_adv_monitor+0x44/0x1a4 net/bluetooth/mgmt.c5445 hci_mgmt_cmd+0x780/0xc00 net/bluetooth/hci_sock.c1712 hci_sock_sendmsg+0x544/0xbb0 net/bluetooth/hci_sock.c1832 sock_sendmsg_nosec net/socket.c712 [inline] __sock_sendmsg net/socket.c727 [inline] sock_write_iter+0x25c/0x378 net/socket.c1131 new_sync_write fs/read_write.c591 [inline] vfs_write+0x62c/0x97c fs/read_write.c684 ksys_write+0x120/0x210 fs/read_write.c736 __do_sys_write fs/read_write.c747 [inline] __se_sys_write fs/read_write.c744 [inline] __arm64_sys_write+0x7c/0x90 fs/read_write.c744 __invoke_syscall arch/arm64/kernel/syscall.c35 [inline] invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c49 el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c132 do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c151 el0_svc+0x58/0x17c arch/arm64/kernel/entry-common.c767 el0t_64_sync_handler+0x78/0x108 arch/arm64/kernel/entry-common.c786 el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S600 Allocated by task 7037 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x40/0x78 mm/kasan/common.c68 kasan_save_alloc_info+0x44/0x54 mm/kasan/generic.c562 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0x9c/0xb4 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __do_kmalloc_node mm/slub.c4327 [inline] __kmalloc_noprof+0x2fc/0x4c8 mm/slub.c4339 kmalloc_noprof include/linux/slab.h909 [inline] sk_prot_alloc+0xc4/0x1f0 net/core/sock.c2198 sk_alloc+0x44/0x3ac net/core/sock.c2254 bt_sock_alloc+0x4c/0x300 net/bluetooth/af_bluetooth.c148 hci_sock_create+0xa8/0x194 net/bluetooth/hci_sock.c2202 bt_sock_create+0x14c/0x24c net/bluetooth/af_bluetooth.c132 __sock_create+0x43c/0x91c net/socket.c1541 sock_create net/socket.c1599 [inline] __sys_socket_create net/socket.c1636 [inline] __sys_socket+0xd4/0x1c0 net/socket.c1683 __do_sys_socket net/socket.c1697 [inline] __se_sys_socket net/socket.c1695 [inline] __arm64_sys_socket+0x7c/0x94 net/socket.c1695 __invoke_syscall arch/arm64/kernel/syscall.c35 [inline] invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c49 el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c132 do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c151 el0_svc+0x58/0x17c arch/arm64/kernel/entry-common.c767 el0t_64_sync_handler+0x78/0x108 arch/arm64/kernel/entry-common.c786 el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S600 Freed by task 6607 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x40/0x78 mm/kasan/common.c68 kasan_save_free_info+0x58/0x70 mm/kasan/generic.c576 poison_slab_object mm/kasan/common.c247 [inline] __kasan_slab_free+0x68/0x88 mm/kasan/common.c264 kasan_slab_free include/linux/kasan.h233 [inline ---truncated---",
    "keyphrases": {
        "rootcause": "",
        "weakness": "slab-use-after-free",
        "impact": "crashes like",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "Bluetooth MGMT"
    }
}
