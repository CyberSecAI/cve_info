{
  "cveId": "CVE-2025-38163",
  "version": "1.0.0",
  "timestamp": "2025-07-05T08:28:55.679704+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved f2fs fix to do sanity check on sbi->total_valid_block_count syzbot reported a f2fs bug as below ------------[ cut here ]------------ kernel BUG at fs/f2fs/f2fs.h2521! RIP 0010dec_valid_block_count+0x3b2/0x3c0 fs/f2fs/f2fs.h2521 Call Trace f2fs_truncate_data_blocks_range+0xc8c/0x11a0 fs/f2fs/file.c695 truncate_dnode+0x417/0x740 fs/f2fs/node.c973 truncate_nodes+0x3ec/0xf50 fs/f2fs/node.c1014 f2fs_truncate_inode_blocks+0x8e3/0x1370 fs/f2fs/node.c1197 f2fs_do_truncate_blocks+0x840/0x12b0 fs/f2fs/file.c810 f2fs_truncate_blocks+0x10d/0x300 fs/f2fs/file.c838 f2fs_truncate+0x417/0x720 fs/f2fs/file.c888 f2fs_setattr+0xc4f/0x12f0 fs/f2fs/file.c1112 notify_change+0xbca/0xe90 fs/attr.c552 do_truncate+0x222/0x310 fs/open.c65 handle_truncate fs/namei.c3466 [inline] do_open fs/namei.c3849 [inline] path_openat+0x2e4f/0x35d0 fs/namei.c4004 do_filp_open+0x284/0x4e0 fs/namei.c4031 do_sys_openat2+0x12b/0x1d0 fs/open.c1429 do_sys_open fs/open.c1444 [inline] __do_sys_creat fs/open.c1522 [inline] __se_sys_creat fs/open.c1516 [inline] __x64_sys_creat+0x124/0x170 fs/open.c1516 do_syscall_x64 arch/x86/entry/syscall_64.c63 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/syscall_64.c94 The reason is in fuzzed image, sbi->total_valid_block_count is inconsistent w/ mapped blocks indexed by inode, so, we should not trigger panic for such case, instead, lets print log and set fsck flag.",
  "keyphrases": {
    "rootcause": "sbi->total_valid_block_count is inconsistent w/ mapped blocks indexed by inode",
    "weakness": "",
    "impact": [
      "kernel BUG",
      "panic"
    ],
    "vector": "",
    "attacker": "syzbot",
    "product": "Linux kernel",
    "version": "",
    "component": "f2fs"
  },
  "mitreTechnicalImpacts": []
}