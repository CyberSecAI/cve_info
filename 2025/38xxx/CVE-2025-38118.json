{
    "cveId": "CVE-2025-38118",
    "version": "1.0.0",
    "timestamp": "2025-07-05T08:16:57.403025+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved Bluetooth MGMT Fix UAF on mgmt_remove_adv_monitor_complete This reworks MGMT_OP_REMOVE_ADV_MONITOR to not use mgmt_pending_add to avoid crashes like bellow ================================================================== BUG KASAN slab-use-after-free in mgmt_remove_adv_monitor_complete+0xe5/0x540 net/bluetooth/mgmt.c5406 Read of size 8 at addr ffff88801c53f318 by task kworker/u55/5341 CPU 0 UID 0 PID 5341 Comm kworker/u55 Not tainted 6.15.0-syzkaller-10402-g4cb6c8af8591 #0 PREEMPT(full) Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014 Workqueue hci0 hci_cmd_sync_work Call Trace dump_stack_lvl+0x189/0x250 lib/dump_stack.c120 print_address_description mm/kasan/report.c408 [inline] print_report+0xd2/0x2b0 mm/kasan/report.c521 kasan_report+0x118/0x150 mm/kasan/report.c634 mgmt_remove_adv_monitor_complete+0xe5/0x540 net/bluetooth/mgmt.c5406 hci_cmd_sync_work+0x261/0x3a0 net/bluetooth/hci_sync.c334 process_one_work kernel/workqueue.c3238 [inline] process_scheduled_works+0xade/0x17b0 kernel/workqueue.c3321 worker_thread+0x8a0/0xda0 kernel/workqueue.c3402 kthread+0x711/0x8a0 kernel/kthread.c464 ret_from_fork+0x3fc/0x770 arch/x86/kernel/process.c148 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S245 Allocated by task 5987 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3e/0x80 mm/kasan/common.c68 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0x93/0xb0 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __kmalloc_cache_noprof+0x230/0x3d0 mm/slub.c4358 kmalloc_noprof include/linux/slab.h905 [inline] kzalloc_noprof include/linux/slab.h1039 [inline] mgmt_pending_new+0x65/0x240 net/bluetooth/mgmt_util.c252 mgmt_pending_add+0x34/0x120 net/bluetooth/mgmt_util.c279 remove_adv_monitor+0x103/0x1b0 net/bluetooth/mgmt.c5454 hci_mgmt_cmd+0x9c9/0xef0 net/bluetooth/hci_sock.c1719 hci_sock_sendmsg+0x6ca/0xef0 net/bluetooth/hci_sock.c1839 sock_sendmsg_nosec net/socket.c712 [inline] __sock_sendmsg+0x219/0x270 net/socket.c727 sock_write_iter+0x258/0x330 net/socket.c1131 new_sync_write fs/read_write.c593 [inline] vfs_write+0x548/0xa90 fs/read_write.c686 ksys_write+0x145/0x250 fs/read_write.c738 do_syscall_x64 arch/x86/entry/syscall_64.c63 [inline] do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c94 entry_SYSCALL_64_after_hwframe+0x77/0x7f Freed by task 5989 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3e/0x80 mm/kasan/common.c68 kasan_save_free_info+0x46/0x50 mm/kasan/generic.c576 poison_slab_object mm/kasan/common.c247 [inline] __kasan_slab_free+0x62/0x70 mm/kasan/common.c264 kasan_slab_free include/linux/kasan.h233 [inline] slab_free_hook mm/slub.c2380 [inline] slab_free mm/slub.c4642 [inline] kfree+0x18e/0x440 mm/slub.c4841 mgmt_pending_foreach+0xc9/0x120 net/bluetooth/mgmt_util.c242 mgmt_index_removed+0x10d/0x2f0 net/bluetooth/mgmt.c9366 hci_sock_bind+0xbe9/0x1000 net/bluetooth/hci_sock.c1314 __sys_bind_socket net/socket.c1810 [inline] __sys_bind+0x2c3/0x3e0 net/socket.c1841 __do_sys_bind net/socket.c1846 [inline] __se_sys_bind net/socket.c1844 [inline] __x64_sys_bind+0x7a/0x90 net/socket.c1844 do_syscall_x64 arch/x86/entry/syscall_64.c63 [inline] do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c94 entry_SYSCALL_64_after_hwframe+0x77/0x7f",
    "keyphrases": {
        "rootcause": "slab-use-after-free",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "",
        "version": "",
        "component": "Linux kernel Bluetooth MGMT"
    }
}
