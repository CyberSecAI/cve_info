{
    "cveId": "CVE-2025-38216",
    "version": "1.0.0",
    "timestamp": "2025-07-05T08:28:55.679704+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved iommu/vt-d Restore context entry setup order for aliased devices Commit 2031c469f816 (iommu/vt-d Add support for static identity domain) changed the context entry setup during domain attachment from a set-and-check policy to a clear-and-reset approach. This inadvertently introduced a regression affecting PCI aliased devices behind PCIe-to-PCI bridges. Specifically, keyboard and touchpad stopped working on several Apple Macbooks with below messages kernel platform pxa2xx-spi.3 Adding to iommu group 20 kernel input Apple SPI Keyboard as /devices/pci000000/0000001e.3/pxa2xx-spi.3/spi_master/spi2/spi-APP000D00/input/input0 kernel DMAR DRHD handling fault status reg 3 kernel DMAR [DMA Read NO_PASID] Request device [001e.3] fault addr 0xffffa000 [fault reason 0x06] PTE Read access is not set kernel DMAR DRHD handling fault status reg 3 kernel DMAR [DMA Read NO_PASID] Request device [001e.3] fault addr 0xffffa000 [fault reason 0x06] PTE Read access is not set kernel applespi spi-APP000D00 Error writing to device 01 0e 00 00 kernel DMAR DRHD handling fault status reg 3 kernel DMAR [DMA Read NO_PASID] Request device [001e.3] fault addr 0xffffa000 [fault reason 0x06] PTE Read access is not set kernel DMAR DRHD handling fault status reg 3 kernel applespi spi-APP000D00 Error writing to device 01 0e 00 00 Fix this by restoring the previous context setup order.",
    "keyphrases": {
        "rootcause": "changed the context entry setup during domain attachment from a set-and-check policy to a clear-and-reset approach",
        "weakness": "kernel DMAR DRHD handling fault status reg 3 kernel applespi spi-APP000D00",
        "impact": "PCI aliased devices behind PCIe-to-PCI bridges",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "below messages kernel platform pxa2xx-spi",
        "component": "iommu/vt-d"
    }
}
