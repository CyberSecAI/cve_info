{
    "cveId": "CVE-2025-38102",
    "version": "1.0.0",
    "timestamp": "2025-07-05T08:16:57.403025+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved VMCI fix race between vmci_host_setup_notify and vmci_ctx_unset_notify During our test, it is found that a warning can be trigger in try_grab_folio as follow ------------[ cut here ]------------ WARNING CPU 0 PID 1678 at mm/gup.c147 try_grab_folio+0x106/0x130 Modules linked in CPU 0 UID 0 PID 1678 Comm syz.3.31 Not tainted 6.15.0-rc5 #163 PREEMPT(undef) RIP 0010try_grab_folio+0x106/0x130 Call Trace follow_huge_pmd+0x240/0x8e0 follow_pmd_mask.constprop.0.isra.0+0x40b/0x5c0 follow_pud_mask.constprop.0.isra.0+0x14a/0x170 follow_page_mask+0x1c2/0x1f0 __get_user_pages+0x176/0x950 __gup_longterm_locked+0x15b/0x1060 ? gup_fast+0x120/0x1f0 gup_fast_fallback+0x17e/0x230 get_user_pages_fast+0x5f/0x80 vmci_host_unlocked_ioctl+0x21c/0xf80 RIP 00330x54d2cd ---[ end trace 0000000000000000 ]--- Digging into the source, context->notify_page may init by get_user_pages_fast and can be seen in vmci_ctx_unset_notify which will try to put_page. However get_user_pages_fast is not finished here and lead to following try_grab_folio warning. The race condition is shown as follow cpu0 cpu1 vmci_host_do_set_notify vmci_host_setup_notify get_user_pages_fast(uva, 1, FOLL_WRITE, &context->notify_page) lockless_pages_from_mm gup_pgd_range gup_huge_pmd // update &context->notify_page vmci_host_do_set_notify vmci_ctx_unset_notify notify_page = context->notify_page if (notify_page) put_page(notify_page) // page is freed __gup_longterm_locked __get_user_pages follow_trans_huge_pmd try_grab_folio // warn here To slove this, use local variable page to make notify_page can be seen after finish get_user_pages_fast.",
    "keyphrases": {
        "rootcause": "race condition between vmci_host_setup_notify and vmci_ctx_unset_notify",
        "weakness": "",
        "impact": "WARNING CPU 0 PID 1678 at mm/gup.c147 try_grab_folio+0x106/0x130",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.15.0-rc5",
        "component": "VMCI"
    }
}
