{
    "cveId": "CVE-2025-38048",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved virtio_ring Fix data race by tagging event_triggered as racy for KCSAN syzbot reports a data-race when accessing the event_triggered, here is the simplified stack when the issue occurred ================================================================== BUG KCSAN data-race in virtqueue_disable_cb / virtqueue_enable_cb_delayed write to 0xffff8881025bc452 of 1 bytes by task 3288 on cpu 0 virtqueue_enable_cb_delayed+0x42/0x3c0 drivers/virtio/virtio_ring.c2653 start_xmit+0x230/0x1310 drivers/net/virtio_net.c3264 __netdev_start_xmit include/linux/netdevice.h5151 [inline] netdev_start_xmit include/linux/netdevice.h5160 [inline] xmit_one net/core/dev.c3800 [inline] read to 0xffff8881025bc452 of 1 bytes by interrupt on cpu 1 virtqueue_disable_cb_split drivers/virtio/virtio_ring.c880 [inline] virtqueue_disable_cb+0x92/0x180 drivers/virtio/virtio_ring.c2566 skb_xmit_done+0x5f/0x140 drivers/net/virtio_net.c777 vring_interrupt+0x161/0x190 drivers/virtio/virtio_ring.c2715 __handle_irq_event_percpu+0x95/0x490 kernel/irq/handle.c158 handle_irq_event_percpu kernel/irq/handle.c193 [inline] value changed 0x01 -> 0x00 ================================================================== When the data race occurs, the function virtqueue_enable_cb_delayed() sets event_triggered to false, and virtqueue_disable_cb_split/packed() reads it as false due to the race condition. Since event_triggered is an unreliable hint used for optimization, this should only cause the driver temporarily suggest that the device not send an interrupt notification when the event index is used. Fix this KCSAN reported data-race issue by explicitly tagging the access as data_racy.",
    "keyphrases": {
        "component": "virtio_ring, virtqueue_enable_cb_delayed, virtqueue_disable_cb_split/packed",
        "rootcause": "",
        "vector": "",
        "weakness": "data race",
        "product": "Linux kernel",
        "impact": "",
        "attacker": "",
        "version": ""
    }
}
