{
  "cveId": "CVE-2025-23130",
  "version": "1.0.0",
  "timestamp": "2025-07-04T16:12:41.853043+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved f2fs fix to avoid panic once fallocation fails for pinfile syzbot reports a f2fs bug as below ------------[ cut here ]------------ kernel BUG at fs/f2fs/segment.c2746! CPU 0 UID 0 PID 5323 Comm syz.0.0 Not tainted 6.13.0-rc2-syzkaller-00018-g7cb1b4663150 #0 RIP 0010get_new_segment fs/f2fs/segment.c2746 [inline] RIP 0010new_curseg+0x1f52/0x1f70 fs/f2fs/segment.c2876 Call Trace __allocate_new_segment+0x1ce/0x940 fs/f2fs/segment.c3210 f2fs_allocate_new_section fs/f2fs/segment.c3224 [inline] f2fs_allocate_pinning_section+0xfa/0x4e0 fs/f2fs/segment.c3238 f2fs_expand_inode_data+0x696/0xca0 fs/f2fs/file.c1830 f2fs_fallocate+0x537/0xa10 fs/f2fs/file.c1940 vfs_fallocate+0x569/0x6e0 fs/open.c327 do_vfs_ioctl+0x258c/0x2e40 fs/ioctl.c885 __do_sys_ioctl fs/ioctl.c904 [inline] __se_sys_ioctl+0x80/0x170 fs/ioctl.c892 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f Concurrent pinfile allocation may run out of free section, result in panic in get_new_segment(), lets expand pin_sem lock coverage to include f2fs_gc(), so that we can make sure to reclaim enough free space for following allocation. In addition, do below changes to enhance error path handling - call f2fs_bug_on() only in non-pinfile allocation path in get_new_segment(). - call reset_curseg_fields() to reset all fields of curseg in new_curseg()",
  "keyphrases": {
    "rootcause": "",
    "weakness": "concurrent pinfile allocation",
    "impact": [
      "kernel panic",
      "kernel BUG"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "6.13.0-rc2-syzkaller-00018-g7cb1b4663150",
    "component": "f2fs"
  },
  "mitreTechnicalImpacts": []
}