{
    "cveId": "CVE-2025-22031",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved PCI/bwctrl Fix NULL pointer dereference on bus number exhaustion When BIOS neglects to assign bus numbers to PCI bridges, the kernel attempts to correct that during PCI device enumeration. If it runs out of bus numbers, no pci_bus is allocated and the subordinate pointer in the bridges pci_dev remains NULL. The PCIe bandwidth controller erroneously does not check for a NULL subordinate pointer and dereferences it on probe. Bandwidth control of unusable devices below the bridge is of questionable utility, so simply error out instead. This mirrors what PCIe hotplug does since commit 62e4492c3063 (PCI Prevent NULL dereference during pciehp probe). The PCI core emits a message with KERN_INFO severity if it has run out of bus numbers. PCIe hotplug emits an additional message with KERN_ERR severity to inform the user that hotplug functionality is disabled at the bridge. A similar message for bandwidth control does not seem merited, given that its only purpose so far is to expose an up-to-date link speed in sysfs and throttle the link speed on certain laptops with limited Thermal Design Power. So error out silently. User-visible messages pci 00001602.0 bridge configuration invalid ([bus 00-00]), reconfiguring [...] pci_bus 000045 busn_res [bus 45-74] end is updated to 74 pci 00001602.0 devices behind bridge are unusable because [bus 45-74] cannot be assigned for them [...] pcieport 00001602.0 pciehp Hotplug bridge without secondary bus, ignoring [...]",
    "keyphrases": {
        "rootcause": "NULL pointer dereference",
        "weakness": "",
        "impact": "dereferences NULL subordinate pointer",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "PCIe bandwidth controller"
    }
}
