{
    "cveId": "CVE-2025-21816",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved hrtimers Force migrate away hrtimers queued after CPUHP_AP_HRTIMERS_DYING hrtimers are migrated away from the dying CPU to any online target at the CPUHP_AP_HRTIMERS_DYING stage in order not to delay bandwidth timers handling tasks involved in the CPU hotplug forward progress. However wakeups can still be performed by the outgoing CPU after CPUHP_AP_HRTIMERS_DYING. Those can result again in bandwidth timers being armed. Depending on several considerations (crystal ball power management based election, earliest timer already enqueued, timer migration enabled or not), the target may eventually be the current CPU even if offline. If that happens, the timer is eventually ignored. The most notable example is RCU which had to deal with each and every of those wake-ups by deferring them to an online CPU, along with related workarounds _ e787644caf76 (rcu Defer RCU kthreads wakeup when CPU is dying) _ 9139f93209d1 (rcu/nocb Fix RT throttling hrtimer armed from offline CPU) _ f7345ccc62a4 (rcu/nocb Fix rcuog wake-up from offline softirq) The problem isnt confined to RCU though as the stop machine kthread (which runs CPUHP_AP_HRTIMERS_DYING) reports its completion at the end of its work through cpu_stop_signal_done() and performs a wake up that eventually arms the deadline server timer WARNING CPU 94 PID 588 at kernel/time/hrtimer.c1086 hrtimer_start_range_ns+0x289/0x2d0 CPU 94 UID 0 PID 588 Comm migration/94 Not tainted Stopper multi_cpu_stop+0x0/0x120 start_dl_timer enqueue_dl_entity dl_server_start enqueue_task_fair enqueue_task ttwu_do_activate try_to_wake_up complete cpu_stopper_thread Instead of providing yet another bandaid to work around the situation, fix it in the hrtimers infrastructure instead always migrate away a timer to an online target whenever it is enqueued from an offline CPU. This will also allow to revert all the above RCU disgraceful hacks.",
    "keyphrases": {
        "component": "hrtimers",
        "rootcause": "",
        "vector": "",
        "weakness": "",
        "product": "Linux kernel",
        "impact": "Defer RCU kthreads wakeup, bandwidth timers being armed",
        "attacker": "",
        "version": ""
    }
}
