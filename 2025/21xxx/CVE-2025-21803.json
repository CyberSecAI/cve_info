{
    "cveId": "CVE-2025-21803",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved LoongArch Fix warnings during S3 suspend The enable_gpe_wakeup() function calls acpi_enable_all_wakeup_gpes(), and the later one may call the preempt_schedule_common() function, resulting in a thread switch and causing the CPU to be in an interrupt enabled state after the enable_gpe_wakeup() function returns, leading to the warnings as follow. [ C0] WARNING ... at kernel/time/timekeeping.c845 ktime_get+0xbc/0xc8 [ C0] ... [ C0] Call Trace [ C0] [] show_stack+0x64/0x188 [ C0] [] dump_stack_lvl+0x60/0x88 [ C0] [] __warn+0x8c/0x148 [ C0] [] report_bug+0x1c0/0x2b0 [ C0] [] do_bp+0x204/0x3b8 [ C0] [] exception_handlers+0x1924/0x10000 [ C0] [] ktime_get+0xbc/0xc8 [ C0] [] tick_sched_timer+0x30/0xb0 [ C0] [] __hrtimer_run_queues+0x160/0x378 [ C0] [] hrtimer_interrupt+0x144/0x388 [ C0] [] constant_timer_interrupt+0x38/0x48 [ C0] [] __handle_irq_event_percpu+0x64/0x1e8 [ C0] [] handle_irq_event_percpu+0x20/0x80 [ C0] [] handle_percpu_irq+0x5c/0x98 [ C0] [] generic_handle_domain_irq+0x30/0x48 [ C0] [] handle_cpu_irq+0x70/0xa8 [ C0] [] handle_loongarch_irq+0x30/0x48 [ C0] [] do_vint+0x80/0xe0 [ C0] [] finish_task_switch.isra.0+0x8c/0x2a8 [ C0] [] __schedule+0x314/0xa48 [ C0] [] schedule+0x58/0xf0 [ C0] [] worker_thread+0x224/0x498 [ C0] [] kthread+0xf8/0x108 [ C0] [] ret_from_kernel_thread+0xc/0xa4 [ C0] [ C0] ---[ end trace 0000000000000000 ]--- The root cause is acpi_enable_all_wakeup_gpes() uses a mutex to protect acpi_hw_enable_all_wakeup_gpes(), and acpi_ut_acquire_mutex() may cause a thread switch. Since there is no longer concurrent execution during loongarch_acpi_suspend(), we can call acpi_hw_enable_all_wakeup_gpes() directly in enable_gpe_wakeup(). The solution is similar to commit 22db06337f590d01 (ACPI sleep Avoid breaking S3 wakeup due to might_sleep()).",
    "keyphrases": {
        "component": "enable_gpe_wakeup() function",
        "rootcause": "",
        "vector": "",
        "weakness": "",
        "product": "Linux kernel",
        "impact": "CPU to be in an interrupt enabled state, warnings",
        "attacker": "",
        "version": ""
    }
}
