{
    "cveId": "CVE-2025-21867",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved bpf, test_run Fix use-after-free issue in eth_skb_pkt_type() KMSAN reported a use-after-free issue in eth_skb_pkt_type()[1]. The cause of the issue was that eth_skb_pkt_type() accessed skbs data that didnt contain an Ethernet header. This occurs when bpf_prog_test_run_xdp() passes an invalid value as the user_data argument to bpf_test_init(). Fix this by returning an error when user_data is less than ETH_HLEN in bpf_test_init(). Additionally, remove the check for if (user_size > size) as it is unnecessary. [1] BUG KMSAN use-after-free in eth_skb_pkt_type include/linux/etherdevice.h627 [inline] BUG KMSAN use-after-free in eth_type_trans+0x4ee/0x980 net/ethernet/eth.c165 eth_skb_pkt_type include/linux/etherdevice.h627 [inline] eth_type_trans+0x4ee/0x980 net/ethernet/eth.c165 __xdp_build_skb_from_frame+0x5a8/0xa50 net/core/xdp.c635 xdp_recv_frames net/bpf/test_run.c272 [inline] xdp_test_run_batch net/bpf/test_run.c361 [inline] bpf_test_run_xdp_live+0x2954/0x3330 net/bpf/test_run.c390 bpf_prog_test_run_xdp+0x148e/0x1b10 net/bpf/test_run.c1318 bpf_prog_test_run+0x5b7/0xa30 kernel/bpf/syscall.c4371 __sys_bpf+0x6a6/0xe20 kernel/bpf/syscall.c5777 __do_sys_bpf kernel/bpf/syscall.c5866 [inline] __se_sys_bpf kernel/bpf/syscall.c5864 [inline] __x64_sys_bpf+0xa4/0xf0 kernel/bpf/syscall.c5864 x64_sys_call+0x2ea0/0x3d90 arch/x86/include/generated/asm/syscalls_64.h322 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xd9/0x1d0 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f Uninit was created at free_pages_prepare mm/page_alloc.c1056 [inline] free_unref_page+0x156/0x1320 mm/page_alloc.c2657 __free_pages+0xa3/0x1b0 mm/page_alloc.c4838 bpf_ringbuf_free kernel/bpf/ringbuf.c226 [inline] ringbuf_map_free+0xff/0x1e0 kernel/bpf/ringbuf.c235 bpf_map_free kernel/bpf/syscall.c838 [inline] bpf_map_free_deferred+0x17c/0x310 kernel/bpf/syscall.c862 process_one_work kernel/workqueue.c3229 [inline] process_scheduled_works+0xa2b/0x1b60 kernel/workqueue.c3310 worker_thread+0xedf/0x1550 kernel/workqueue.c3391 kthread+0x535/0x6b0 kernel/kthread.c389 ret_from_fork+0x6e/0x90 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244 CPU 1 UID 0 PID 17276 Comm syz.1.16450 Not tainted 6.12.0-05490-g9bb88c659673 #8 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-3.fc41 04/01/2014",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.12.0-05490-g9bb88c659673",
        "component": "bpf"
    }
}
