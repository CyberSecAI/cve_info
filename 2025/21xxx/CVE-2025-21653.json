{
    "cveId": "CVE-2025-21653",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net_sched cls_flow validate TCA_FLOW_RSHIFT attribute syzbot found that TCA_FLOW_RSHIFT attribute was not validated. Right shitfing a 32bit integer is undefined for large shift values. UBSAN shift-out-of-bounds in net/sched/cls_flow.c32923 shift exponent 9445 is too large for 32-bit type u32 (aka unsigned int) CPU 1 UID 0 PID 54 Comm kworker/u83 Not tainted 6.13.0-rc3-syzkaller-00180-g4f619d518db9 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Workqueue ipv6_addrconf addrconf_dad_work Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c120 ubsan_epilogue lib/ubsan.c231 [inline] __ubsan_handle_shift_out_of_bounds+0x3c8/0x420 lib/ubsan.c468 flow_classify+0x24d5/0x25b0 net/sched/cls_flow.c329 tc_classify include/net/tc_wrapper.h197 [inline] __tcf_classify net/sched/cls_api.c1771 [inline] tcf_classify+0x420/0x1160 net/sched/cls_api.c1867 sfb_classify net/sched/sch_sfb.c260 [inline] sfb_enqueue+0x3ad/0x18b0 net/sched/sch_sfb.c318 dev_qdisc_enqueue+0x4b/0x290 net/core/dev.c3793 __dev_xmit_skb net/core/dev.c3889 [inline] __dev_queue_xmit+0xf0e/0x3f50 net/core/dev.c4400 dev_queue_xmit include/linux/netdevice.h3168 [inline] neigh_hh_output include/net/neighbour.h523 [inline] neigh_output include/net/neighbour.h537 [inline] ip_finish_output2+0xd41/0x1390 net/ipv4/ip_output.c236 iptunnel_xmit+0x55d/0x9b0 net/ipv4/ip_tunnel_core.c82 udp_tunnel_xmit_skb+0x262/0x3b0 net/ipv4/udp_tunnel_core.c173 geneve_xmit_skb drivers/net/geneve.c916 [inline] geneve_xmit+0x21dc/0x2d00 drivers/net/geneve.c1039 __netdev_start_xmit include/linux/netdevice.h5002 [inline] netdev_start_xmit include/linux/netdevice.h5011 [inline] xmit_one net/core/dev.c3590 [inline] dev_hard_start_xmit+0x27a/0x7d0 net/core/dev.c3606 __dev_queue_xmit+0x1b73/0x3f50 net/core/dev.c4434",
    "keyphrases": {
        "component": "net_sched cls_flow",
        "rootcause": "invalid TCA_FLOW_RSHIFT attribute in Linux kernel",
        "vector": "",
        "weakness": "shift-out-of-bounds, UBSAN",
        "product": "Linux kernel",
        "impact": "",
        "attacker": "",
        "version": ""
    }
}
