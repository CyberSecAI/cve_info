{
    "cveId": "CVE-2025-21851",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved bpf Fix softlockup in arena_map_free on 64k page kernel On an aarch64 kernel with CONFIG_PAGE_SIZE_64KB=y, arena_htab tests cause a segmentation fault and soft lockup. The same failure is not observed with 4k pages on aarch64. It turns out arena_map_free() is calling apply_to_existing_page_range() with the address returned by bpf_arena_get_kern_vm_start(). If this address is not page-aligned the code ends up calling apply_to_pte_range() with that unaligned address causing soft lockup. Fix it by round up GUARD_SZ to PAGE_SIZE << 1 so that the division by 2 in bpf_arena_get_kern_vm_start() returns a page-aligned value.",
    "keyphrases": {
        "component": "bpf",
        "rootcause": "apply_to_existing_page_range() is calling bpf_arena_get_kern_vm_start() with unaligned address",
        "vector": "arena_htab tests",
        "weakness": "",
        "product": "Linux kernel",
        "impact": "soft lockup, segmentation fault",
        "attacker": "",
        "version": ""
    }
}
