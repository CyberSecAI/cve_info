{
    "cveId": "CVE-2025-21887",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ovl fix UAF in ovl_dentry_update_reval by moving dput() in ovl_link_up The issue was caused by dput(upper) being called before ovl_dentry_update_reval(), while upper->d_flags was still accessed in ovl_dentry_remote(). Move dput(upper) after its last use to prevent use-after-free. BUG KASAN slab-use-after-free in ovl_dentry_remote fs/overlayfs/util.c162 [inline] BUG KASAN slab-use-after-free in ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c167 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c114 print_address_description mm/kasan/report.c377 [inline] print_report+0xc3/0x620 mm/kasan/report.c488 kasan_report+0xd9/0x110 mm/kasan/report.c601 ovl_dentry_remote fs/overlayfs/util.c162 [inline] ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c167 ovl_link_up fs/overlayfs/copy_up.c610 [inline] ovl_copy_up_one+0x2105/0x3490 fs/overlayfs/copy_up.c1170 ovl_copy_up_flags+0x18d/0x200 fs/overlayfs/copy_up.c1223 ovl_rename+0x39e/0x18c0 fs/overlayfs/dir.c1136 vfs_rename+0xf84/0x20a0 fs/namei.c4893 ...",
    "keyphrases": {
        "component": "ovl_dentry_update_reval, ovl_dentry_remote, ovl_link_up, ovl_copy_up_one",
        "rootcause": "use-after-free",
        "vector": "",
        "weakness": "slab-use-after-free",
        "product": "Linux kernel",
        "impact": "",
        "attacker": "",
        "version": ""
    }
}
