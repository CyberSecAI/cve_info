{
  "cveId": "CVE-2023-52698",
  "version": "1.0.0",
  "timestamp": "2024-12-19T22:22:49.126128+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolvedcalipso fix memory leak in netlbl_calipso_add_pass()If IPv6 support is disabled at boot (ipv6.disable=1),the calipso_init() -> netlbl_calipso_ops_register() function isnt called,and the netlbl_calipso_ops_get() function always returns NULL.In this case, the netlbl_calipso_add_pass() function allocates memoryfor the doi_def variable but doesnt free it with the calipso_doi_free().BUG memory leakunreferenced object 0xffff888011d68180 (size 64) comm syz-executor.1, pid 10746, jiffies 4295410986 (age 17.928s) hex dump (first 32 bytes) 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 ................ 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ backtrace [] kmalloc include/linux/slab.h552 [inline] [] netlbl_calipso_add_pass net/netlabel/netlabel_calipso.c76 [inline] [] netlbl_calipso_add+0x22e/0x4f0 net/netlabel/netlabel_calipso.c111 [] genl_family_rcv_msg_doit+0x22f/0x330 net/netlink/genetlink.c739 [] genl_family_rcv_msg net/netlink/genetlink.c783 [inline] [] genl_rcv_msg+0x341/0x5a0 net/netlink/genetlink.c800 [] netlink_rcv_skb+0x14d/0x440 net/netlink/af_netlink.c2515 [] genl_rcv+0x29/0x40 net/netlink/genetlink.c811 [] netlink_unicast_kernel net/netlink/af_netlink.c1313 [inline] [] netlink_unicast+0x54b/0x800 net/netlink/af_netlink.c1339 [] netlink_sendmsg+0x90a/0xdf0 net/netlink/af_netlink.c1934 [] sock_sendmsg_nosec net/socket.c651 [inline] [] sock_sendmsg+0x157/0x190 net/socket.c671 [] ____sys_sendmsg+0x712/0x870 net/socket.c2342 [] ___sys_sendmsg+0xf8/0x170 net/socket.c2396 [] __sys_sendmsg+0xea/0x1b0 net/socket.c2429 [] do_syscall_64+0x30/0x40 arch/x86/entry/common.c46 [] entry_SYSCALL_64_after_hwframe+0x61/0xc6Found by InfoTeCS on behalf of Linux Verification Center(linuxtesting.org) with Syzkaller[PM merged via the LSM tree at Jakub Kicinski request]",
  "keyphrases": {
    "rootcause": [
      "Memory leak in netlbl_calipso_add_pass() when IPv6 is disabled",
      "causing memory to be allocated but not freed."
    ],
    "weakness": [
      "Improper resource management",
      "memory leak",
      "specifically memory not being freed under certain conditions (IPv6 disabled)."
    ],
    "impact": [
      "Memory leak",
      "potentially leading to system instability if the leak is consistently triggered."
    ],
    "vector": "The vulnerability can be triggered through the netlink interface by sending a message that calls netlbl_calipso_add_pass().",
    "attacker": "An attacker can trigger the memory leak by sending crafted netlink messages that call the vulnerable function.",
    "product": "Linux Kernel",
    "version": [
      "Not specified in the provided information",
      "but would affect versions where the described calipso functionality is present without the fix."
    ],
    "component": "netlabel/netlabel_calipso.c"
  },
  "mitreTechnicalImpacts": []
}