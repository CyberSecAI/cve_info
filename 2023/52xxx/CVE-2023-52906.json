{
    "cveId": "CVE-2023-52906",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/sched act_mpls Fix warning during failed attribute validation The TCA_MPLS_LABEL attribute is of NLA_U32 type, but has a validation type of NLA_VALIDATE_FUNCTION. This is an invalid combination according to the comment above struct nla_policy Meaning of `validate field, use via NLA_POLICY_VALIDATE_FN NLA_BINARY Validation function called for the attribute. All other Unused - but note that its a union This can trigger the warning [1] in nla_get_range_unsigned() when validation of the attribute fails. Despite being of NLA_U32 type, the associated min/max fields in the policy are negative as they are aliased by the validate field. Fix by changing the attribute type to NLA_BINARY which is consistent with the above comment and all other users of NLA_POLICY_VALIDATE_FN(). As a result, move the length validation to the validation function. No regressions in MPLS tests # ./tdc.py -f tc-tests/actions/mpls.json [...] # echo $? 0 [1] WARNING CPU 0 PID 17743 at lib/nlattr.c118 nla_get_range_unsigned+0x1d8/0x1e0 lib/nlattr.c117 Modules linked in CPU 0 PID 17743 Comm syz-executor.0 Not tainted 6.1.0-rc8 #3 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.13.0-48-gd9c812dda519-prebuilt.qemu.org 04/01/2014 RIP 0010nla_get_range_unsigned+0x1d8/0x1e0 lib/nlattr.c117 [...] Call Trace __netlink_policy_dump_write_attr+0x",
    "keyphrases": {
        "rootcause": "invalid combination of attribute type and validation type",
        "weakness": "",
        "impact": "",
        "vector": "failed attribute validation",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net/sched act_mpls"
    }
}
