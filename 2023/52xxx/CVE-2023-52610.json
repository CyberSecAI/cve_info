{
    "cveId": "CVE-2023-52610",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/sched act_ct fix skb leak and crash on ooo frags act_ct adds skb->users before defragmentation. If frags arrive in order, the last frags reference is reset in inet_frag_reasm_prepare skb_morph which is not straightforward. However when frags arrive out of order, nobody unref the last frag, and all frags are leaked. The situation is even worse, as initiating packet capture can lead to a crash[0] when skb has been cloned and shared at the same time. Fix the issue by removing skb_get() before defragmentation. act_ct returns TC_ACT_CONSUMED when defrag failed or in progress. [0] [ 843.804823] ------------[ cut here ]------------ [ 843.809659] kernel BUG at net/core/skbuff.c2091! [ 843.814516] invalid opcode 0000 [#1] PREEMPT SMP [ 843.819296] CPU 7 PID 0 Comm swapper/7 Kdump loaded Tainted G S 6.7.0-rc3 #2 [ 843.824107] Hardware name XFUSION 1288H V6/BC13MBSBD, BIOS 1.29 11/25/2022 [ 843.828953] RIP 0010pskb_expand_head+0x2ac/0x300 [ 843.833805] Code 8b 70 28 48 85 f6 74 82 48 83 c6 08 bf 01 00 00 00 e8 38 bd ff ff 8b 83 c0 00 00 00 48 03 83 c8 00 00 00 e9 62 ff ff ff 0f 0b 0b e8 8d d0 ff ff e9 b3 fd ff ff 81 7c 24 14 40 01 00 00 4c 89 [ 843.843698] RSP 0018ffffc9000cce07c0 EFLAGS 00010202 [ 843.848524] RAX 0000000000000002 RBX ffff88811a211d00 RCX 0000000000000820 [ 843.853299] RDX 0000000000000640 RSI 0000000000000000 RDI ffff88811a211d00 [ 843.857974] R",
    "keyphrases": {
        "rootcause": "",
        "weakness": "use-after-free",
        "impact": "denial of service",
        "vector": "out of order fragments",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "act_ct"
    }
}
