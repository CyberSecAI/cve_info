{
    "cveId": "CVE-2023-52772",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved af_unix fix use-after-free in unix_stream_read_actor() syzbot reported the following crash [1] After releasing unix socket lock, u->oob_skb can be changed by another thread. We must temporarily increase skb refcount to make sure this other thread will not free the skb under us. [1] BUG KASAN slab-use-after-free in unix_stream_read_actor+0xa7/0xc0 net/unix/af_unix.c2866 Read of size 4 at addr ffff88801f3b9cc4 by task syz-executor107/5297 CPU 1 PID 5297 Comm syz-executor107 Not tainted 6.6.0-syzkaller-15910-gb8e3a87a627b #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 10/09/2023 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xd9/0x1b0 lib/dump_stack.c106 print_address_description mm/kasan/report.c364 [inline] print_report+0xc4/0x620 mm/kasan/report.c475 kasan_report+0xda/0x110 mm/kasan/report.c588 unix_stream_read_actor+0xa7/0xc0 net/unix/af_unix.c2866 unix_stream_recv_urg net/unix/af_unix.c2587 [inline] unix_stream_read_generic+0x19a5/0x2480 net/unix/af_unix.c2666 unix_stream_recvmsg+0x189/0x1b0 net/unix/af_unix.c2903 sock_recvmsg_nosec net/socket.c1044 [inline] sock_recvmsg+0xe2/0x170 net/socket.c1066 ____sys_recvmsg+0x21f/0x5c0 net/socket.c2803 ___sys_recvmsg+0x115/0x1a0 net/socket.c2845 __sys_recvmsg+0x114/0x1e0 net/socket.c2875 do_syscall_x64 arch/x86/entry/common.c51 [inline] do_syscall_64+0x3f/0x110 arch/x86/entry/"
}
