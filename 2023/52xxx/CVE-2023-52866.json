{
    "cveId": "CVE-2023-52866",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved HID uclogic Fix user-memory-access bug in uclogic_params_ugee_v2_init_event_hooks() When CONFIG_HID_UCLOGIC=y and CONFIG_KUNIT_ALL_TESTS=y, launch kernel and then the below user-memory-access bug occurs. In hid_test_uclogic_params_cleanup_event_hooks(),it call uclogic_params_ugee_v2_init_event_hooks() with the first arg=NULL, so when it calls uclogic_params_ugee_v2_has_battery(), the hid_get_drvdata() will access hdev->dev with hdev=NULL, which will cause below user-memory-access. So add a fake_device with quirks member and call hid_set_drvdata() to assign hdev->dev->driver_data which avoids the null-ptr-def bug for drvdata->quirks in uclogic_params_ugee_v2_has_battery(). After applying this patch, the below user-memory-access bug never occurs. general protection fault, probably for non-canonical address 0xdffffc0000000329 0000 [#1] PREEMPT SMP KASAN KASAN probably user-memory-access in range [0x0000000000001948-0x000000000000194f] CPU 5 PID 2189 Comm kunit_try_catch Tainted G B W N 6.6.0-rc2+ #30 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014 RIP 0010uclogic_params_ugee_v2_init_event_hooks+0x87/0x600 Code f3 f3 65 48 8b 14 25 28 00 00 00 48 89 54 24 60 31 d2 48 89 fa c7 44 24 30 00 00 00 00 48 c7 44 24 28 02 f8 02 01 48 c1 ea 03 3c 02 00 0f 85 2c 04 00 00 48 8b 9d 48 19 00 00 48 b8 00 00 00 RSP 0000ffff88810679fc88 EFLAGS 00010202 R",
    "keyphrases": {
        "rootcause": "user-memory-access bug in uclogic_params_ugee_v2_init_event_hooks()",
        "weakness": "",
        "impact": "user-memory-access",
        "vector": "calls uclogic_params_ugee_v2_init_event_hooks() with the first arg=NULL",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "HID uclogic"
    }
}
