{
    "cveId": "CVE-2023-52580",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednet/core Fix ETH_P_1588 flow dissectorWhen a PTP ethernet raw frame with a size of more than 256 bytes followedby a 0xff pattern is sent to __skb_flow_dissect, nhoff value calculationis wrong. For example hdr->message_length takes the wrong value (0xffff)and it does not replicate real header length. In this case, nhoff valuewas overridden and the PTP header was badly dissected. This leads to akernel crash.net/core flow_dissectornet/core flow dissector nhoff = 0x0000000enet/core flow dissector hdr->message_length = 0x0000ffffnet/core flow dissector nhoff = 0x0001000d (u16 overflow)...skb linear 00000000 00 a0 c9 00 00 00 00 a0 c9 00 00 00 88skb frag 00000000 f7 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffUsing the size of the ptp_header struct will allow the correctedcalculation of the nhoff value.net/core flow dissector nhoff = 0x0000000enet/core flow dissector nhoff = 0x00000030 (sizeof ptp_header)...skb linear 00000000 00 a0 c9 00 00 00 00 a0 c9 00 00 00 88 f7 ff ffskb linear 00000010 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffskb linear 00000020 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffskb frag 00000000 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffKernel trace[ 74.984279] ------------[ cut here ]------------[ 74.989471] kernel BUG at include/linux/skbuff.h2440![ 74.995237] invalid opcode 0000",
    "keyphrases": {
        "rootcause": "The nhoff value calculation is wrong when a PTP ethernet raw frame with a size of more than 256 bytes followed by a 0xff pattern is sent to __skb_flow_dissect, leading to a kernel crash.",
        "weakness": "Incorrect calculation of the nhoff value in the __skb_flow_dissect function for PTP ethernet raw frames.",
        "impact": "Kernel crash.",
        "vector": "Sending a crafted PTP ethernet raw frame with a size of more than 256 bytes followed by a 0xff pattern.",
        "attacker": "An attacker able to send network packets to the vulnerable system.",
        "product": "Linux Kernel",
        "version": "Not specified",
        "component": "net/core flow_dissector"
    }
}
