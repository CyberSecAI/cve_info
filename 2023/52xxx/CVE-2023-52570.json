{
    "cveId": "CVE-2023-52570",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved vfio/mdev Fix a null-ptr-deref bug for mdev_unregister_parent() Inject fault while probing mdpy.ko, if kstrdup() of create_dir() fails in kobject_add_internal() in kobject_init_and_add() in mdev_type_add() in parent_create_sysfs_files(), it will return 0 and probe successfully. And when rmmod mdpy.ko, the mdpy_dev_exit() will call mdev_unregister_parent(), the mdev_type_remove() may traverse uninitialized parent->types[i] in parent_remove_sysfs_files(), and it will cause below null-ptr-deref. If mdev_type_add() fails, return the error code and kset_unregister() to fix the issue. general protection fault, probably for non-canonical address 0xdffffc0000000002 0000 [#1] PREEMPT SMP KASAN KASAN null-ptr-deref in range [0x0000000000000010-0x0000000000000017] CPU 2 PID 10215 Comm rmmod Tainted G W N 6.6.0-rc2+ #20 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014 RIP 0010__kobject_del+0x62/0x1c0 Code 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 51 01 00 00 48 b8 00 00 00 00 00 fc ff df 48 8b 6b 28 48 8d 7d 10 48 89 fa 48 c1 ea 03 3c 02 00 0f 85 24 01 00 00 48 8b 75 10 48 89 df 48 8d 6b 3c e8 RSP 0018ffff88810695fd30 EFLAGS 00010202 RAX dffffc0000000000 RBX ffffffffa0270268 RCX 0000000000000000 RDX 0000000000000002 RSI 0000000000000004 RDI 0000000000000010 RBP 0000000000000000 R08 0000000000000001 R09 ffffed10233a4ef1 R10 ffff888119d277",
    "keyphrases": {
        "rootcause": "null-ptr-deref",
        "weakness": "",
        "impact": "",
        "vector": "If kstrdup() of create_dir() fails in kobject_add_internal() ... it will return 0 and probe successfully",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "vfio/mdev"
    }
}
