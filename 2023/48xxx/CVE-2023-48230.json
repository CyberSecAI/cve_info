{
    "cveId": "CVE-2023-48230",
    "version": "1.0.0",
    "timestamp": "2024-12-17T08:36:27.567979+00:00",
    "description": "Capn Proto is a data interchange format and capability-based RPC system. In versions 1.0 and 1.0.1, when using the KJ HTTP library with WebSocket compression enabled, a buffer underrun can be caused by a remote peer. The underrun always writes a constant value that is not attacker-controlled, likely resulting in a crash, enabling a remote denial-of-service attack. Most Capn Proto and KJ users are unlikely to have this functionality enabled and so unlikely to be affected. Maintainers suspect only the Cloudflare Workers Runtime is affected.If KJ HTTP is used with WebSocket compression enabled, a malicious peer may be able to cause a buffer underrun on a heap-allocated buffer. KJ HTTP is an optional library bundled with Capn Proto, but is not directly used by Capn Proto. WebSocket compression is disabled by default. It must be enabled via a setting passed to the KJ HTTP library via `HttpClientSettings` or `HttpServerSettings`. The bytes written out-of-bounds are always a specific constant 4-byte string `{ 0x00, 0x00, 0xFF, 0xFF }`. Because this string is not controlled by the attacker, maintainers believe it is unlikely that remote code execution is possible. However, it cannot be ruled out. This functionality first appeared in Capn Proto 1.0. Previous versions are not affected.This issue is fixed in Capn Proto 1.0.1.1.",
    "keyphrases": {
        "rootcause": "",
        "weakness": "buffer underrun",
        "impact": "denial-of-service attack",
        "vector": "",
        "attacker": "remote peer",
        "product": "Capn Proto",
        "version": "1.0 and 1.0.1",
        "component": "KJ HTTP library"
    }
}
