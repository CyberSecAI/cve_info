{
    "cveId": "CVE-2023-53023",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net nfc Fix use-after-free in local_cleanup() Fix a use-after-free that occurs in kfree_skb() called from local_cleanup(). This could happen when killing nfc daemon (e.g. neard) after detaching an nfc device. When detaching an nfc device, local_cleanup() called from nfc_llcp_unregister_device() frees local->rx_pending and decreases local->ref by kref_put() in nfc_llcp_local_put(). In the terminating process, nfc daemon releases all sockets and it leads to decreasing local->ref. After the last release of local->ref, local_cleanup() called from local_release() frees local->rx_pending again, which leads to the bug. Setting local->rx_pending to NULL in local_cleanup() could prevent use-after-free when local_cleanup() is called twice. Found by a modified version of syzkaller. BUG KASAN use-after-free in kfree_skb() Call Trace dump_stack_lvl (lib/dump_stack.c106) print_address_description.constprop.0.cold (mm/kasan/report.c306) kasan_check_range (mm/kasan/generic.c189) kfree_skb (net/core/skbuff.c955) local_cleanup (net/nfc/llcp_core.c159) nfc_llcp_local_put.part.0 (net/nfc/llcp_core.c172) nfc_llcp_local_put (net/nfc/llcp_core.c181) llcp_sock_destruct (net/nfc/llcp_sock.c959) __sk_destruct (net/core/sock.c2133) sk_destruct (net/core/sock.c2181) __sk_free (net/core/sock.c2192) sk_free (net/core/sock.c2203) llcp_sock_release (net/nfc/llcp_sock.c646) __sock_release (net/socket.c650) sock_close (net/socket.c1365) __fput (fs/file_table.c306) task_work_run (kernel/task_work.c179) ptrace_notify (kernel/signal.c2354) syscall_exit_to_user_mode_prepare (kernel/entry/common.c278) syscall_exit_to_user_mode (kernel/entry/common.c296) do_syscall_64 (arch/x86/entry/common.c86) entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S106) Allocated by task 4719 kasan_save_stack (mm/kasan/common.c45) __kasan_slab_alloc (mm/kasan/common.c325) slab_post_alloc_hook (mm/slab.h766) kmem_cache_alloc_node (mm/slub.c3497) __alloc_skb (net/core/skbuff.c552) pn533_recv_response (drivers/nfc/pn533/usb.c65) __usb_hcd_giveback_urb (drivers/usb/core/hcd.c1671) usb_giveback_urb_bh (drivers/usb/core/hcd.c1704) tasklet_action_common.isra.0 (kernel/softirq.c797) __do_softirq (kernel/softirq.c571) Freed by task 1901 kasan_save_stack (mm/kasan/common.c45) kasan_set_track (mm/kasan/common.c52) kasan_save_free_info (mm/kasan/genericdd.c518) __kasan_slab_free (mm/kasan/common.c236) kmem_cache_free (mm/slub.c3809) kfree_skbmem (net/core/skbuff.c874) kfree_skb (net/core/skbuff.c931) local_cleanup (net/nfc/llcp_core.c159) nfc_llcp_unregister_device (net/nfc/llcp_core.c1617) nfc_unregister_device (net/nfc/core.c1179) pn53x_unregister_nfc (drivers/nfc/pn533/pn533.c2846) pn533_usb_disconnect (drivers/nfc/pn533/usb.c579) usb_unbind_interface (drivers/usb/core/driver.c458) device_release_driver_internal (drivers/base/dd.c1279) bus_remove_device (drivers/base/bus.c529) device_del (drivers/base/core.c3665) usb_disable_device (drivers/usb/core/message.c1420) usb_disconnect (drivers/usb/core.c2261) hub_event (drivers/usb/core/hub.c5833) process_one_work (arch/x86/include/asm/jump_label.h27 include/linux/jump_label.h212 include/trace/events/workqueue.h108 kernel/workqueue.c2281) worker_thread (include/linux/list.h282 kernel/workqueue.c2423) kthread (kernel/kthread.c319) ret_from_fork (arch/x86/entry/entry_64.S301)",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net nfc"
    }
}
