{
    "cveId": "CVE-2023-53021",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/sched sch_taprio fix possible use-after-free syzbot reported a nasty crash [1] in net_tx_action() which made little sense until we got a repro. This repro installs a taprio qdisc, but providing an invalid TCA_RATE attribute. qdisc_create() has to destroy the just initialized taprio qdisc, and taprio_destroy() is called. However, the hrtimer used by taprio had already fired, therefore advance_sched() called __netif_schedule(). Then net_tx_action was trying to use a destroyed qdisc. We can not undo the __netif_schedule(), so we must wait until one cpu serviced the qdisc before we can proceed. Many thanks to Alexander Potapenko for his help. [1] BUG KMSAN uninit-value in queued_spin_trylock include/asm-generic/qspinlock.h94 [inline] BUG KMSAN uninit-value in do_raw_spin_trylock include/linux/spinlock.h191 [inline] BUG KMSAN uninit-value in __raw_spin_trylock include/linux/spinlock_api_smp.h89 [inline] BUG KMSAN uninit-value in _raw_spin_trylock+0x92/0xa0 kernel/locking/spinlock.c138 queued_spin_trylock include/asm-generic/qspinlock.h94 [inline] do_raw_spin_trylock include/linux/spinlock.h191 [inline] __raw_spin_trylock include/linux/spinlock_api_smp.h89 [inline] _raw_spin_trylock+0x92/0xa0 kernel/locking/spinlock.c138 spin_trylock include/linux/spinlock.h359 [inline] qdisc_run_begin include/net/sch_generic.h187 [inline] qdisc_run+0xee/0x540 include/net/pkt_sched.h125 net_tx_action+0x77c/0x9a0 net/core/dev.c5086 __do_softirq+0x1cc/0x7fb kernel/softirq.c571 run_ksoftirqd+0x2c/0x50 kernel/softirq.c934 smpboot_thread_fn+0x554/0x9f0 kernel/smpboot.c164 kthread+0x31b/0x430 kernel/kthread.c376 ret_from_fork+0x1f/0x30 Uninit was created at slab_post_alloc_hook mm/slab.h732 [inline] slab_alloc_node mm/slub.c3258 [inline] __kmalloc_node_track_caller+0x814/0x1250 mm/slub.c4970 kmalloc_reserve net/core/skbuff.c358 [inline] __alloc_skb+0x346/0xcf0 net/core/skbuff.c430 alloc_skb include/linux/skbuff.h1257 [inline] nlmsg_new include/net/netlink.h953 [inline] netlink_ack+0x5f3/0x12b0 net/netlink/af_netlink.c2436 netlink_rcv_skb+0x55d/0x6c0 net/netlink/af_netlink.c2507 rtnetlink_rcv+0x30/0x40 net/core/rtnetlink.c6108 netlink_unicast_kernel net/netlink/af_netlink.c1319 [inline] netlink_unicast+0xf3b/0x1270 net/netlink/af_netlink.c1345 netlink_sendmsg+0x1288/0x1440 net/netlink/af_netlink.c1921 sock_sendmsg_nosec net/socket.c714 [inline] sock_sendmsg net/socket.c734 [inline] ____sys_sendmsg+0xabc/0xe90 net/socket.c2482 ___sys_sendmsg+0x2a1/0x3f0 net/socket.c2536 __sys_sendmsg net/socket.c2565 [inline] __do_sys_sendmsg net/socket.c2574 [inline] __se_sys_sendmsg net/socket.c2572 [inline] __x64_sys_sendmsg+0x367/0x540 net/socket.c2572 do_syscall_x64 arch/x86/entry/common.c50 [inline] do_syscall_64+0x3d/0xb0 arch/x86/entry/common.c80 entry_SYSCALL_64_after_hwframe+0x63/0xcd CPU 0 PID 13 Comm ksoftirqd/0 Not tainted 6.0.0-rc2-syzkaller-47461-gac3859c02d7f #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 07/22/2022",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "crash",
        "vector": "invalid TCA_RATE attribute",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.0.0-rc2-syzkaller-47461-gac3859c02d7f",
        "component": "net/sched sch_taprio"
    }
}
