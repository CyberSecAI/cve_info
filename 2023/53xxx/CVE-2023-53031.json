{
  "cveId": "CVE-2023-53031",
  "version": "1.0.0",
  "timestamp": "2025-07-04T16:12:41.853043+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved powerpc/imc-pmu Fix use of mutex in IRQs disabled section Current imc-pmu code triggers a WARNING with CONFIG_DEBUG_ATOMIC_SLEEP and CONFIG_PROVE_LOCKING enabled, while running a thread_imc event. Command to trigger the warning # perf stat -e thread_imc/CPM_CS_FROM_L4_MEM_X_DPTEG/ sleep 5 Performance counter stats for sleep 5 0 thread_imc/CPM_CS_FROM_L4_MEM_X_DPTEG/ 5.002117947 seconds time elapsed 0.000131000 seconds user 0.001063000 seconds sys Below is snippet of the warning in dmesg BUG sleeping function called from invalid context at kernel/locking/mutex.c580 in_atomic() 1, irqs_disabled() 1, non_block 0, pid 2869, name perf-exec preempt_count 2, expected 0 4 locks held by perf-exec/2869 #0 c00000004325c540 (&sig->cred_guard_mutex){+.+.}-{33}, at bprm_execve+0x64/0xa90 #1 c00000004325c5d8 (&sig->exec_update_lock){++++}-{33}, at begin_new_exec+0x460/0xef0 #2 c0000003fa99d4e0 (&cpuctx_lock){-...}-{22}, at perf_event_exec+0x290/0x510 #3 c000000017ab8418 (&ctx->lock){....}-{22}, at perf_event_exec+0x29c/0x510 irq event stamp 4806 hardirqs last enabled at (4805) [] _raw_spin_unlock_irqrestore+0x94/0xd0 hardirqs last disabled at (4806) [] perf_event_exec+0x394/0x510 softirqs last enabled at (0) [] copy_process+0xc34/0x1ff0 softirqs last disabled at (0) [] 0x0 CPU 36 PID 2869 Comm perf-exec Not tainted 6.2.0-rc2-00011-g1247637727f2 #61 Hardware name 8375-42A POWER9 0x4e1202 opalv7.0-16-g9b85f7d961 PowerNV Call Trace dump_stack_lvl+0x98/0xe0 (unreliable) __might_resched+0x2f8/0x310 __mutex_lock+0x6c/0x13f0 thread_imc_event_add+0xf4/0x1b0 event_sched_in+0xe0/0x210 merge_sched_in+0x1f0/0x600 visit_groups_merge.isra.92.constprop.166+0x2bc/0x6c0 ctx_flexible_sched_in+0xcc/0x140 ctx_sched_in+0x20c/0x2a0 ctx_resched+0x104/0x1c0 perf_event_exec+0x340/0x510 begin_new_exec+0x730/0xef0 load_elf_binary+0x3f8/0x1e10 ... do not call blocking ops when !TASK_RUNNING state=2001 set at [] do_nanosleep+0x60/0x1a0 WARNING CPU 36 PID 2869 at kernel/sched/core.c9912 __might_sleep+0x9c/0xb0 CPU 36 PID 2869 Comm sleep Tainted G W 6.2.0-rc2-00011-g1247637727f2 #61 Hardware name 8375-42A POWER9 0x4e1202 opalv7.0-16-g9b85f7d961 PowerNV NIP c000000000194a1c LR c000000000194a18 CTR c000000000a78670 REGS c00000004d2134e0 TRAP 0700 Tainted G W (6.2.0-rc2-00011-g1247637727f2) MSR 9000000000021033 CR 48002824 XER 00000000 CFAR c00000000013fb64 IRQMASK 1 The above warning triggered because the current imc-pmu code uses mutex lock in interrupt disabled sections. The function mutex_lock() internally calls __might_resched(), which will check if IRQs are disabled and in case IRQs are disabled, it will trigger the warning. Fix the issue by changing the mutex lock to spinlock. [mpe Fix comments, trim oops in change log, add reported-by tags]",
  "keyphrases": {
    "rootcause": "",
    "weakness": "",
    "impact": [
      "WARNING",
      "oops"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "6.2.0-rc2-00011-g1247637727f2",
    "component": "powerpc/imc-pmu"
  },
  "mitreTechnicalImpacts": []
}