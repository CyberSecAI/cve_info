{
    "cveId": "CVE-2023-53109",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net tunnels annotate lockless accesses to dev->needed_headroom IP tunnels can apparently update dev->needed_headroom in their xmit path. This patch takes care of three tunnels xmit, and also the core LL_RESERVED_SPACE() and LL_RESERVED_SPACE_EXTRA() helpers. More changes might be needed for completeness. BUG KCSAN data-race in ip_tunnel_xmit / ip_tunnel_xmit read to 0xffff88815b9da0ec of 2 bytes by task 888 on cpu 1 ip_tunnel_xmit+0x1270/0x1730 net/ipv4/ip_tunnel.c803 __gre_xmit net/ipv4/ip_gre.c469 [inline] ipgre_xmit+0x516/0x570 net/ipv4/ip_gre.c661 __netdev_start_xmit include/linux/netdevice.h4881 [inline] netdev_start_xmit include/linux/netdevice.h4895 [inline] xmit_one net/core/dev.c3580 [inline] dev_hard_start_xmit+0x127/0x400 net/core/dev.c3596 __dev_queue_xmit+0x1007/0x1eb0 net/core/dev.c4246 dev_queue_xmit include/linux/netdevice.h3051 [inline] neigh_direct_output+0x17/0x20 net/core/neighbour.c1623 neigh_output include/net/neighbour.h546 [inline] ip_finish_output2+0x740/0x840 net/ipv4/ip_output.c228 ip_finish_output+0xf4/0x240 net/ipv4/ip_output.c316 NF_HOOK_COND include/linux/netfilter.h291 [inline] ip_output+0xe5/0x1b0 net/ipv4/ip_output.c430 dst_output include/net/dst.h444 [inline] ip_local_out+0x64/0x80 net/ipv4/ip_output.c126 iptunnel_xmit+0x34a/0x4b0 net/ipv4/ip_tunnel_core.c82 ip_tunnel_xmit+0x1451/0x1730 net/ipv4/ip_tunnel.c813 __gre_xmit net/ipv4/ip_gre.c469 [inline] ipgre_xmit+0x516/0x570 net/ipv4/ip_gre.c661 __netdev_start_xmit include/linux/netdevice.h4881 [inline] netdev_start_xmit include/linux/netdevice.h4895 [inline] xmit_one net/core/dev.c3580 [inline] dev_hard_start_xmit+0x127/0x400 net/core/dev.c3596 __dev_queue_xmit+0x1007/0x1eb0 net/core/dev.c4246 dev_queue_xmit include/linux/netdevice.h3051 [inline] neigh_direct_output+0x17/0x20 net/core/neighbour.c1623 neigh_output include/net/neighbour.h546 [inline] ip_finish_output2+0x740/0x840 net/ipv4/ip_output.c228 ip_finish_output+0xf4/0x240 net/ipv4/ip_output.c316 NF_HOOK_COND include/linux/netfilter.h291 [inline] ip_output+0xe5/0x1b0 net/ipv4/ip_output.c430 dst_output include/net/dst.h444 [inline] ip_local_out+0x64/0x80 net/ipv4/ip_output.c126 iptunnel_xmit+0x34a/0x4b0 net/ipv4/ip_tunnel_core.c82 ip_tunnel_xmit+0x1451/0x1730 net/ipv4/ip_tunnel.c813 __gre_xmit net/ipv4/ip_gre.c469 [inline] ipgre_xmit+0x516/0x570 net/ipv4/ip_gre.c661 __netdev_start_xmit include/linux/netdevice.h4881 [inline] netdev_start_xmit include/linux/netdevice.h4895 [inline] xmit_one net/core/dev.c3580 [inline] dev_hard_start_xmit+0x127/0x400 net/core/dev.c3596 __dev_queue_xmit+0x1007/0x1eb0 net/core/dev.c4246 dev_queue_xmit include/linux/netdevice.h3051 [inline] neigh_direct_output+0x17/0x20 net/core/neighbour.c1623 neigh_output include/net/neighbour.h546 [inline] ip_finish_output2+0x740/0x840 net/ipv4/ip_output.c228 ip_finish_output+0xf4/0x240 net/ipv4/ip_output.c316 NF_HOOK_COND include/linux/netfilter.h291 [inline] ip_output+0xe5/0x1b0 net/ipv4/ip_output.c430 dst_output include/net/dst.h444 [inline] ip_local_out+0x64/0x80 net/ipv4/ip_output.c126 iptunnel_xmit+0x34a/0x4b0 net/ipv4/ip_tunnel_core.c82 ip_tunnel_xmit+0x1451/0x1730 net/ipv4/ip_tunnel.c813 __gre_xmit net/ipv4/ip_gre.c469 [inline] ipgre_xmit+0x516/0x570 net/ipv4/ip_gre.c661 __netdev_start_xmit include/linux/netdevice.h4881 [inline] netdev_start_xmit include/linux/netdevice.h4895 [inline] xmit_one net/core/dev.c3580 [inline] dev_hard_start_xmit+0x127/0x400 net/core/dev.c3596 __dev_queue_xmit+0x1007/0x1eb0 net/core/dev.c4246 dev_queue_xmit include/linux/netdevice.h3051 [inline] neigh_direct_output+0x17/0x20 net/core/neighbour.c1623 neigh_output include/net/neighbour.h546 [inline] ip_finish_output2+0x740/0x840 net/ipv4/ip_output.c228 ip_finish_output+0xf4/0x240 net/ipv4/ip_output.c316 NF_HOOK_COND include/linux/netfilter.h291 [inline] ip_output+0xe5/0x1b0 net/i ---truncated---",
    "keyphrases": {
        "component": "ip_tunnel_xmit, ip_tunnel_xmit read to dev->needed_headroom",
        "rootcause": "data-race",
        "vector": "",
        "weakness": "",
        "product": "Linux kernel",
        "impact": "",
        "attacker": "",
        "version": ""
    }
}
