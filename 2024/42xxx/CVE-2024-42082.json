{
    "cveId": "CVE-2024-42082",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedxdp Remove WARN() from __xdp_reg_mem_model()syzkaller reports a warning in __xdp_reg_mem_model().The warning occurs only if __mem_id_init_hash_table() returns an error. Itreturns the error in two cases 1. memory allocation fails 2. rhashtable_init() fails when some fields of rhashtable_params struct are not initialized properly.The second case cannot happen since there is a static const rhashtable_paramsstruct with valid fields. So, warning is only triggered when there is aproblem with memory allocation.Thus, there is no sense in using WARN() to handle this error and it can besafely removed.WARNING CPU 0 PID 5065 at net/core/xdp.c299 __xdp_reg_mem_model+0x2d9/0x650 net/core/xdp.c299CPU 0 PID 5065 Comm syz-executor883 Not tainted 6.8.0-syzkaller-05271-gf99c5f563c17 #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024RIP 0010__xdp_reg_mem_model+0x2d9/0x650 net/core/xdp.c299Call Trace xdp_reg_mem_model+0x22/0x40 net/core/xdp.c344 xdp_test_run_setup net/bpf/test_run.c188 [inline] bpf_test_run_xdp_live+0x365/0x1e90 net/bpf/test_run.c377 bpf_prog_test_run_xdp+0x813/0x11b0 net/bpf/test_run.c1267 bpf_prog_test_run+0x33a/0x3b0 kernel/bpf/syscall.c4240 __sys_bpf+0x48d/0x810 kernel/bpf/syscall.c5649 __do_sys_bpf kernel/bpf/syscall.c5738 [inline] __se_sys_bpf kernel/bpf/syscall.c5736 [inline] __x64_sys_bpf+0x7c/0x90 kernel/bpf/syscall.c5736 do_syscall_64+0xfb/0x240 entry_SYSCALL_64_after_hwframe+0x6d/0x75Found by Linux Verification Center (linuxtesting.org) with syzkaller.",
    "keyphrases": {
        "rootcause": "Memory allocation failure in __mem_id_init_hash_table() which is called by __xdp_reg_mem_model()",
        "weakness": "Unnecessary WARN() call when memory allocation fails in __xdp_reg_mem_model()",
        "impact": "Triggers a warning message in kernel logs when memory allocation fails in XDP memory registration.",
        "vector": "Memory allocation failure during XDP memory registration",
        "attacker": "N/A",
        "product": "Linux Kernel",
        "version": "6.8.0-syzkaller-05271-gf99c5f563c17",
        "component": "XDP"
    }
}
