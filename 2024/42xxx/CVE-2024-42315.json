{
    "cveId": "CVE-2024-42315",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved exfat fix potential deadlock on __exfat_get_dentry_set When accessing a file with more entries than ES_MAX_ENTRY_NUM, the bh-array is allocated in __exfat_get_entry_set. The problem is that the bh-array is allocated with GFP_KERNEL. It does not make sense. In the following cases, a deadlock for sbi->s_lock between the two processes may occur. CPU0 CPU1 ---- ---- kswapd balance_pgdat lock(fs_reclaim) exfat_iterate lock(&sbi->s_lock) exfat_readdir exfat_get_uniname_from_ext_entry exfat_get_dentry_set __exfat_get_dentry_set kmalloc_array ... lock(fs_reclaim) ... evict exfat_evict_inode lock(&sbi->s_lock) To fix this, lets allocate bh-array with GFP_NOFS.",
    "keyphrases": {
        "rootcause": "potential deadlock",
        "weakness": "",
        "impact": "",
        "vector": "accessing a file with more entries than ES_MAX_ENTRY_NUM",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": ""
    }
}
