{
    "cveId": "CVE-2024-42103",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved btrfs fix adding block group to a reclaim list and the unused list during reclaim There is a potential parallel list adding for retrying in btrfs_reclaim_bgs_work and adding to the unused list. Since the block group is removed from the reclaim list and it is on a relocation work, it can be added into the unused list in parallel. When that happens, adding it to the reclaim list will corrupt the list head and trigger list corruption like below. Fix it by taking fs_info->unused_bgs_lock. [177.504][T2585409] BTRFS error (device nullb1) error relocating ch= unk 2415919104 [177.514][T2585409] list_del corruption. next->prev should be ff1100= 0344b119c0, but was ff11000377e87c70. (next=3Dff110002390cd9c0) [177.529][T2585409] ------------[ cut here ]------------ [177.537][T2585409] kernel BUG at lib/list_debug.c65! [177.545][T2585409] Oops invalid opcode 0000 [#1] PREEMPT SMP KASAN NOPTI [177.555][T2585409] CPU 9 PID 2585409 Comm kworker/u1282 Tainted G W 6.10.0-rc5-kts #1 [177.568][T2585409] Hardware name Supermicro SYS-520P-WTR/X12SPW-TF, BIOS 1.2 02/14/2022 [177.579][T2585409] Workqueue events_unbound btrfs_reclaim_bgs_work[btrfs] [177.589][T2585409] RIP 0010__list_del_entry_valid_or_report.cold+0x70/0x72 [177.624][T2585409] RSP 0018ff11000377e87a70 EFLAGS 00010286 [177.633][T2585409] RAX 000000000000006d RBX ff11000344b119c0 RCX0000000000000000 [177.",
    "keyphrases": {
        "rootcause": "parallel list adding",
        "weakness": "",
        "impact": "list corruption",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "btrfs"
    }
}
