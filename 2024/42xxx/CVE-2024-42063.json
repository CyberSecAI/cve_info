{
    "cveId": "CVE-2024-42063",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedbpf Mark bpf prog stack with kmsan_unposion_memory in interpreter modesyzbot reported uninit memory usages during map_{lookup,delete}_elem.==========BUG KMSAN uninit-value in __dev_map_lookup_elem kernel/bpf/devmap.c441 [inline]BUG KMSAN uninit-value in dev_map_lookup_elem+0xf3/0x170 kernel/bpf/devmap.c796__dev_map_lookup_elem kernel/bpf/devmap.c441 [inline]dev_map_lookup_elem+0xf3/0x170 kernel/bpf/devmap.c796____bpf_map_lookup_elem kernel/bpf/helpers.c42 [inline]bpf_map_lookup_elem+0x5c/0x80 kernel/bpf/helpers.c38___bpf_prog_run+0x13fe/0xe0f0 kernel/bpf/core.c1997__bpf_prog_run256+0xb5/0xe0 kernel/bpf/core.c2237==========The reproducer should be in the interpreter mode.The C reproducer is trying to run the following bpf prog 0 (18) r0 = 0x0 2 (18) r1 = map[id49] 4 (b7) r8 = 16777216 5 (7b) *(u64 *)(r10 -8) = r8 6 (bf) r2 = r10 7 (07) r2 += -229 ^^^^^^^^^^ 8 (b7) r3 = 8 9 (b7) r4 = 0 10 (85) call dev_map_lookup_elem#1543472 11 (95) exitIt is due to the void *key (r2) passed to the helper. bpf allows uninitstack memory access for bpf prog with the right privileges. This patchuses kmsan_unpoison_memory() to mark the stack as initialized.This should address different syzbot reports on the uninit void *keyargument during map_{lookup,delete}_elem.",
    "keyphrases": {
        "rootcause": "Uninitialized stack memory access in bpf program when calling map lookup/delete functions.",
        "weakness": "The bpf program allows uninitialized stack memory access for bpf program with the right privileges and passes the uninitialized memory to map lookup/delete.",
        "impact": "Uninitialized memory usage during map_lookup/delete operations, leading to crashes or undefined behavior.",
        "vector": "bpf program calling map_lookup/delete with uninitialized stack memory as key.",
        "attacker": "A malicious or buggy bpf program.",
        "product": "Linux Kernel",
        "version": "Unspecified",
        "component": "bpf"
    }
}
