{
    "cveId": "CVE-2024-42270",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved netfilter iptables Fix null-ptr-deref in iptable_nat_table_init(). We had a report that iptables-restore sometimes triggered null-ptr-deref at boot time. [0] The problem is that iptable_nat_table_init() is exposed to user space before the kernel fully initialises netns. In the small race window, a user could call iptable_nat_table_init() that accesses net_generic(net, iptable_nat_net_id), which is available only after registering iptable_nat_net_ops. Lets call register_pernet_subsys() before xt_register_template(). [0] bpfilter Loaded bpfilter_umh pid 11702 Started bpfilter BUG kernel NULL pointer dereference, address 0000000000000013 PF supervisor write access in kernel mode PF error_code(0x0002) - not-present page PGD 0 P4D 0 PREEMPT SMP NOPTI CPU 2 PID 11879 Comm iptables-restor Not tainted 6.1.92-99.174.amzn2023.x86_64 #1 Hardware name Amazon EC2 c6i.4xlarge/, BIOS 1.0 10/16/2017 RIP 0010iptable_nat_table_init (net/ipv4/netfilter/iptable_nat.c87 net/ipv4/netfilter/iptable_nat.c121) iptable_nat Code 10 4c 89 f6 48 89 ef e8 0b 19 bb ff 41 89 c4 85 c0 75 38 41 83 c7 01 49 83 c6 28 41 83 ff 04 75 dc 48 8b 44 24 08 48 8b 0c 24 89 08 4c 89 ef e8 a2 3b a2 cf 48 83 c4 10 44 89 e0 5b 5d 41 5c RSP 0018ffffbef902843cd0 EFLAGS 00010246 RAX 0000000000000013 RBX ffff9f4b052caa20 RCX ffff9f4b20988d80 RDX 0000000000000000 RSI 0000000000000064 RDI ffffffffc04201c0 RBP ffff9f4b29394",
    "keyphrases": {
        "rootcause": "",
        "weakness": "null-ptr-deref",
        "impact": "",
        "vector": "",
        "attacker": "user",
        "product": "Linux kernel",
        "version": "",
        "component": "iptable_nat_table_init() in netfilter iptables"
    }
}
