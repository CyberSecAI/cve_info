{
    "cveId": "CVE-2024-41097",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedusb atm cxacru fix endpoint checking in cxacru_bind()Syzbot is still reporting quite an old issue [1] that occurs due toincomplete checking of present usb endpoints. As such, wrongendpoints types may be used at urb sumbitting stage which in turntriggers a warning in usb_submit_urb().Fix the issue by verifying that required endpoint types are presentfor both in and out endpoints, taking into account cmd endpoint type.Unfortunately, this patch has not been tested on real hardware.[1] Syzbot reportusb 1-1 BOGUS urb xfer, pipe 1 != type 3WARNING CPU 0 PID 8667 at drivers/usb/core/urb.c502 usb_submit_urb+0xed2/0x18a0 drivers/usb/core/urb.c502Modules linked inCPU 0 PID 8667 Comm kworker/04 Not tainted 5.14.0-rc4-syzkaller #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011Workqueue usb_hub_wq hub_eventRIP 0010usb_submit_urb+0xed2/0x18a0 drivers/usb/core/urb.c502...Call Trace cxacru_cm+0x3c0/0x8e0 drivers/usb/atm/cxacru.c649 cxacru_card_status+0x22/0xd0 drivers/usb/atm/cxacru.c760 cxacru_bind+0x7ac/0x11a0 drivers/usb/atm/cxacru.c1209 usbatm_usb_probe+0x321/0x1ae0 drivers/usb/atm/usbatm.c1055 cxacru_usb_probe+0xdf/0x1e0 drivers/usb/atm/cxacru.c1363 usb_probe_interface+0x315/0x7f0 drivers/usb/core/driver.c396 call_driver_probe drivers/base/dd.c517 [inline] really_probe+0x23c/0xcd0 drivers/base/dd.c595 __driver_probe_device+0x338/0x4d0 drivers/base/dd.c747 driver_probe_device+0x4c/0x1a0 drivers/base/dd.c777 __device_attach_driver+0x20b/0x2f0 drivers/base/dd.c894 bus_for_each_drv+0x15f/0x1e0 drivers/base/bus.c427 __device_attach+0x228/0x4a0 drivers/base/dd.c965 bus_probe_device+0x1e4/0x290 drivers/base/bus.c487 device_add+0xc2f/0x2180 drivers/base/core.c3354 usb_set_configuration+0x113a/0x1910 drivers/usb/core/message.c2170 usb_generic_driver_probe+0xba/0x100 drivers/usb/core/generic.c238 usb_probe_device+0xd9/0x2c0 drivers/usb/core/driver.c293",
    "keyphrases": {
        "rootcause": "Incomplete checking of present usb endpoints in the cxacru_bind() function.",
        "weakness": "The code does not verify that required endpoint types are present for both in and out endpoints, taking into account cmd endpoint type.",
        "impact": "Wrong endpoint types may be used at urb submitting stage which in turn triggers a warning in usb_submit_urb().",
        "vector": "USB device with incorrect endpoint configurations.",
        "attacker": "Malicious or faulty USB device.",
        "product": "Linux Kernel",
        "version": "5.14.0-rc4",
        "component": "drivers/usb/atm/cxacru.c"
    }
}
