{
    "cveId": "CVE-2024-56635",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net avoid potential UAF in default_operstate() syzbot reported an UAF in default_operstate() [1] Issue is a race between device and netns dismantles. After calling __rtnl_unlock() from netdev_run_todo(), we can not assume the netns of each device is still alive. Make sure the device is not in NETREG_UNREGISTERED state, and add an ASSERT_RTNL() before the call to __dev_get_by_index(). We might move this ASSERT_RTNL() in __dev_get_by_index() in the future. [1] BUG KASAN slab-use-after-free in __dev_get_by_index+0x5d/0x110 net/core/dev.c852 Read of size 8 at addr ffff888043eba1b0 by task syz.0.0/5339 CPU 0 UID 0 PID 5339 Comm syz.0.0 Not tainted 6.12.0-syzkaller-10296-gaaf20f870da0 #0 Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014 Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c120 print_address_description mm/kasan/report.c378 [inline] print_report+0x169/0x550 mm/kasan/report.c489 kasan_report+0x143/0x180 mm/kasan/report.c602 __dev_get_by_index+0x5d/0x110 net/core/dev.c852 default_operstate net/core/link_watch.c51 [inline] rfc2863_policy+0x224/0x300 net/core/link_watch.c67 linkwatch_do_dev+0x3e/0x170 net/core/link_watch.c170 netdev_run_todo+0x461/0x1000 net/core/dev.c10894 rtnl_unlock net/core/rtnetlink.c152 [inline] rtnl_net_unlock include/linux/rtnetlink.h133 [inline] rtnl_dellink+0x760/0x8d0 net/core/rtnetlink.c3520 rtnetlink_rcv_msg+0x791/0xcf0 net/core/rtnetlink.c6911 netlink_rcv_skb+0x1e3/0x430 net/netlink/af_netlink.c2541 netlink_unicast_kernel net/netlink/af_netlink.c1321 [inline] netlink_unicast+0x7f6/0x990 net/netlink/af_netlink.c1347 netlink_sendmsg+0x8e4/0xcb0 net/netlink/af_netlink.c1891 sock_sendmsg_nosec net/socket.c711 [inline] __sock_sendmsg+0x221/0x270 net/socket.c726 ____sys_sendmsg+0x52a/0x7e0 net/socket.c2583 ___sys_sendmsg net/socket.c2637 [inline] __sys_sendmsg+0x269/0x350 net/socket.c2669 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f RIP 00330x7f2a3cb80809 Code ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48 RSP 002b00007f2a3d9cd058 EFLAGS 00000246 ORIG_RAX 000000000000002e RAX ffffffffffffffda RBX 00007f2a3cd45fa0 RCX 00007f2a3cb80809 RDX 0000000000000000 RSI 0000000020000000 RDI 0000000000000008 RBP 00007f2a3cbf393e R08 0000000000000000 R09 0000000000000000 R10 0000000000000000 R11 0000000000000246 R12 0000000000000000 R13 0000000000000000 R14 00007f2a3cd45fa0 R15 00007ffd03bc65c8 Allocated by task 5339 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3f/0x80 mm/kasan/common.c68 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __kmalloc_cache_noprof+0x243/0x390 mm/slub.c4314 kmalloc_noprof include/linux/slab.h901 [inline] kmalloc_array_noprof include/linux/slab.h945 [inline] netdev_create_hash net/core/dev.c11870 [inline] netdev_init+0x10c/0x250 net/core/dev.c11890 ops_init+0x31e/0x590 net/core/net_namespace.c138 setup_net+0x287/0x9e0 net/core/net_namespace.c362 copy_net_ns+0x33f/0x570 net/core/net_namespace.c500 create_new_namespaces+0x425/0x7b0 kernel/nsproxy.c110 unshare_nsproxy_namespaces+0x124/0x180 kernel/nsproxy.c228 ksys_unshare+0x57d/0xa70 kernel/fork.c3314 __do_sys_unshare kernel/fork.c3385 [inline] __se_sys_unshare kernel/fork.c3383 [inline] __x64_sys_unshare+0x38/0x40 kernel/fork.c3383 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x8 ---truncated---",
    "keyphrases": {
        "rootcause": "race between device and netns dismantles",
        "weakness": "use-after-free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": ""
    }
}
