{
    "cveId": "CVE-2024-57903",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net restrict SO_REUSEPORT to inet sockets After blamed commit, crypto sockets could accidentally be destroyed from RCU call back, as spotted by zyzbot [1]. Trying to acquire a mutex in RCU callback is not allowed. Restrict SO_REUSEPORT socket option to inet sockets. v1 of this patch supported TCP, UDP and SCTP sockets, but fcnal-test.sh test needed RAW and ICMP support. [1] BUG sleeping function called from invalid context at kernel/locking/mutex.c562 in_atomic() 1, irqs_disabled() 0, non_block 0, pid 24, name ksoftirqd/1 preempt_count 100, expected 0 RCU nest depth 0, expected 0 1 lock held by ksoftirqd/1/24 #0 ffffffff8e937ba0 (rcu_callback){....}-{00}, at rcu_lock_acquire include/linux/rcupdate.h337 [inline] #0 ffffffff8e937ba0 (rcu_callback){....}-{00}, at rcu_do_batch kernel/rcu/tree.c2561 [inline] #0 ffffffff8e937ba0 (rcu_callback){....}-{00}, at rcu_core+0xa37/0x17a0 kernel/rcu/tree.c2823 Preemption disabled at [] softirq_handle_begin kernel/softirq.c402 [inline] [] handle_softirqs+0x128/0x9b0 kernel/softirq.c537 CPU 1 UID 0 PID 24 Comm ksoftirqd/1 Not tainted 6.13.0-rc3-syzkaller-00174-ga024e377efed #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c120 __might_resched+0x5d4/0x780 kernel/sched/core.c8758 __mutex_lock_common kernel/locking/mutex.c562 [inline] __mutex_lock+0x131/0xee0 kernel/locking/mutex.c735 crypto_put_default_null_skcipher+0x18/0x70 crypto/crypto_null.c179 aead_release+0x3d/0x50 crypto/algif_aead.c489 alg_do_release crypto/af_alg.c118 [inline] alg_sock_destruct+0x86/0xc0 crypto/af_alg.c502 __sk_destruct+0x58/0x5f0 net/core/sock.c2260 rcu_do_batch kernel/rcu/tree.c2567 [inline] rcu_core+0xaaa/0x17a0 kernel/rcu/tree.c2823 handle_softirqs+0x2d4/0x9b0 kernel/softirq.c561 run_ksoftirqd+0xca/0x130 kernel/softirq.c950 smpboot_thread_fn+0x544/0xa30 kernel/smpboot.c164 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244",
    "keyphrases": {
        "rootcause": "",
        "weakness": "acquire a mutex in RCU callback",
        "impact": "destroy crypto sockets",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.13.0-rc3",
        "component": "net restrict SO_REUSEPORT to inet sockets"
    }
}
