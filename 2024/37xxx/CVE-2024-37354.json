{
    "cveId": "CVE-2024-37354",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved btrfs fix crash on racing fsync and size-extending write into prealloc We have been seeing crashes on duplicate keys in btrfs_set_item_key_safe() BTRFS critical (device vdb) slot 4 key (450 108 8192) new key (450 108 8192) ------------[ cut here ]------------ kernel BUG at fs/btrfs/ctree.c2620! invalid opcode 0000 [#1] PREEMPT SMP PTI CPU 0 PID 3139 Comm xfs_io Kdump loaded Not tainted 6.9.0 #6 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 04/01/2014 RIP 0010btrfs_set_item_key_safe+0x11f/0x290 [btrfs] With the following stack trace #0 btrfs_set_item_key_safe (fs/btrfs/ctree.c26204) #1 btrfs_drop_extents (fs/btrfs/file.c4114) #2 log_one_extent (fs/btrfs/tree-log.c47329) #3 btrfs_log_changed_extents (fs/btrfs/tree-log.c49559) #4 btrfs_log_inode (fs/btrfs/tree-log.c66269) #5 btrfs_log_inode_parent (fs/btrfs/tree-log.c70708) #6 btrfs_log_dentry_safe (fs/btrfs/tree-log.c71718) #7 btrfs_sync_file (fs/btrfs/file.c19338) #8 vfs_fsync_range (fs/sync.c1889) #9 vfs_fsync (fs/sync.c2029) #10 do_fsync (fs/sync.c2129) #11 __do_sys_fdatasync (fs/sync.c2259) #12 __se_sys_fdatasync (fs/sync.c2231) #13 __x64_sys_fdatasync (fs/sync.c2231) #14 do_syscall_x64 (arch/x86/entry/common.c5214) #15 do_syscall_64 (arch/x86/entry/common.c837) #16 entry_SYSCALL_64+0xaf/0x14c (arch/x86/entry/entry_64.S121)",
    "keyphrases": {
        "rootcause": "racing fsync and size-extending write",
        "weakness": "duplicate keys",
        "impact": "kernel BUG",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "btrfs_set_item_key_safe() in btrfs"
    }
}
