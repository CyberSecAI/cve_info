{
    "cveId": "CVE-2024-53116",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved drm/panthor Fix handling of partial GPU mapping of BOs This commit fixes the bug in the handling of partial mapping of the buffer objects to the GPU, which caused kernel warnings. Panthor didnt correctly handle the case where the partial mapping spanned multiple scatterlists and the mapping offset didnt point to the 1st page of starting scatterlist. The offset variable was not cleared after reaching the starting scatterlist. Following warning messages were seen. WARNING CPU 1 PID 650 at drivers/iommu/io-pgtable-arm.c659 __arm_lpae_unmap+0x254/0x5a0 pc __arm_lpae_unmap+0x254/0x5a0 lr __arm_lpae_unmap+0x2cc/0x5a0 Call trace __arm_lpae_unmap+0x254/0x5a0 __arm_lpae_unmap+0x108/0x5a0 __arm_lpae_unmap+0x108/0x5a0 __arm_lpae_unmap+0x108/0x5a0 arm_lpae_unmap_pages+0x80/0xa0 panthor_vm_unmap_pages+0xac/0x1c8 [panthor] panthor_gpuva_sm_step_unmap+0x4c/0xc8 [panthor] op_unmap_cb.isra.23.constprop.30+0x54/0x80 __drm_gpuvm_sm_unmap+0x184/0x1c8 drm_gpuvm_sm_unmap+0x40/0x60 panthor_vm_exec_op+0xa8/0x120 [panthor] panthor_vm_bind_exec_sync_op+0xc4/0xe8 [panthor] panthor_ioctl_vm_bind+0x10c/0x170 [panthor] drm_ioctl_kernel+0xbc/0x138 drm_ioctl+0x210/0x4b0 __arm64_sys_ioctl+0xb0/0xf8 invoke_syscall+0x4c/0x110 el0_svc_common.constprop.1+0x98/0xf8 do_el0_svc+0x24/0x38 el0_svc+0x34/0xc8 el0t_64_sync_handler+0xa0/0xc8 el0t_64_sync+0x174/0x178 panthor [drm] drm_WARN_ON(unmapped_sz != pgsize * pgcount) WARNING CPU 1 PID 650 at drivers/gpu/drm/panthor/panthor_mmu.c922 panthor_vm_unmap_pages+0x124/0x1c8 [panthor] pc panthor_vm_unmap_pages+0x124/0x1c8 [panthor] lr panthor_vm_unmap_pages+0x124/0x1c8 [panthor] panthor [drm] *ERROR* failed to unmap range ffffa388f000-ffffa3890000 (requested range ffffa388c000-ffffa3890000)",
    "keyphrases": {
        "rootcause": "The Panthor driver didn't correctly handle the case where the partial mapping spanned multiple scatterlists and the mapping offset didn't point to the 1st page of starting scatterlist. The offset variable was not cleared after reaching the starting scatterlist.",
        "weakness": "Improper handling of partial mapping of buffer objects to the GPU leading to memory unmapping issues.",
        "impact": "Kernel warnings and potential memory corruption due to incorrect unmapping of memory regions.",
        "vector": "The vulnerability is triggered via a ioctl call to the drm driver, specifically the panthor_ioctl_vm_bind function which is part of the Panthor DRM driver.",
        "attacker": "A local attacker with the ability to execute ioctl calls to the DRM subsystem.",
        "product": "Linux Kernel",
        "version": "Not specified in the provided information, but present in versions containing the affected panthor driver.",
        "component": "Panthor DRM Driver (drivers/gpu/drm/panthor)"
    }
}
