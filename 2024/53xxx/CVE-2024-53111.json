{
    "cveId": "CVE-2024-53111",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mm/mremap fix address wraparound in move_page_tables() On 32-bit platforms, it is possible for the expression `len + old_addr #include #include #include #define ADDR1 ((void*)0x60000000) #define ADDR2 ((void*)0x10000000) #define SIZE 0x50000000uL int main(void) { unsigned char *p1 = mmap(ADDR1, SIZE, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE|MAP_FIXED_NOREPLACE, -1, 0) if (p1 == MAP_FAILED) err(1, mmap 1) unsigned char *p2 = mmap(ADDR2, SIZE, PROT_NONE, MAP_ANONYMOUS|MAP_PRIVATE|MAP_FIXED_NOREPLACE, -1, 0) if (p2 == MAP_FAILED) err(1, mmap 2) *p1 = 0x41 printf(first char is 0x%02hhx\\n, *p1) unsigned char *p3 = mremap(p1, SIZE, SIZE, MREMAP_MAYMOVE|MREMAP_FIXED, p2) if (p3 == MAP_FAILED) { printf(mremap() failed first char is 0x%02hhx\\n, *p1) } else { printf(mremap() succeeded first char is 0x%02hhx\\n, *p3) } } user@horn~/big_mremap$ gcc -static -o test test.c user@horn~/big_mremap$ setarch -R ./test first char is 0x41 mremap() failed first char is 0x00 ``` With the patch ``` user@horn~/big_mremap$ setarch -R ./test first char is 0x41 mremap() succeeded first char is 0x41 ```",
    "keyphrases": {
        "rootcause": "Integer overflow in the calculation of the new address during mremap operation on 32-bit platforms.",
        "weakness": "The expression `len + old_addr` can wrap around, leading to an incorrect memory address calculation.",
        "impact": "Memory corruption or other unexpected behavior due to incorrect memory mapping. The provided code demonstrates a scenario where a failed mremap results in the original memory region being unmapped.",
        "vector": "Local, through the mremap system call with a large size parameter on 32-bit platforms.",
        "attacker": "A local user with the ability to execute the mremap syscall.",
        "product": "Linux Kernel",
        "version": "Vulnerable versions of the Linux Kernel on 32-bit platforms",
        "component": "mm/mremap"
    }
}
