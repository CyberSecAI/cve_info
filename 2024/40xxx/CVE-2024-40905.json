{
  "cveId": "CVE-2024-40905",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved ipv6 fix possible race in __fib6_drop_pcpu_from() syzbot found a race in __fib6_drop_pcpu_from() [1] If compiler reads more than once (*ppcpu_rt), second read could read NULL, if another cpu clears the value in rt6_get_pcpu_route(). Add a READ_ONCE() to prevent this race. Also add rcu_read_lock()/rcu_read_unlock() because we rely on RCU protection while dereferencing pcpu_rt. [1] Oops general protection fault, probably for non-canonical address 0xdffffc0000000012 0000 [#1] PREEMPT SMP KASAN PTI KASAN null-ptr-deref in range [0x0000000000000090-0x0000000000000097] CPU 0 PID 7543 Comm kworker/u817 Not tainted 6.10.0-rc1-syzkaller-00013-g2bfcfd584ff5 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 04/02/2024 Workqueue netns cleanup_net RIP 0010__fib6_drop_pcpu_from.part.0+0x10a/0x370 net/ipv6/ip6_fib.c984 Code f8 48 c1 e8 03 80 3c 28 00 0f 85 16 02 00 00 4d 8b 3f 4d 85 ff 74 31 e8 74 a7 fa f7 49 8d bf 90 00 00 00 48 89 f8 48 c1 e8 03 3c 28 00 0f 85 1e 02 00 00 49 8b 87 90 00 00 00 48 8b 0c 24 48 RSP 0018ffffc900040df070 EFLAGS 00010206 RAX 0000000000000012 RBX 0000000000000001 RCX ffffffff89932e16 RDX ffff888049dd1e00 RSI ffffffff89932d7c RDI 0000000000000091 RBP dffffc0000000000 R08 0000000000000005 R09 0000000000000007 R10 0000000000000001 R11 0000000000000006 R12 ffff88807fa080b8 R13 fffffbfff1a9a07d R14 ffffed100ff41022 R15 0000000",
  "keyphrases": {
    "rootcause": "race condition",
    "weakness": "null-ptr-deref",
    "impact": "Oops general protection fault",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "__fib6_drop_pcpu_from()"
  },
  "mitreTechnicalImpacts": []
}