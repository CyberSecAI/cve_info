{
    "cveId": "CVE-2024-40904",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedUSB class cdc-wdm Fix CPU lockup caused by excessive log messagesThe syzbot fuzzer found that the interrupt-URB completion callback inthe cdc-wdm driver was taking too long, and the drivers immediateresubmission of interrupt URBs with -EPROTO status combined with thedummy-hcd emulation to cause a CPU lockupcdc_wdm 1-11.0 nonzero urb status received -71cdc_wdm 1-11.0 wdm_int_callback - 0 byteswatchdog BUG soft lockup - CPU#0 stuck for 26s! [syz-executor7826625]CPU#0 Utilization every 4s during lockup #1 98% system, 0% softirq, 3% hardirq, 0% idle #2 98% system, 0% softirq, 3% hardirq, 0% idle #3 98% system, 0% softirq, 3% hardirq, 0% idle #4 98% system, 0% softirq, 3% hardirq, 0% idle #5 98% system, 1% softirq, 3% hardirq, 0% idleModules linked inirq event stamp 73096hardirqs last enabled at (73095) [] console_emit_next_record kernel/printk/printk.c2935 [inline]hardirqs last enabled at (73095) [] console_flush_all+0x650/0xb74 kernel/printk/printk.c2994hardirqs last disabled at (73096) [] __el1_irq arch/arm64/kernel/entry-common.c533 [inline]hardirqs last disabled at (73096) [] el1_interrupt+0x24/0x68 arch/arm64/kernel/entry-common.c551softirqs last enabled at (73048) [] softirq_handle_end kernel/softirq.c400 [inline]softirqs last enabled at (73048) [] handle_softirqs+0xa60/0xc34 kernel/softirq.c582softirqs last disabled at (73043) [] __do_softirq+0x14/0x20 kernel/softirq.c588CPU 0 PID 6625 Comm syz-executor782 Tainted G W 6.10.0-rc2-syzkaller-g8867bbd4a056 #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 04/02/2024Testing showed that the problem did not occur if the two errormessages -- the first two lines above -- were removed apparently addingmaterial to the kernel log takes a surprisingly large amount of time.In any case, the best approach for preventing these lockups and toavoid spamming the log with thousands of error messages per second isto ratelimit the two dev_err() calls. Therefore we replace them withdev_err_ratelimited().",
    "keyphrases": {
        "rootcause": "The interrupt-URB completion callback in the cdc-wdm driver was taking too long, and the driver's immediate resubmission of interrupt URBs with -EPROTO status combined with the dummy-hcd emulation to cause a CPU lockup.",
        "weakness": "The cdc-wdm driver's interrupt-URB completion callback was not rate-limited, leading to excessive logging of error messages and a CPU lockup under certain conditions.",
        "impact": "CPU lockup.",
        "vector": "The syzbot fuzzer triggered the vulnerability by sending a stream of interrupt URBs with -EPROTO status to the cdc-wdm driver using dummy-hcd emulation.",
        "attacker": "syzbot fuzzer",
        "product": "Linux Kernel",
        "version": "6.10.0-rc2-syzkaller-g8867bbd4a056",
        "component": "cdc-wdm driver"
    }
}
