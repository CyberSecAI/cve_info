{
    "cveId": "CVE-2024-40949",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mm shmem fix getting incorrect lruvec when replacing a shmem folio When testing shmem swapin, I encountered the warning below on my machine. The reason is that replacing an old shmem folio with a new one causes mem_cgroup_migrate() to clear the old folios memcg data. As a result, the old folio cannot get the correct memcgs lruvec needed to remove itself from the LRU list when it is being freed. This could lead to possible serious problems, such as LRU list crashes due to holding the wrong LRU lock, and incorrect LRU statistics. To fix this issue, we can fallback to use the mem_cgroup_replace_folio() to replace the old shmem folio. [ 5241.100311] page refcount0 mapcount0 mapping0000000000000000 index0x0 pfn0x5d9960 [ 5241.100317] head order4 mapcount0 entire_mapcount0 nr_pages_mapped0 pincount0 [ 5241.100319] flags 0x17fffe0000040068(uptodate|lru|head|swapbacked|node=0|zone=2|lastcpupid=0x3ffff) [ 5241.100323] raw 17fffe0000040068 fffffdffd6687948 fffffdffd69ae008 0000000000000000 [ 5241.100325] raw 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000 [ 5241.100326] head 17fffe0000040068 fffffdffd6687948 fffffdffd69ae008 0000000000000000 [ 5241.100327] head 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000 [ 5241.100328] head 17fffe0000000204 fffffdffd6665801 ffffffffffffffff 0000000000000000 [ 5241.100329] head 0000000a00000010 0000000000000000 00"
}
