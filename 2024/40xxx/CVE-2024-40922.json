{
    "cveId": "CVE-2024-40922",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedio_uring/rsrc dont lock while !TASK_RUNNINGThere is a report of io_rsrc_ref_quiesce() locking a mutex while notTASK_RUNNING, which is due to forgetting restoring the state back afterio_run_task_work_sig() and attempts to break out of the waiting loop.do not call blocking ops when !TASK_RUNNING state=1 set at[] prepare_to_wait+0xa4/0x380kernel/sched/wait.c237WARNING CPU 2 PID 397056 at kernel/sched/core.c10099__might_sleep+0x114/0x160 kernel/sched/core.c10099RIP 0010__might_sleep+0x114/0x160 kernel/sched/core.c10099Call Trace __mutex_lock_common kernel/locking/mutex.c585 [inline] __mutex_lock+0xb4/0x940 kernel/locking/mutex.c752 io_rsrc_ref_quiesce+0x590/0x940 io_uring/rsrc.c253 io_sqe_buffers_unregister+0xa2/0x340 io_uring/rsrc.c799 __io_uring_register io_uring/register.c424 [inline] __do_sys_io_uring_register+0x5b9/0x2400 io_uring/register.c613 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xd8/0x270 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x6f/0x77",
    "keyphrases": {
        "rootcause": "io_rsrc_ref_quiesce() locks a mutex while not TASK_RUNNING due to forgetting to restore the state after io_run_task_work_sig().",
        "weakness": "The code doesn't properly restore the task state after io_run_task_work_sig(), leading to blocking operations when the task is not in a running state.",
        "impact": "The system might deadlock or become unresponsive due to a blocking operation in a non-running task context.",
        "vector": "The vulnerability can be triggered through the io_uring subsystem, specifically during the unregistering of buffers via io_sqe_buffers_unregister.",
        "attacker": "A local attacker can trigger the vulnerability by making io_uring system calls in specific ways",
        "product": "Linux Kernel",
        "version": "Not specified in the provided context",
        "component": "io_uring subsystem"
    }
}
