{
    "cveId": "CVE-2024-50084",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net microchip vcap api Fix memory leaks in vcap_api_encode_rule_test() Commit a3c1e45156ad (net microchip vcap Fix use-after-free error in kunit test) fixed the use-after-free error, but introduced below memory leaks by removing necessary vcap_free_rule(), add it to fix it. unreferenced object 0xffffff80ca58b700 (size 192) comm kunit_try_catch, pid 1215, jiffies 4294898264 hex dump (first 32 bytes) 00 12 7a 00 05 00 00 00 0a 00 00 00 64 00 00 00 ..z.........d... 00 00 00 00 00 00 00 00 00 04 0b cc 80 ff ff ff ................ backtrace (crc 9c09c3fe) [] kmemleak_alloc+0x34/0x40 [] __kmalloc_cache_noprof+0x26c/0x2f4 [] vcap_alloc_rule+0x3cc/0x9c4 [] vcap_api_encode_rule_test+0x1ac/0x16b0 [] kunit_try_run_case+0x13c/0x3ac [] kunit_generic_run_threadfn_adapter+0x80/0xec [] kthread+0x2e8/0x374 [] ret_from_fork+0x10/0x20 unreferenced object 0xffffff80cc0b0400 (size 64) comm kunit_try_catch, pid 1215, jiffies 4294898265 hex dump (first 32 bytes) 80 04 0b cc 80 ff ff ff 18 b7 58 ca 80 ff ff ff ..........X..... 39 00 00 00 02 00 00 00 06 05 04 03 02 01 ff ff 9............... backtrace (crc daf014e9) [] kmemleak_alloc+0x34/0x40 [] __kmalloc_cache_noprof+0x26c/0x2f4 [] vcap_rule_add_key+0x2cc/0x528 [] vcap_api_encode_rule_test+0x224/0x16b0 [] kunit_try_run_case+0x13c/0x3ac [] kunit_generic_run_threadfn_adapter+0x80/0xec [] kthread+0x2e8/0x374 [] ret_from_fork+0x10/0x20 unreferenced object 0xffffff80cc0b0700 (size 64) comm kunit_try_catch, pid 1215, jiffies 4294898265 hex dump (first 32 bytes) 80 07 0b cc 80 ff ff ff 28 b7 58 ca 80 ff ff ff ........(.X..... 3c 00 00 00 00 00 00 00 01 2f 03 b3 ec ff ff ff ] kmemleak_alloc+0x34/0x40 [] __kmalloc_cache_noprof+0x26c/0x2f4 [] vcap_rule_add_action+0x2d0/0x52c [] vcap_api_encode_rule_test+0x4d4/0x16b0 [] kunit_try_run_case+0x13c/0x3ac [] kunit_generic_run_threadfn_adapter+0x80/0xec [] kthread+0x2e8/0x374 [] ret_from_fork+0x10/0x20 unreferenced object 0xffffff80cc0b0900 (size 64) comm kunit_try_catch, pid 1215, jiffies 4294898266 hex dump (first 32 bytes) 80 09 0b cc 80 ff ff ff 80 06 0b cc 80 ff ff ff ................ 7d 00 00 00 01 00 00 00 00 00 00 00 ff 00 00 00 }............... backtrace (crc 34181e56) [] kmemleak_alloc+0x34/0x40 [] __kmalloc_cache_noprof+0x26c/0x2f4 [] vcap_rule_add_key+0x2cc/0x528 [] vcap_val_rule+0xcf0/0x13e8 [] vcap_api_encode_rule_test+0x678/0x16b0 [] kunit_try_run_case+0x13c/0x3ac [] kunit_generic_run_threadfn_adapter+0x80/0xec [] kthread+0x2e8/0x374 [] ret_from_fork+0x10/0x20 unreferenced object 0xffffff80cc0b0980 (size 64) comm kunit_try_catch, pid 1215, jiffies 4294898266 hex dump (first 32 bytes) 18 b7 58 ca 80 ff ff ff 00 09 0b cc 80 ff ff ff ..X............. 67 00 00 00 00 00 00 00 01 01 74 88 c0 ff ff ff g.........t..... backtrace (crc 275fd9be) [] kmemleak_alloc+0x34/0x40 [] __kmalloc_cache_noprof+0x26c/0x2f4 [] vcap_rule_add_key+0x2cc/0x528 [] test_add_de ---truncated---",
    "keyphrases": {
        "rootcause": "Memory leaks were introduced in `vcap_api_encode_rule_test()` due to missing `vcap_free_rule()` calls after fixing a use-after-free error.",
        "weakness": "The code failed to free allocated memory after use, leading to memory leaks.",
        "impact": "Unreferenced memory objects accumulating, potentially leading to resource exhaustion and system instability.",
        "vector": "The vulnerability is triggered through the `vcap_api_encode_rule_test()` function within the kunit test.",
        "attacker": "The attacker is the kunit test framework that runs the vulnerable code path.",
        "product": "Linux Kernel",
        "version": "Not specified in the provided text.",
        "component": "net/microchip/vcap"
    }
}
