{
    "cveId": "CVE-2024-50039",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/sched accept TCA_STAB only for root qdisc Most qdiscs maintain their backlog using qdisc_pkt_len(skb) on the assumption it is invariant between the enqueue() and dequeue() handlers. Unfortunately syzbot can crash a host rather easily using a TBF + SFQ combination, with an STAB on SFQ [1] We cant support TCA_STAB on arbitrary level, this would require to maintain per-qdisc storage. [1] [ 88.796496] BUG kernel NULL pointer dereference, address 0000000000000000 [ 88.798611] #PF supervisor read access in kernel mode [ 88.799014] #PF error_code(0x0000) - not-present page [ 88.799506] PGD 0 P4D 0 [ 88.799829] Oops Oops 0000 [#1] SMP NOPTI [ 88.800569] CPU 14 UID 0 PID 2053 Comm b371744477 Not tainted 6.12.0-rc1-virtme #1117 [ 88.801107] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014 [ 88.801779] RIP 0010sfq_dequeue (net/sched/sch_sfq.c272 net/sched/sch_sfq.c499) sch_sfq [ 88.802544] Code 0f b7 50 12 48 8d 04 d5 00 00 00 00 48 89 d6 48 29 d0 48 8b 91 c0 01 00 00 48 c1 e0 03 48 01 c2 66 83 7a 1a 00 7e c0 48 8b 3a 8b 07 4c 89 02 49 89 50 08 48 c7 47 08 00 00 00 00 48 c7 07 00 All code ======== 00f b7 50 12 movzwl 0x12(%rax),%edx 448 8d 04 d5 00 00 00 lea 0x0(,%rdx,8),%rax b00 c48 89 d6 mov %rdx,%rsi f48 29 d0 sub %rdx,%rax 1248 8b 91 c0 01 00 00 mov 0x1c0(%rc",
    "keyphrases": {
        "rootcause": "",
        "weakness": "",
        "impact": "crash",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": ""
    }
}
