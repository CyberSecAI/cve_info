{
    "cveId": "CVE-2024-50040",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved igb Do not bring the device up after non-fatal error Commit 004d25060c78 (igb Fix igb_down hung on surprise removal) changed igb_io_error_detected() to ignore non-fatal pcie errors in order to avoid hung task that can happen when igb_down() is called multiple times. This caused an issue when processing transient non-fatal errors. igb_io_resume(), which is called after igb_io_error_detected(), assumes that device is brought down by igb_io_error_detected() if the interface is up. This resulted in panic with stacktrace below. [ T3256] igb 00000900.0 haeth0 igb haeth0 NIC Link is Down [ T292] pcieport 0000001c.5 AER Uncorrected (Non-Fatal) error received 00000900.0 [ T292] igb 00000900.0 PCIe Bus Error severity=Uncorrected (Non-Fatal), type=Transaction Layer, (Requester ID) [ T292] igb 00000900.0 device [80861537] error status/mask=00004000/00000000 [ T292] igb 00000900.0 [14] CmpltTO [ 200.105524,009][ T292] igb 00000900.0 AER TLP Header 00000000 00000000 00000000 00000000 [ T292] pcieport 0000001c.5 AER broadcast error_detected message [ T292] igb 00000900.0 Non-correctable non-fatal error reported. [ T292] pcieport 0000001c.5 AER broadcast mmio_enabled message [ T292] pcieport 0000001c.5 AER broadcast resume message [ T292] ------------[ cut here ]------------ [ T292] kernel BUG at net/core/dev.c6539! [ T292] invalid opcode 0000",
    "keyphrases": {
        "rootcause": "The commit 004d25060c78, which aimed to fix a hung task during surprise removal by ignoring non-fatal PCIe errors in `igb_io_error_detected()`, introduced a new issue. Specifically, `igb_io_resume()` incorrectly assumes the device is brought down by `igb_io_error_detected()` when the interface is up, leading to a kernel panic.",
        "weakness": "The fix for the hung task issue in commit 004d25060c78 introduced a flaw where transient non-fatal errors are not properly handled. The `igb_io_resume()` function assumes the device was taken down by `igb_io_error_detected()`, causing issues when this assumption is not met.",
        "impact": "Kernel panic and system crash due to an invalid operation in the network device driver.",
        "vector": "A non-fatal PCIe error triggers the flawed logic in the driver.",
        "attacker": "",
        "product": "Linux Kernel",
        "version": "",
        "component": "igb network driver"
    }
}