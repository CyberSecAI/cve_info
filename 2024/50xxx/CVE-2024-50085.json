{
    "cveId": "CVE-2024-50085",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mptcp pm fix UaF read in mptcp_pm_nl_rm_addr_or_subflow Syzkaller reported this splat ================================================================== BUG KASAN slab-use-after-free in mptcp_pm_nl_rm_addr_or_subflow+0xb44/0xcc0 net/mptcp/pm_netlink.c881 Read of size 4 at addr ffff8880569ac858 by task syz.1.2799/14662 CPU 0 UID 0 PID 14662 Comm syz.1.2799 Not tainted 6.12.0-rc2-syzkaller-00307-g36c254515dc6 #0 Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014 Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c120 print_address_description mm/kasan/report.c377 [inline] print_report+0xc3/0x620 mm/kasan/report.c488 kasan_report+0xd9/0x110 mm/kasan/report.c601 mptcp_pm_nl_rm_addr_or_subflow+0xb44/0xcc0 net/mptcp/pm_netlink.c881 mptcp_pm_nl_rm_subflow_received net/mptcp/pm_netlink.c914 [inline] mptcp_nl_remove_id_zero_address+0x305/0x4a0 net/mptcp/pm_netlink.c1572 mptcp_pm_nl_del_addr_doit+0x5c9/0x770 net/mptcp/pm_netlink.c1603 genl_family_rcv_msg_doit+0x202/0x2f0 net/netlink/genetlink.c1115 genl_family_rcv_msg net/netlink/genetlink.c1195 [inline] genl_rcv_msg+0x565/0x800 net/netlink/genetlink.c1210 netlink_rcv_skb+0x165/0x410 net/netlink/af_netlink.c2551 genl_rcv+0x28/0x40 net/netlink/genetlink.c1219 netlink_unicast_kernel net/netlink/af_netlink.c1331 [inline] netlink_unicast+0x53c/0x7f0 net/netlink/af_netlink.c1357 netlink_sendmsg+0x8b8/0xd70 net/netlink/af_netlink.c1901 sock_sendmsg_nosec net/socket.c729 [inline] __sock_sendmsg net/socket.c744 [inline] ____sys_sendmsg+0x9ae/0xb40 net/socket.c2607 ___sys_sendmsg+0x135/0x1e0 net/socket.c2661 __sys_sendmsg+0x117/0x1f0 net/socket.c2690 do_syscall_32_irqs_on arch/x86/entry/common.c165 [inline] __do_fast_syscall_32+0x73/0x120 arch/x86/entry/common.c386 do_fast_syscall_32+0x32/0x80 arch/x86/entry/common.c411 entry_SYSENTER_compat_after_hwframe+0x84/0x8e RIP 00230xf7fe4579 Code b8 01 10 06 03 74 b4 01 10 07 03 74 b0 01 10 08 03 74 d8 01 00 00 00 00 00 00 00 00 00 00 00 00 00 51 52 55 89 e5 0f 34 cd 80 5a 59 c3 90 90 90 90 8d b4 26 00 00 00 00 8d b4 26 00 00 00 00 RSP 002b00000000f574556c EFLAGS 00000296 ORIG_RAX 0000000000000172 RAX ffffffffffffffda RBX 000000000000000b RCX 0000000020000140 RDX 0000000000000000 RSI 0000000000000000 RDI 0000000000000000 RBP 0000000000000000 R08 0000000000000000 R09 0000000000000000 R10 0000000000000000 R11 0000000000000296 R12 0000000000000000 R13 0000000000000000 R14 0000000000000000 R15 0000000000000000 Allocated by task 5387 kasan_save_stack+0x33/0x60 mm/kasan/common.c47 kasan_save_track+0x14/0x30 mm/kasan/common.c68 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0xaa/0xb0 mm/kasan/common.c394 kmalloc_noprof include/linux/slab.h878 [inline] kzalloc_noprof include/linux/slab.h1014 [inline] subflow_create_ctx+0x87/0x2a0 net/mptcp/subflow.c1803 subflow_ulp_init+0xc3/0x4d0 net/mptcp/subflow.c1956 __tcp_set_ulp net/ipv4/tcp_ulp.c146 [inline] tcp_set_ulp+0x326/0x7f0 net/ipv4/tcp_ulp.c167 mptcp_subflow_create_socket+0x4ae/0x10a0 net/mptcp/subflow.c1764 __mptcp_subflow_connect+0x3cc/0x1490 net/mptcp/subflow.c1592 mptcp_pm_create_subflow_or_signal_addr+0xbda/0x23a0 net/mptcp/pm_netlink.c642 mptcp_pm_nl_fully_established net/mptcp/pm_netlink.c650 [inline] mptcp_pm_nl_work+0x3a1/0x4f0 net/mptcp/pm_netlink.c943 mptcp_worker+0x15a/0x1240 net/mptcp/protocol.c2777 process_one_work+0x958/0x1b30 kernel/workqueue.c3229 process_scheduled_works kernel/workqueue.c3310 [inline] worker_thread+0x6c8/0xf00 kernel/workqueue.c3391 kthread+0x2c1/0x3a0 kernel/kthread.c389 ret_from_fork+0x45/0x80 arch/x86/ke ---truncated---",
    "keyphrases": {
        "rootcause": "Use-after-free in mptcp_pm_nl_rm_addr_or_subflow",
        "weakness": "The vulnerability is caused by a use-after-free error when removing an address or subflow in the MPTCP (Multipath TCP) module.",
        "impact": "The vulnerability allows an attacker to cause a kernel panic and potentially execute arbitrary code.",
        "vector": "The vulnerability can be triggered by sending a crafted netlink message that removes an address or subflow. The attacker must have the capability to send netlink messages, typically requiring root privileges.",
        "attacker": "An attacker with root privileges.",
        "product": "Linux Kernel",
        "version": "6.12.0-rc2",
        "component": "MPTCP (Multipath TCP) module"
    }
}
