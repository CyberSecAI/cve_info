{
    "cveId": "CVE-2024-50255",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved Bluetooth hci fix null-ptr-deref in hci_read_supported_codecs Fix __hci_cmd_sync_sk() to return not NULL for unknown opcodes. __hci_cmd_sync_sk() returns NULL if a command returns a status event. However, it also returns NULL where an opcode doesnt exist in the hci_cc table because hci_cmd_complete_evt() assumes status = skb->data[0] for unknown opcodes. This leads to null-ptr-deref in cmd_sync for HCI_OP_READ_LOCAL_CODECS as there is no hci_cc for HCI_OP_READ_LOCAL_CODECS, which always assumes status = skb->data[0]. KASAN null-ptr-deref in range [0x0000000000000070-0x0000000000000077] CPU 1 PID 2000 Comm kworker/u95 Not tainted 6.9.0-ga6bcb805883c-dirty #10 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014 Workqueue hci7 hci_power_on RIP 0010hci_read_supported_codecs+0xb9/0x870 net/bluetooth/hci_codec.c138 Code 08 48 89 ef e8 b8 c1 8f fd 48 8b 75 00 e9 96 00 00 00 49 89 c6 48 ba 00 00 00 00 00 fc ff df 4c 8d 60 70 4c 89 e3 48 c1 eb 03 b6 04 13 84 c0 0f 85 82 06 00 00 41 83 3c 24 02 77 0a e8 bf 78 RSP 0018ffff888120bafac8 EFLAGS 00010212 RAX 0000000000000000 RBX 000000000000000e RCX ffff8881173f0040 RDX dffffc0000000000 RSI ffffffffa58496c0 RDI ffff88810b9ad1e4 RBP ffff88810b9ac000 R08 ffffffffa77882a7 R09 1ffffffff4ef1054 R10 dffffc0000000000 R11 fffffbfff4ef1055 R12 0000000000000070 R13 0000000000000000 R14 0000000000000000 R15 ffff88810b9ac000 FS 0000000000000000(0000) GSffff8881f6c00000(0000) knlGS0000000000000000 CS 0010 DS 0000 ES 0000 CR0 0000000080050033 CR2 00007f6ddaa3439e CR3 0000000139764003 CR4 0000000000770ef0 PKRU 55555554 Call Trace hci_read_local_codecs_sync net/bluetooth/hci_sync.c4546 [inline] hci_init_stage_sync net/bluetooth/hci_sync.c3441 [inline] hci_init4_sync net/bluetooth/hci_sync.c4706 [inline] hci_init_sync net/bluetooth/hci_sync.c4742 [inline] hci_dev_init_sync net/bluetooth/hci_sync.c4912 [inline] hci_dev_open_sync+0x19a9/0x2d30 net/bluetooth/hci_sync.c4994 hci_dev_do_open net/bluetooth/hci_core.c483 [inline] hci_power_on+0x11e/0x560 net/bluetooth/hci_core.c1015 process_one_work kernel/workqueue.c3267 [inline] process_scheduled_works+0x8ef/0x14f0 kernel/workqueue.c3348 worker_thread+0x91f/0xe50 kernel/workqueue.c3429 kthread+0x2cb/0x360 kernel/kthread.c388 ret_from_fork+0x4d/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244",
    "keyphrases": {
        "rootcause": "__hci_cmd_sync_sk() returns NULL for unknown opcodes which leads to null-ptr-deref in cmd_sync for HCI_OP_READ_LOCAL_CODECS because there is no hci_cc for HCI_OP_READ_LOCAL_CODECS",
        "weakness": "The function `__hci_cmd_sync_sk()` returns `NULL` for unknown opcodes. The code does not handle the case where `__hci_cmd_sync_sk` returns `NULL` before dereferencing",
        "impact": "Null pointer dereference, leading to a crash.",
        "vector": "Local",
        "attacker": "Local",
        "product": "Linux Kernel",
        "version": "6.9.0-ga6bcb805883c-dirty",
        "component": "Bluetooth HCI"
    }
}
