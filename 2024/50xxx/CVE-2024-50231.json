{
    "cveId": "CVE-2024-50231",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved iio gts-helper Fix memory leaks in iio_gts_build_avail_scale_table() modprobe iio-test-gts and rmmod it, then the following memory leak occurs unreferenced object 0xffffff80c810be00 (size 64) comm kunit_try_catch, pid 1654, jiffies 4294913981 hex dump (first 32 bytes) 02 00 00 00 08 00 00 00 20 00 00 00 40 00 00 00 ........ ...@... 80 00 00 00 00 02 00 00 00 04 00 00 00 08 00 00 ................ backtrace (crc a63d875e) [] kmemleak_alloc+0x34/0x40 [] __kmalloc_noprof+0x2bc/0x3c0 [] devm_iio_init_iio_gts+0x4b4/0x16f4 [] 0xffffffdf052a62e0 [] 0xffffffdf052a6488 [] kunit_try_run_case+0x13c/0x3ac [] kunit_generic_run_threadfn_adapter+0x80/0xec [] kthread+0x2e8/0x374 [] ret_from_fork+0x10/0x20 unreferenced object 0xffffff80cbfe9e70 (size 16) comm kunit_try_catch, pid 1658, jiffies 4294914015 hex dump (first 16 bytes) 10 00 00 00 40 00 00 00 80 00 00 00 00 00 00 00 ....@........... backtrace (crc 857f0cb4) [] kmemleak_alloc+0x34/0x40 [] __kmalloc_noprof+0x2bc/0x3c0 [] devm_iio_init_iio_gts+0x4b4/0x16f4 [] 0xffffffdf052a62e0 [] 0xffffffdf052a6864 [] kunit_try_run_case+0x13c/0x3ac [] kunit_generic_run_threadfn_adapter+0x80/0xec [] kthread+0x2e8/0x374 [] ret_from_fork+0x10/0x20 ...... It includes 5*5 times size 64 memory leaks, which correspond to 5 times test_init_iio_gain_scale() calls with gts_test_gains size 10 (10*size(int)) and gts_test_itimes size 5. It also includes 5*1 times size 16 memory leak, which correspond to one time __test_init_iio_gain_scale() call with gts_test_gains_gain_low size 3 (3*size(int)) and gts_test_itimes size 5. The reason is that the per_time_gains[i] is not freed which is allocated in the gts->num_itime for loop in iio_gts_build_avail_scale_table().",
    "keyphrases": {
        "rootcause": "The per_time_gains[i] is not freed which is allocated in the gts->num_itime for loop in iio_gts_build_avail_scale_table().",
        "weakness": "Memory leak due to unfreed allocated memory.",
        "impact": "Memory exhaustion and system instability.",
        "vector": "Loading and unloading the iio-test-gts module.",
        "attacker": "Local user with module loading privileges.",
        "product": "Linux Kernel",
        "version": "Not specified in the provided text",
        "component": "iio gts-helper"
    }
}
