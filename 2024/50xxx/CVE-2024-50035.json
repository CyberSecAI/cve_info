{
    "cveId": "CVE-2024-50035",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ppp fix ppp_async_encode() illegal access syzbot reported an issue in ppp_async_encode() [1] In this case, pppoe_sendmsg() is called with a zero size. Then ppp_async_encode() is called with an empty skb. BUG KMSAN uninit-value in ppp_async_encode drivers/net/ppp/ppp_async.c545 [inline] BUG KMSAN uninit-value in ppp_async_push+0xb4f/0x2660 drivers/net/ppp/ppp_async.c675 ppp_async_encode drivers/net/ppp/ppp_async.c545 [inline] ppp_async_push+0xb4f/0x2660 drivers/net/ppp/ppp_async.c675 ppp_async_send+0x130/0x1b0 drivers/net/ppp/ppp_async.c634 ppp_channel_bridge_input drivers/net/ppp/ppp_generic.c2280 [inline] ppp_input+0x1f1/0xe60 drivers/net/ppp/ppp_generic.c2304 pppoe_rcv_core+0x1d3/0x720 drivers/net/ppp/pppoe.c379 sk_backlog_rcv+0x13b/0x420 include/net/sock.h1113 __release_sock+0x1da/0x330 net/core/sock.c3072 release_sock+0x6b/0x250 net/core/sock.c3626 pppoe_sendmsg+0x2b8/0xb90 drivers/net/ppp/pppoe.c903 sock_sendmsg_nosec net/socket.c729 [inline] __sock_sendmsg+0x30f/0x380 net/socket.c744 ____sys_sendmsg+0x903/0xb60 net/socket.c2602 ___sys_sendmsg+0x28d/0x3c0 net/socket.c2656 __sys_sendmmsg+0x3c1/0x960 net/socket.c2742 __do_sys_sendmmsg net/socket.c2771 [inline] __se_sys_sendmmsg net/socket.c2768 [inline] __x64_sys_sendmmsg+0xbc/0x120 net/socket.c2768 x64_sys_call+0xb6e/0x3ba0 arch/x86/include/generated/asm/syscalls_64.h308 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f Uninit was created at slab_post_alloc_hook mm/slub.c4092 [inline] slab_alloc_node mm/slub.c4135 [inline] kmem_cache_alloc_node_noprof+0x6bf/0xb80 mm/slub.c4187 kmalloc_reserve+0x13d/0x4a0 net/core/skbuff.c587 __alloc_skb+0x363/0x7b0 net/core/skbuff.c678 alloc_skb include/linux/skbuff.h1322 [inline] sock_wmalloc+0xfe/0x1a0 net/core/sock.c2732 pppoe_sendmsg+0x3a7/0xb90 drivers/net/ppp/pppoe.c867 sock_sendmsg_nosec net/socket.c729 [inline] __sock_sendmsg+0x30f/0x380 net/socket.c744 ____sys_sendmsg+0x903/0xb60 net/socket.c2602 ___sys_sendmsg+0x28d/0x3c0 net/socket.c2656 __sys_sendmmsg+0x3c1/0x960 net/socket.c2742 __do_sys_sendmmsg net/socket.c2771 [inline] __se_sys_sendmmsg net/socket.c2768 [inline] __x64_sys_sendmmsg+0xbc/0x120 net/socket.c2768 x64_sys_call+0xb6e/0x3ba0 arch/x86/include/generated/asm/syscalls_64.h308 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f CPU 1 UID 0 PID 5411 Comm syz.1.14 Not tainted 6.12.0-rc1-syzkaller-00165-g360c1f1f24c6 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024",
    "keyphrases": {
        "rootcause": "The vulnerability occurs because `pppoe_sendmsg` is called with a zero size, resulting in `ppp_async_encode` being invoked with an empty skb. This leads to an uninitialized value being used in `ppp_async_encode`.",
        "weakness": "The `ppp_async_encode` function does not properly handle empty skb, which could lead to usage of uninitialized values.",
        "impact": "The usage of uninitialized values could lead to information leaks and potentially other undefined behavior.",
        "vector": "The vulnerability can be triggered by sending a message with a zero size through the `pppoe_sendmsg` function.",
        "attacker": "A local attacker could potentially trigger this vulnerability by crafting malicious network packets.",
        "product": "Linux Kernel",
        "version": "6.12.0-rc1",
        "component": "ppp_async.c, pppoe.c, skbuff.c, sock.c"
    }
}
