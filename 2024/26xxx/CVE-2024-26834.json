{
    "cveId": "CVE-2024-26834",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednetfilter nft_flow_offload release dst in case direct xmit path is usedDirect xmit does not use it since it calls dev_queue_xmit() to sendpackets, hence it calls dst_release().kmemleak reportsunreferenced object 0xffff88814f440900 (size 184) comm softirq, pid 0, jiffies 4294951896 hex dump (first 32 bytes) 00 60 5b 04 81 88 ff ff 00 e6 e8 82 ff ff ff ff .`[............. 21 0b 50 82 ff ff ff ff 00 00 00 00 00 00 00 00 !.P............. backtrace (crc cb2bf5d6) [] kmem_cache_alloc+0x286/0x340 [] dst_alloc+0x43/0xb0 [] rt_dst_alloc+0x2e/0x190 [] __mkroute_output+0x244/0x980 [] ip_route_output_flow+0xc0/0x160 [] nf_ip_route+0xf/0x30 [] nf_route+0x2d/0x60 [] nft_flow_route+0x171/0x6a0 [nft_flow_offload] [] nft_flow_offload_eval+0x4e8/0x700 [nft_flow_offload] [] expr_call_ops_eval+0x53/0x330 [nf_tables] [] nft_do_chain+0x17c/0x840 [nf_tables] [] nft_do_chain_inet+0xa1/0x210 [nf_tables] [] nf_hook_slow+0x5b/0x160 [] ip_forward+0x8b6/0x9b0 [] ip_rcv+0x221/0x230 [] __netif_receive_skb_one_core+0xfe/0x110",
    "keyphrases": {
        "rootcause": "The netfilter nft_flow_offload module fails to release the destination (dst) object when the direct transmit path is used. Specifically, the direct transmit path calls dev_queue_xmit() which then calls dst_release(), but nft_flow_offload does not account for this path.",
        "weakness": "Resource Leak",
        "impact": "Memory leak",
        "vector": "Network traffic using nft_flow_offload",
        "attacker": "Local or remote user",
        "product": "Linux Kernel",
        "version": "Likely affected versions prior to the fix",
        "component": "netfilter nft_flow_offload"
    }
}
