{
    "cveId": "CVE-2024-26875",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedmedia pvrusb2 fix uaf in pvr2_context_set_notify[Syzbot reported]BUG KASAN slab-use-after-free in pvr2_context_set_notify+0x2c4/0x310 drivers/media/usb/pvrusb2/pvrusb2-context.c35Read of size 4 at addr ffff888113aeb0d8 by task kworker/11/26CPU 1 PID 26 Comm kworker/11 Not tainted 6.8.0-rc1-syzkaller-00046-gf1a27f081c1f #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/25/2024Workqueue usb_hub_wq hub_eventCall Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xd9/0x1b0 lib/dump_stack.c106 print_address_description mm/kasan/report.c377 [inline] print_report+0xc4/0x620 mm/kasan/report.c488 kasan_report+0xda/0x110 mm/kasan/report.c601 pvr2_context_set_notify+0x2c4/0x310 drivers/media/usb/pvrusb2/pvrusb2-context.c35 pvr2_context_notify drivers/media/usb/pvrusb2/pvrusb2-context.c95 [inline] pvr2_context_disconnect+0x94/0xb0 drivers/media/usb/pvrusb2/pvrusb2-context.c272Freed by task 906kasan_save_stack+0x33/0x50 mm/kasan/common.c47kasan_save_track+0x14/0x30 mm/kasan/common.c68kasan_save_free_info+0x3f/0x60 mm/kasan/generic.c640poison_slab_object mm/kasan/common.c241 [inline]__kasan_slab_free+0x106/0x1b0 mm/kasan/common.c257kasan_slab_free include/linux/kasan.h184 [inline]slab_free_hook mm/slub.c2121 [inline]slab_free mm/slub.c4299 [inline]kfree+0x105/0x340 mm/slub.c4409pvr2_context_check drivers/media/usb/pvrusb2/pvrusb2-context.c137 [inline]pvr2_context_thread_func+0x69d/0x960 drivers/media/usb/pvrusb2/pvrusb2-context.c158[Analyze]Task A set disconnect_flag = !0, which resulted in Task Bs condition being metand releasing mp, leading to this issue.[Fix]Place the disconnect_flag assignment operation after all code in pvr2_context_disconnect()to avoid this issue.",
    "keyphrases": {
        "rootcause": "Use-after-free in pvr2_context_set_notify",
        "weakness": "The disconnect_flag was set before all cleanup operations in pvr2_context_disconnect(), leading to premature release of resources.",
        "impact": "Memory corruption and potential system instability due to use-after-free.",
        "vector": "The vulnerability is triggered through a specific sequence of operations involving setting and disconnecting contexts.",
        "attacker": "Syzbot reported this bug.",
        "product": "Linux Kernel",
        "version": "6.8.0-rc1",
        "component": "drivers/media/usb/pvrusb2/pvrusb2-context.c"
    }
}
