{
    "cveId": "CVE-2024-26857",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved geneve make sure to pull inner header in geneve_rx() syzbot triggered a bug in geneve_rx() [1] Issue is similar to the one I fixed in commit 8d975c15c0cd (ip6_tunnel make sure to pull inner header in __ip6_tnl_rcv()) We have to save skb->network_header in a temporary variable in order to be able to recompute the network_header pointer after a pskb_inet_may_pull() call. pskb_inet_may_pull() makes sure the needed headers are in skb->head. [1] BUG KMSAN uninit-value in IP_ECN_decapsulate include/net/inet_ecn.h302 [inline] BUG KMSAN uninit-value in geneve_rx drivers/net/geneve.c279 [inline] BUG KMSAN uninit-value in geneve_udp_encap_recv+0x36f9/0x3c10 drivers/net/geneve.c391 IP_ECN_decapsulate include/net/inet_ecn.h302 [inline] geneve_rx drivers/net/geneve.c279 [inline] geneve_udp_encap_recv+0x36f9/0x3c10 drivers/net/geneve.c391 udp_queue_rcv_one_skb+0x1d39/0x1f20 net/ipv4/udp.c2108 udp_queue_rcv_skb+0x6ae/0x6e0 net/ipv4/udp.c2186 udp_unicast_rcv_skb+0x184/0x4b0 net/ipv4/udp.c2346 __udp4_lib_rcv+0x1c6b/0x3010 net/ipv4/udp.c2422 udp_rcv+0x7d/0xa0 net/ipv4/udp.c2604 ip_protocol_deliver_rcu+0x264/0x1300 net/ipv4/ip_input.c205 ip_local_deliver_finish+0x2b8/0x440 net/ipv4/ip_input.c233 NF_HOOK include/linux/netfilter.h314 [inline] ip_local_deliver+0x21f/0x490 net/ipv4/ip_input.c254 dst_input include/net/dst.h461 [inline] ip_rcv_finish net/ipv4/ip_input.c44",
    "keyphrases": {
        "rootcause": "uninitialized value",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "geneve_rx"
    }
}
