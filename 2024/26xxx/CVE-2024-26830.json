{
    "cveId": "CVE-2024-26830",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved i40e Do not allow untrusted VF to remove administratively set MAC Currently when PF administratively sets VFs MAC address and the VF is put down (VF tries to delete all MACs) then the MAC is removed from MAC filters and primary VF MAC is zeroed. Do not allow untrusted VF to remove primary MAC when it was set administratively by PF. Reproducer 1) Create VF 2) Set VF interface up 3) Administratively set the VFs MAC 4) Put VF interface down [root@host ~]# echo 1 > /sys/class/net/enp2s0f0/device/sriov_numvfs [root@host ~]# ip link set enp2s0f0v0 up [root@host ~]# ip link set enp2s0f0 vf 0 mac fe6cb5dac77d [root@host ~]# ip link show enp2s0f0 23 enp2s0f0 mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000 link/ether 3cecefb7dd04 brd ffffffffffff vf 0 link/ether fe6cb5dac77d brd ffffffffffff, spoof checking on, link-state auto, trust off [root@host ~]# ip link set enp2s0f0v0 down [root@host ~]# ip link show enp2s0f0 23 enp2s0f0 mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000 link/ether 3cecefb7dd04 brd ffffffffffff vf 0 link/ether 000000000000 brd ffffffffffff, spoof checking on, link-state auto, trust off",
    "keyphrases": {
        "rootcause": "",
        "weakness": "",
        "impact": "remove primary MAC when set by PF",
        "vector": [
            "put down VF interface",
            "delete all MACs"
        ],
        "attacker": "untrusted VF",
        "product": "Linux kernel",
        "version": "",
        "component": "i40e"
    }
}
