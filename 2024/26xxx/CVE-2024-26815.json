{
    "cveId": "CVE-2024-26815",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednet/sched taprio proper TCA_TAPRIO_TC_ENTRY_INDEX checktaprio_parse_tc_entry() is not correctly checkingTCA_TAPRIO_TC_ENTRY_INDEX attribute int tc // Signed value tc = nla_get_u32(tb[TCA_TAPRIO_TC_ENTRY_INDEX]) if (tc >= TC_QOPT_MAX_QUEUE) { NL_SET_ERR_MSG_MOD(extack, TC entry index out of range) return -ERANGE }syzbot reported that it could fed arbitary negative valuesUBSAN shift-out-of-bounds in net/sched/sch_taprio.c172218shift exponent -2147418108 is negativeCPU 0 PID 5066 Comm syz-executor367 Not tainted 6.8.0-rc7-syzkaller-00136-gc8a5c731fd12 #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 02/29/2024Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x1e7/0x2e0 lib/dump_stack.c106 ubsan_epilogue lib/ubsan.c217 [inline] __ubsan_handle_shift_out_of_bounds+0x3c7/0x420 lib/ubsan.c386 taprio_parse_tc_entry net/sched/sch_taprio.c1722 [inline] taprio_parse_tc_entries net/sched/sch_taprio.c1768 [inline] taprio_change+0xb87/0x57d0 net/sched/sch_taprio.c1877 taprio_init+0x9da/0xc80 net/sched/sch_taprio.c2134 qdisc_create+0x9d4/0x1190 net/sched/sch_api.c1355 tc_modify_qdisc+0xa26/0x1e40 net/sched/sch_api.c1776 rtnetlink_rcv_msg+0x885/0x1040 net/core/rtnetlink.c6617 netlink_rcv_skb+0x1e3/0x430 net/netlink/af_netlink.c2543 netlink_unicast_kernel net/netlink/af_netlink.c1341 [inline] netlink_unicast+0x7ea/0x980 net/netlink/af_netlink.c1367 netlink_sendmsg+0xa3b/0xd70 net/netlink/af_netlink.c1908 sock_sendmsg_nosec net/socket.c730 [inline] __sock_sendmsg+0x221/0x270 net/socket.c745 ____sys_sendmsg+0x525/0x7d0 net/socket.c2584 ___sys_sendmsg net/socket.c2638 [inline] __sys_sendmsg+0x2b0/0x3a0 net/socket.c2667 do_syscall_64+0xf9/0x240 entry_SYSCALL_64_after_hwframe+0x6f/0x77RIP 00330x7f1b2dea3759Code 48 83 c4 28 c3 e8 d7 19 00 00 0f 1f 80 00 00 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48RSP 002b00007ffd4de452f8 EFLAGS 00000246 ORIG_RAX 000000000000002eRAX ffffffffffffffda RBX 00007f1b2def0390 RCX 00007f1b2dea3759RDX 0000000000000000 RSI 00000000200007c0 RDI 0000000000000004RBP 0000000000000003 R08 0000555500000000 R09 0000555500000000R10 0000555500000000 R11 0000000000000246 R12 00007ffd4de45340R13 00007ffd4de45310 R14 0000000000000001 R15 00007ffd4de45340",
    "keyphrases": {
        "rootcause": "The vulnerability is due to a missing check for negative values in the TCA_TAPRIO_TC_ENTRY_INDEX attribute within the taprio_parse_tc_entry() function. The code uses an unsigned 32 bit integer but doesn't check for negative values before casting into a signed int resulting in out of bounds access.",
        "weakness": "Improper input validation, specifically lack of a check for negative values before casting an unsigned integer to a signed integer.",
        "impact": "Arbitrary negative values can be fed to the function, leading to an out-of-bounds shift operation, which triggers a kernel panic due to the UBSAN error. This can cause denial of service.",
        "vector": "The vulnerability is triggered through the netlink interface via the rtnetlink protocol by sending a crafted message with a negative value for the TCA_TAPRIO_TC_ENTRY_INDEX attribute.",
        "attacker": "An attacker can trigger this vulnerability by sending a specially crafted netlink message with a negative value for TCA_TAPRIO_TC_ENTRY_INDEX.",
        "product": "Linux Kernel",
        "version": "6.8.0-rc7",
        "component": "net/sched/sch_taprio.c"
    }
}
