{
    "cveId": "CVE-2024-26815",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/sched taprio proper TCA_TAPRIO_TC_ENTRY_INDEX check taprio_parse_tc_entry() is not correctly checking TCA_TAPRIO_TC_ENTRY_INDEX attribute int tc // Signed value tc = nla_get_u32(tb[TCA_TAPRIO_TC_ENTRY_INDEX]) if (tc >= TC_QOPT_MAX_QUEUE) { NL_SET_ERR_MSG_MOD(extack, TC entry index out of range) return -ERANGE } syzbot reported that it could fed arbitary negative values UBSAN shift-out-of-bounds in net/sched/sch_taprio.c172218 shift exponent -2147418108 is negative CPU 0 PID 5066 Comm syz-executor367 Not tainted 6.8.0-rc7-syzkaller-00136-gc8a5c731fd12 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 02/29/2024 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x1e7/0x2e0 lib/dump_stack.c106 ubsan_epilogue lib/ubsan.c217 [inline] __ubsan_handle_shift_out_of_bounds+0x3c7/0x420 lib/ubsan.c386 taprio_parse_tc_entry net/sched/sch_taprio.c1722 [inline] taprio_parse_tc_entries net/sched/sch_taprio.c1768 [inline] taprio_change+0xb87/0x57d0 net/sched/sch_taprio.c1877 taprio_init+0x9da/0xc80 net/sched/sch_taprio.c2134 qdisc_create+0x9d4/0x1190 net/sched/sch_api.c1355 tc_modify_qdisc+0xa26/0x1e40 net/sched/sch_api.c1776 rtnetlink_rcv_msg+0x885/0x1040 net/core/rtnetlink.c6617 netlink_rcv_skb+0x1e3/0x430 net/netlink/af_netlink.c2543 netlink_unicast_kernel net/netlink/af_netlink.c1341 [inline] netlin"
}
