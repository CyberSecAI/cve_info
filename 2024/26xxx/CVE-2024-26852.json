{
    "cveId": "CVE-2024-26852",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/ipv6 avoid possible UAF in ip6_route_mpath_notify() syzbot found another use-after-free in ip6_route_mpath_notify() [1] Commit f7225172f25a (net/ipv6 prevent use after free in ip6_route_mpath_notify) was not able to fix the root cause. We need to defer the fib6_info_release() calls after ip6_route_mpath_notify(), in the cleanup phase. [1] BUG KASAN slab-use-after-free in rt6_fill_node+0x1460/0x1ac0 Read of size 4 at addr ffff88809a07fc64 by task syz-executor.2/23037 CPU 0 PID 23037 Comm syz-executor.2 Not tainted 6.8.0-rc4-syzkaller-01035-gea7f3cfaa588 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/25/2024 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x1e7/0x2e0 lib/dump_stack.c106 print_address_description mm/kasan/report.c377 [inline] print_report+0x167/0x540 mm/kasan/report.c488 kasan_report+0x142/0x180 mm/kasan/report.c601 rt6_fill_node+0x1460/0x1ac0 inet6_rt_notify+0x13b/0x290 net/ipv6/route.c6184 ip6_route_mpath_notify net/ipv6/route.c5198 [inline] ip6_route_multipath_add net/ipv6/route.c5404 [inline] inet6_rtm_newroute+0x1d0f/0x2300 net/ipv6/route.c5517 rtnetlink_rcv_msg+0x885/0x1040 net/core/rtnetlink.c6597 netlink_rcv_skb+0x1e3/0x430 net/netlink/af_netlink.c2543 netlink_unicast_kernel net/netlink/af_netlink.c1341 [inline] netlink_unicast+0x7ea/0x980 net/netlink/af_netlink.c1"
}
