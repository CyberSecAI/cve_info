{
    "cveId": "CVE-2024-26641",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedip6_tunnel make sure to pull inner header in __ip6_tnl_rcv()syzbot found __ip6_tnl_rcv() could access unitiliazed data [1].Call pskb_inet_may_pull() to fix this, and initialize ipv6hvariable after this call as it can change skb->head.[1] BUG KMSAN uninit-value in __INET_ECN_decapsulate include/net/inet_ecn.h253 [inline] BUG KMSAN uninit-value in INET_ECN_decapsulate include/net/inet_ecn.h275 [inline] BUG KMSAN uninit-value in IP6_ECN_decapsulate+0x7df/0x1e50 include/net/inet_ecn.h321 __INET_ECN_decapsulate include/net/inet_ecn.h253 [inline] INET_ECN_decapsulate include/net/inet_ecn.h275 [inline] IP6_ECN_decapsulate+0x7df/0x1e50 include/net/inet_ecn.h321 ip6ip6_dscp_ecn_decapsulate+0x178/0x1b0 net/ipv6/ip6_tunnel.c727 __ip6_tnl_rcv+0xd4e/0x1590 net/ipv6/ip6_tunnel.c845 ip6_tnl_rcv+0xce/0x100 net/ipv6/ip6_tunnel.c888 gre_rcv+0x143f/0x1870 ip6_protocol_deliver_rcu+0xda6/0x2a60 net/ipv6/ip6_input.c438 ip6_input_finish net/ipv6/ip6_input.c483 [inline] NF_HOOK include/linux/netfilter.h314 [inline] ip6_input+0x15d/0x430 net/ipv6/ip6_input.c492 ip6_mc_input+0xa7e/0xc80 net/ipv6/ip6_input.c586 dst_input include/net/dst.h461 [inline] ip6_rcv_finish+0x5db/0x870 net/ipv6/ip6_input.c79 NF_HOOK include/linux/netfilter.h314 [inline] ipv6_rcv+0xda/0x390 net/ipv6/ip6_input.c310 __netif_receive_skb_one_core net/core/dev.c5532 [inline] __netif_receive_skb+0x1a6/0x5a0 net/core/dev.c5646 netif_receive_skb_internal net/core/dev.c5732 [inline] netif_receive_skb+0x58/0x660 net/core/dev.c5791 tun_rx_batched+0x3ee/0x980 drivers/net/tun.c1555 tun_get_user+0x53af/0x66d0 drivers/net/tun.c2002 tun_chr_write_iter+0x3af/0x5d0 drivers/net/tun.c2048 call_write_iter include/linux/fs.h2084 [inline] new_sync_write fs/read_write.c497 [inline] vfs_write+0x786/0x1200 fs/read_write.c590 ksys_write+0x20f/0x4c0 fs/read_write.c643 __do_sys_write fs/read_write.c655 [inline] __se_sys_write fs/read_write.c652 [inline] __x64_sys_write+0x93/0xd0 fs/read_write.c652 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0x6d/0x140 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x63/0x6bUninit was created at slab_post_alloc_hook+0x129/0xa70 mm/slab.h768 slab_alloc_node mm/slub.c3478 [inline] kmem_cache_alloc_node+0x5e9/0xb10 mm/slub.c3523 kmalloc_reserve+0x13d/0x4a0 net/core/skbuff.c560 __alloc_skb+0x318/0x740 net/core/skbuff.c651 alloc_skb include/linux/skbuff.h1286 [inline] alloc_skb_with_frags+0xc8/0xbd0 net/core/skbuff.c6334 sock_alloc_send_pskb+0xa80/0xbf0 net/core/sock.c2787 tun_alloc_skb drivers/net/tun.c1531 [inline] tun_get_user+0x1e8a/0x66d0 drivers/net/tun.c1846 tun_chr_write_iter+0x3af/0x5d0 drivers/net/tun.c2048 call_write_iter include/linux/fs.h2084 [inline] new_sync_write fs/read_write.c497 [inline] vfs_write+0x786/0x1200 fs/read_write.c590 ksys_write+0x20f/0x4c0 fs/read_write.c643 __do_sys_write fs/read_write.c655 [inline] __se_sys_write fs/read_write.c652 [inline] __x64_sys_write+0x93/0xd0 fs/read_write.c652 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0x6d/0x140 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x63/0x6bCPU 0 PID 5034 Comm syz-executor331 Not tainted 6.7.0-syzkaller-00562-g9f8413c4a66f #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 11/17/2023",
    "keyphrases": {
        "rootcause": "Uninitialized data access in __ip6_tnl_rcv() due to missing pskb_inet_may_pull() call before accessing inner header",
        "weakness": "Improper initialization of variables leading to uninitialized memory access",
        "impact": "Kernel memory corruption and potential information leak",
        "vector": "Network packet processing via IPv6 tunnel",
        "attacker": "Malicious network traffic",
        "product": "Linux Kernel",
        "version": "6.7.0-syzkaller-00562-g9f8413c4a66f",
        "component": "ip6_tunnel"
    }
}
