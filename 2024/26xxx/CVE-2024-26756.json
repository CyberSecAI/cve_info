{
    "cveId": "CVE-2024-26756",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved md Dont register sync_thread for reshape directly Currently, if reshape is interrupted, then reassemble the array will register sync_thread directly from pers->run(), in this case MD_RECOVERY_RUNNING is set directly, however, there is no guarantee that md_do_sync() will be executed, hence stop_sync_thread() will hang because MD_RECOVERY_RUNNING cant be cleared. Last patch make sure that md_do_sync() will set MD_RECOVERY_DONE, however, following hang can still be triggered by dm-raid test shell/lvconvert-raid-reshape.sh occasionally [root@fedora ~]# cat /proc/1982/stack [] stop_sync_thread+0x1ab/0x270 [md_mod] [] md_frozen_sync_thread+0x5c/0xa0 [md_mod] [] raid_presuspend+0x1e/0x70 [dm_raid] [] dm_table_presuspend_targets+0x40/0xb0 [dm_mod] [] __dm_destroy+0x2a5/0x310 [dm_mod] [] dm_destroy+0x16/0x30 [dm_mod] [] dev_remove+0x165/0x290 [dm_mod] [] ctl_ioctl+0x4bb/0x7b0 [dm_mod] [] dm_ctl_ioctl+0x11/0x20 [dm_mod] [] vfs_ioctl+0x21/0x60 [] __x64_sys_ioctl+0xb9/0xe0 [] do_syscall_64+0xc6/0x230 [] entry_SYSCALL_64_after_hwframe+0x6c/0x74 Meanwhile mddev->recovery is MD_RECOVERY_RUNNING | MD_RECOVERY_INTR | MD_RECOVERY_RESHAPE | MD_RECOVERY_FROZEN Fix this problem by remove the code to register sync_thread directly from raid10 and raid5. And let md_check_recovery() to register sync_thread.",
    "keyphrases": {
        "rootcause": "improper thread registration",
        "weakness": "",
        "impact": "stop_sync_thread() will hang",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "md module"
    }
}
