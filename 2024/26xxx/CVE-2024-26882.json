{
    "cveId": "CVE-2024-26882",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net ip_tunnel make sure to pull inner header in ip_tunnel_rcv() Apply the same fix than ones found in 8d975c15c0cd (ip6_tunnel make sure to pull inner header in __ip6_tnl_rcv()) 1ca1ba465e55 (geneve make sure to pull inner header in geneve_rx()) We have to save skb->network_header in a temporary variable in order to be able to recompute the network_header pointer after a pskb_inet_may_pull() call. pskb_inet_may_pull() makes sure the needed headers are in skb->head. syzbot reported BUG KMSAN uninit-value in __INET_ECN_decapsulate include/net/inet_ecn.h253 [inline] BUG KMSAN uninit-value in INET_ECN_decapsulate include/net/inet_ecn.h275 [inline] BUG KMSAN uninit-value in IP_ECN_decapsulate include/net/inet_ecn.h302 [inline] BUG KMSAN uninit-value in ip_tunnel_rcv+0xed9/0x2ed0 net/ipv4/ip_tunnel.c409 __INET_ECN_decapsulate include/net/inet_ecn.h253 [inline] INET_ECN_decapsulate include/net/inet_ecn.h275 [inline] IP_ECN_decapsulate include/net/inet_ecn.h302 [inline] ip_tunnel_rcv+0xed9/0x2ed0 net/ipv4/ip_tunnel.c409 __ipgre_rcv+0x9bc/0xbc0 net/ipv4/ip_gre.c389 ipgre_rcv net/ipv4/ip_gre.c411 [inline] gre_rcv+0x423/0x19f0 net/ipv4/ip_gre.c447 gre_rcv+0x2a4/0x390 net/ipv4/gre_demux.c163 ip_protocol_deliver_rcu+0x264/0x1300 net/ipv4/ip_input.c205 ip_local_deliver_finish+0x2b8/0x440 net/ipv4/ip_input.c233 NF_HOOK include/linux/netfilter.h314 [inline] i",
    "keyphrases": {
        "rootcause": "Use of uninitialized value",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": [
            "__INET_ECN_decapsulate",
            "INET_ECN_decapsulate",
            "IP_ECN_decapsulate",
            "ip_tunnel_rcv",
            "ipgre_rcv",
            "gre_rcv",
            "ip_protocol_deliver_rcu",
            "ip_local_deliver_finish"
        ]
    }
}
