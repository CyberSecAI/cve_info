{
    "cveId": "CVE-2024-26658",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved bcachefs grab s_umount only if snapshotting When I was testing mongodb over bcachefs with compression, there is a lockdep warning when snapshotting mongodb data volume. $ cat test.sh prog=bcachefs $prog subvolume create /mnt/data $prog subvolume create /mnt/data/snapshots while truedo $prog subvolume snapshot /mnt/data /mnt/data/snapshots/$(date +%s) sleep 1s done $ cat /etc/mongodb.conf systemLog destination file logAppend true path /mnt/data/mongod.log storage dbPath /mnt/data/ lockdep reports [ 3437.452330] ====================================================== [ 3437.452750] WARNING possible circular locking dependency detected [ 3437.453168] 6.7.0-rc7-custom+ #85 Tainted G E [ 3437.453562] ------------------------------------------------------ [ 3437.453981] bcachefs/35533 is trying to acquire lock [ 3437.454325] ffffa0a02b2b1418 (sb_writers#10){.+.+}-{00}, at filename_create+0x62/0x190 [ 3437.454875] but task is already holding lock [ 3437.455268] ffffa0a02b2b10e0 (&type->s_umount_key#48){.+.+}-{33}, at bch2_fs_file_ioctl+0x232/0xc90 [bcachefs] [ 3437.456009] which lock already depends on the new lock. [ 3437.456553] the existing dependency chain (in reverse order) is [ 3437.457054] -> #3 (&type->s_umount_key#48){.+.+}-{33} [ 3437.457507] down_read+0x3e/0x170 [ 3437.457772] b"
}
