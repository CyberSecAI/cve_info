{
    "cveId": "CVE-2024-26614",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedtcp make sure init the accept_queues spinlocks onceWhen I run syzs reproduction C program locally, it causes the followingissuepvqspinlock lock 0xffff9d181cd5c660 has corrupted value 0x0!WARNING CPU 19 PID 21160 at __pv_queued_spin_unlock_slowpath (kernel/locking/qspinlock_paravirt.h508)Hardware name Red Hat KVM, BIOS 0.5.1 01/01/2011RIP 0010__pv_queued_spin_unlock_slowpath (kernel/locking/qspinlock_paravirt.h508)Code 73 56 3a ff 90 c3 cc cc cc cc 8b 05 bb 1f 48 01 85 c0 74 05 c3 cc cc cc cc 8b 17 48 89 fe 48 c7 c730 20 ce 8f e8 ad 56 42 ff 0b c3 cc cc cc cc 0f 0b 0f 1f 40 00 90 90 90 90 90 90 90 90 90RSP 0018ffffa8d200604cb8 EFLAGS 00010282RAX 0000000000000000 RBX 0000000000000000 RCX ffff9d1ef60e0908RDX 00000000ffffffd8 RSI 0000000000000027 RDI ffff9d1ef60e0900RBP ffff9d181cd5c280 R08 0000000000000000 R09 00000000ffff7fffR10 ffffa8d200604b68 R11 ffffffff907dcdc8 R12 0000000000000000R13 ffff9d181cd5c660 R14 ffff9d1813a3f330 R15 0000000000001000FS 00007fa110184640(0000) GSffff9d1ef60c0000(0000) knlGS0000000000000000CS 0010 DS 0000 ES 0000 CR0 0000000080050033CR2 0000000020000000 CR3 000000011f65e000 CR4 00000000000006f0Call Trace _raw_spin_unlock (kernel/locking/spinlock.c186) inet_csk_reqsk_queue_add (net/ipv4/inet_connection_sock.c1321) inet_csk_complete_hashdance (net/ipv4/inet_connection_sock.c1358) tcp_check_req (net/ipv4/tcp_minisocks.c868) tcp_v4_rcv (net/ipv4/tcp_ipv4.c2260) ip_protocol_deliver_rcu (net/ipv4/ip_input.c205) ip_local_deliver_finish (net/ipv4/ip_input.c234) __netif_receive_skb_one_core (net/core/dev.c5529) process_backlog (./include/linux/rcupdate.h779) __napi_poll (net/core/dev.c6533) net_rx_action (net/core/dev.c6604) __do_softirq (./arch/x86/include/asm/jump_label.h27) do_softirq (kernel/softirq.c454 kernel/softirq.c441) __local_bh_enable_ip (kernel/softirq.c381) __dev_queue_xmit (net/core/dev.c4374) ip_finish_output2 (./include/net/neighbour.h540 net/ipv4/ip_output.c235) __ip_queue_xmit (net/ipv4/ip_output.c535) __tcp_transmit_skb (net/ipv4/tcp_output.c1462) tcp_rcv_synsent_state_process (net/ipv4/tcp_input.c6469) tcp_rcv_state_process (net/ipv4/tcp_input.c6657) tcp_v4_do_rcv (net/ipv4/tcp_ipv4.c1929) __release_sock (./include/net/sock.h1121 net/core/sock.c2968) release_sock (net/core/sock.c3536) inet_wait_for_connect (net/ipv4/af_inet.c609) __inet_stream_connect (net/ipv4/af_inet.c702) inet_stream_connect (net/ipv4/af_inet.c748) __sys_connect (./include/linux/file.h45 net/socket.c2064) __x64_sys_connect (net/socket.c2073 net/socket.c2070 net/socket.c2070) do_syscall_64 (arch/x86/entry/common.c51 arch/x86/entry/common.c82) entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S129) RIP 00330x7fa10ff05a3d Code 5b 41 5c c3 66 0f 1f 84 00 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 3d 01 f0 ff ff 73 01 c3 48 8b 0d ab a3 0e 00 f7 d8 64 89 01 48 RSP 002b00007fa110183de8 EFLAGS 00000202 ORIG_RAX 000000000000002a RAX ffffffffffffffda RBX 0000000020000054 RCX 00007fa10ff05a3d RDX 000000000000001c RSI 0000000020000040 RDI 0000000000000003 RBP 00007fa110183e20 R08 0000000000000000 R09 0000000000000000 R10 0000000000000000 R11 0000000000000202 R12 00007fa110184640 R13 0000000000000000 R14 00007fa10fe8b060 R15 00007fff73e23b20The issue triggering process is analyzed as followsThread A Thread Btcp_v4_rcv //receive ack TCP packet inet_shutdown tcp_check_req tcp_disconnect //disconnect sock ... tcp_set_state(sk, TCP_CLOSE) inet_csk_complete_hashdance ... inet_csk_reqsk_queue_add ---truncated---",
    "keyphrases": {
        "rootcause": "The spinlock accept_queues was not properly initialized which lead to a corrupted value when a thread tries to unlock it",
        "weakness": "The spinlock accept_queues should be initialized properly before use.",
        "impact": "Kernel crash due to corrupted spinlock value.",
        "vector": "A crafted TCP packet can trigger the vulnerability.",
        "attacker": "A remote attacker can send malicious TCP packets to trigger this bug.",
        "product": "Linux Kernel",
        "version": "N/A",
        "component": "TCP networking stack"
    }
}
