{
    "cveId": "CVE-2024-26892",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedwifi mt76 mt7921e fix use-after-free in free_irq()From commit a304e1b82808 ([PATCH] Debug shared irqs), there is a testto make sure the shared irq handler should be able to handle the unexpectedevent after deregistration. For this case, lets apply MT76_REMOVED flag toindicate the device was removed and do not run into the resource accessanymore.BUG KASAN use-after-free in mt7921_irq_handler+0xd8/0x100 [mt7921e]Read of size 8 at addr ffff88824a7d3b78 by task rmmod/11115CPU 28 PID 11115 Comm rmmod Tainted G W L 5.17.0 #10Hardware name Micro-Star International Co., Ltd. MS-7D73/MPG B650IEDGE WIFI (MS-7D73), BIOS 1.81 01/05/2024Call Trace dump_stack_lvl+0x6f/0xa0 print_address_description.constprop.0+0x1f/0x190 ? mt7921_irq_handler+0xd8/0x100 [mt7921e] ? mt7921_irq_handler+0xd8/0x100 [mt7921e] kasan_report.cold+0x7f/0x11b ? mt7921_irq_handler+0xd8/0x100 [mt7921e] mt7921_irq_handler+0xd8/0x100 [mt7921e] free_irq+0x627/0xaa0 devm_free_irq+0x94/0xd0 ? devm_request_any_context_irq+0x160/0x160 ? kobject_put+0x18d/0x4a0 mt7921_pci_remove+0x153/0x190 [mt7921e] pci_device_remove+0xa2/0x1d0 __device_release_driver+0x346/0x6e0 driver_detach+0x1ef/0x2c0 bus_remove_driver+0xe7/0x2d0 ? __check_object_size+0x57/0x310 pci_unregister_driver+0x26/0x250 __do_sys_delete_module+0x307/0x510 ? free_module+0x6a0/0x6a0 ? fpregs_assert_state_consistent+0x4b/0xb0 ? rcu_read_lock_sched_held+0x10/0x70 ? syscall_enter_from_user_mode+0x20/0x70 ? trace_hardirqs_on+0x1c/0x130 do_syscall_64+0x5c/0x80 ? trace_hardirqs_on_prepare+0x72/0x160 ? do_syscall_64+0x68/0x80 ? trace_hardirqs_on_prepare+0x72/0x160 entry_SYSCALL_64_after_hwframe+0x44/0xae",
    "keyphrases": {
        "rootcause": "Use-after-free in the mt7921_irq_handler function due to a race condition during the unregistration of the interrupt handler.",
        "weakness": "Race condition during device removal leads to use-after-free.",
        "impact": "System crash due to memory corruption.",
        "vector": "Local",
        "attacker": "A malicious actor can trigger this bug by removing the network driver at an inopportune time",
        "product": "Linux Kernel",
        "version": "5.17.0",
        "component": "mt7921e WiFi driver"
    }
}
