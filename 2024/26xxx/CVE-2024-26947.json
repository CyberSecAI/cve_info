{
  "cveId": "CVE-2024-26947",
  "version": "1.0.0",
  "timestamp": "2024-12-19T22:22:49.126128+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolvedARM 9359/1 flush check if the folio is reserved for no-mapping addressesSince commit a4d5613c4dc6 (arm extend pfn_valid to take into accountfreed memory map alignment) changes the semantics of pfn_valid() to checkpresence of the memory map for a PFN. A valid page for an address whichis reserved but not mapped by the kernel[1], the system crashed duringsome uio test with the following memory layout node 0 [mem 0x00000000c0a00000-0x00000000cc8fffff] node 0 [mem 0x00000000d0000000-0x00000000da1fffff] the uio layout is0xc0900000, 0x100000the crash backtrace like Unable to handle kernel paging request at virtual address bff00000 [...] CPU 1 PID 465 Comm startapp.bin Tainted G O 5.10.0 #1 Hardware name Generic DT based system PC is at b15_flush_kern_dcache_area+0x24/0x3c LR is at __sync_icache_dcache+0x6c/0x98 [...] (b15_flush_kern_dcache_area) from (__sync_icache_dcache+0x6c/0x98) (__sync_icache_dcache) from (set_pte_at+0x28/0x54) (set_pte_at) from (remap_pfn_range+0x1a0/0x274) (remap_pfn_range) from (uio_mmap+0x184/0x1b8 [uio]) (uio_mmap [uio]) from (__mmap_region+0x264/0x5f4) (__mmap_region) from (__do_mmap_mm+0x3ec/0x440) (__do_mmap_mm) from (do_mmap+0x50/0x58) (do_mmap) from (vm_mmap_pgoff+0xfc/0x188) (vm_mmap_pgoff) from (ksys_mmap_pgoff+0xac/0xc4) (ksys_mmap_pgoff) from (ret_fast_syscall+0x0/0x5c) Code e0801001 e2423001 e1c00003 f57ff04f (ee070f3e) ---[ end trace 09cf0734c3805d52 ]--- Kernel panic - not syncing Fatal exceptionSo check if PG_reserved was set to solve this issue.[1] https//lore.kernel.org/lkml/Zbtdue57RO0QScJM@linux.ibm.com/",
  "keyphrases": {
    "rootcause": [
      "The Linux kernel's pfn_valid() function was modified to check for the presence of a memory map for a Page Frame Number (PFN)",
      "but it did not account for addresses that are reserved but not mapped by the kernel. This caused a crash when a user-space application tried to map a reserved",
      "but not mapped",
      "area using uio."
    ],
    "weakness": [
      "The `pfn_valid` check did not differentiate between reserved but unmapped addresses",
      "leading to incorrect behavior when used with uio."
    ],
    "impact": [
      "Kernel crash due to an attempt to flush the cache for a memory region that is reserved but not mapped. This can lead to denial of service.",
      "Kernel panic"
    ],
    "vector": "User-space application uses uio to map a reserved memory area that was not previously mapped by the kernel.",
    "attacker": "A malicious user-space application could exploit the vulnerability.",
    "product": "Linux Kernel",
    "version": "5.10.0",
    "component": [
      "Memory Management",
      "ARM Architecture",
      "uio driver"
    ]
  },
  "mitreTechnicalImpacts": []
}