{
    "cveId": "CVE-2024-26631",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedipv6 mcast fix data-race in ipv6_mc_down / mld_ifc_workidev->mc_ifc_count can be written over without proper locking.Originally found by syzbot [1], fix this issue by encapsulating callsto mld_ifc_stop_work() (and mld_gq_stop_work() for good measure) withmutex_lock() and mutex_unlock() accordingly as these functionsshould only be called with mc_lock per their declarations.[1]BUG KCSAN data-race in ipv6_mc_down / mld_ifc_workwrite to 0xffff88813a80c832 of 1 bytes by task 3771 on cpu 0 mld_ifc_stop_work net/ipv6/mcast.c1080 [inline] ipv6_mc_down+0x10a/0x280 net/ipv6/mcast.c2725 addrconf_ifdown+0xe32/0xf10 net/ipv6/addrconf.c3949 addrconf_notify+0x310/0x980 notifier_call_chain kernel/notifier.c93 [inline] raw_notifier_call_chain+0x6b/0x1c0 kernel/notifier.c461 __dev_notify_flags+0x205/0x3d0 dev_change_flags+0xab/0xd0 net/core/dev.c8685 do_setlink+0x9f6/0x2430 net/core/rtnetlink.c2916 rtnl_group_changelink net/core/rtnetlink.c3458 [inline] __rtnl_newlink net/core/rtnetlink.c3717 [inline] rtnl_newlink+0xbb3/0x1670 net/core/rtnetlink.c3754 rtnetlink_rcv_msg+0x807/0x8c0 net/core/rtnetlink.c6558 netlink_rcv_skb+0x126/0x220 net/netlink/af_netlink.c2545 rtnetlink_rcv+0x1c/0x20 net/core/rtnetlink.c6576 netlink_unicast_kernel net/netlink/af_netlink.c1342 [inline] netlink_unicast+0x589/0x650 net/netlink/af_netlink.c1368 netlink_sendmsg+0x66e/0x770 net/netlink/af_netlink.c1910 ...write to 0xffff88813a80c832 of 1 bytes by task 22 on cpu 1 mld_ifc_work+0x54c/0x7b0 net/ipv6/mcast.c2653 process_one_work kernel/workqueue.c2627 [inline] process_scheduled_works+0x5b8/0xa30 kernel/workqueue.c2700 worker_thread+0x525/0x730 kernel/workqueue.c2781 ...",
    "keyphrases": {
        "rootcause": "Data race in ipv6_mc_down/mld_ifc_work due to missing locking when calling mld_ifc_stop_work and mld_gq_stop_work.",
        "weakness": "The code modifies shared data without proper synchronization mechanisms.",
        "impact": "Race condition leading to memory corruption.",
        "vector": "Network interface configuration changes, specifically disabling an interface.",
        "attacker": "Local user or network attacker able to trigger interface changes.",
        "product": "Linux Kernel",
        "version": "Likely present in multiple versions of the Linux Kernel before the fix was applied",
        "component": "IPv6 multicast implementation"
    }
}
