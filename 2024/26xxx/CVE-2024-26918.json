{
    "cveId": "CVE-2024-26918",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved PCI Fix active state requirement in PME polling The commit noted in fixes added a bogus requirement that runtime PM managed devices need to be in the RPM_ACTIVE state for PME polling. In fact, only devices in low power states should be polled. However theres still a requirement that the device config space must be accessible, which has implications for both the current state of the polled device and the parent bridge, when present. Its not sufficient to assume the bridge remains in D0 and cases have been observed where the bridge passes the D0 test, but the PM state indicates RPM_SUSPENDING and config space of the polled device becomes inaccessible during pci_pme_wakeup(). Therefore, since the bridge is already effectively required to be in the RPM_ACTIVE state, formalize this in the code and elevate the PM usage count to maintain the state while polling the subordinate device. This resolves a regression reported in the bugzilla below where a Thunderbolt/USB4 hierarchy fails to scan for an attached NVMe endpoint downstream of a bridge in a D3hot power state.",
    "keyphrases": {
        "rootcause": "bogus requirement that runtime PM managed devices need to be in the RPM_ACTIVE state for PME polling",
        "weakness": "",
        "impact": "inaccessible config space",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "PCI PME polling"
    }
}
