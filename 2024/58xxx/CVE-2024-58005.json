{
    "cveId": "CVE-2024-58005",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved tpm Change to kvalloc() in eventlog/acpi.c The following failure was reported on HPE ProLiant D320 [ 10.693310][ T1] tpm_tis STM092500 2.0 TPM (device-id 0x3, rev-id 0) [ 10.848132][ T1] ------------[ cut here ]------------ [ 10.853559][ T1] WARNING CPU 59 PID 1 at mm/page_alloc.c4727 __alloc_pages_noprof+0x2ca/0x330 [ 10.862827][ T1] Modules linked in [ 10.866671][ T1] CPU 59 UID 0 PID 1 Comm swapper/0 Not tainted 6.12.0-lp155.2.g52785e2-default #1 openSUSE Tumbleweed (unreleased) 588cd98293a7c9eba9013378d807364c088c9375 [ 10.882741][ T1] Hardware name HPE ProLiant DL320 Gen12/ProLiant DL320 Gen12, BIOS 1.20 10/28/2024 [ 10.892170][ T1] RIP 0010__alloc_pages_noprof+0x2ca/0x330 [ 10.898103][ T1] Code 24 08 e9 4a fe ff ff e8 34 36 fa ff e9 88 fe ff ff 83 fe 0a 0f 86 b3 fd ff ff 80 3d 01 e7 ce 01 00 75 09 c6 05 f8 e6 ce 01 01 0b 45 31 ff e9 e5 fe ff ff f7 c2 00 00 08 00 75 42 89 d9 80 e1 [ 10.917750][ T1] RSP 0000ffffb7cf40077980 EFLAGS 00010246 [ 10.923777][ T1] RAX 0000000000000000 RBX 0000000000040cc0 RCX 0000000000000000 [ 10.931727][ T1] RDX 0000000000000000 RSI 000000000000000c RDI 0000000000040cc0 The above transcript shows that ACPI pointed a 16 MiB buffer for the log events because RSI maps to the order parameter of __alloc_pages_noprof(). Address the bug by moving from devm_kmalloc() to devm_add_action() and kvmalloc() and devm_add_action().",
    "keyphrases": {
        "rootcause": "improper memory allocation",
        "weakness": "memory leak",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.12.0-lp155.2.g52785e2-default",
        "component": "tpm"
    }
}
