{
    "cveId": "CVE-2024-58013",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved Bluetooth MGMT Fix slab-use-after-free Read in mgmt_remove_adv_monitor_sync This fixes the following crash ================================================================== BUG KASAN slab-use-after-free in mgmt_remove_adv_monitor_sync+0x3a/0xd0 net/bluetooth/mgmt.c5543 Read of size 8 at addr ffff88814128f898 by task kworker/u94/5961 CPU 1 UID 0 PID 5961 Comm kworker/u94 Not tainted 6.12.0-syzkaller-10684-gf1cd565ce577 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Workqueue hci0 hci_cmd_sync_work Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c120 print_address_description mm/kasan/report.c378 [inline] print_report+0x169/0x550 mm/kasan/report.c489 kasan_report+0x143/0x180 mm/kasan/report.c602 mgmt_remove_adv_monitor_sync+0x3a/0xd0 net/bluetooth/mgmt.c5543 hci_cmd_sync_work+0x22b/0x400 net/bluetooth/hci_sync.c332 process_one_work kernel/workqueue.c3229 [inline] process_scheduled_works+0xa63/0x1850 kernel/workqueue.c3310 worker_thread+0x870/0xd30 kernel/workqueue.c3391 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244 Allocated by task 16026 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3f/0x80 mm/kasan/common.c68 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __kmalloc_cache_noprof+0x243/0x390 mm/slub.c4314 kmalloc_noprof include/linux/slab.h901 [inline] kzalloc_noprof include/linux/slab.h1037 [inline] mgmt_pending_new+0x65/0x250 net/bluetooth/mgmt_util.c269 mgmt_pending_add+0x36/0x120 net/bluetooth/mgmt_util.c296 remove_adv_monitor+0x102/0x1b0 net/bluetooth/mgmt.c5568 hci_mgmt_cmd+0xc47/0x11d0 net/bluetooth/hci_sock.c1712 hci_sock_sendmsg+0x7b8/0x11c0 net/bluetooth/hci_sock.c1832 sock_sendmsg_nosec net/socket.c711 [inline] __sock_sendmsg+0x221/0x270 net/socket.c726 sock_write_iter+0x2d7/0x3f0 net/socket.c1147 new_sync_write fs/read_write.c586 [inline] vfs_write+0xaeb/0xd30 fs/read_write.c679 ksys_write+0x18f/0x2b0 fs/read_write.c731 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f Freed by task 16022 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3f/0x80 mm/kasan/common.c68 kasan_save_free_info+0x40/0x50 mm/kasan/generic.c582 poison_slab_object mm/kasan/common.c247 [inline] __kasan_slab_free+0x59/0x70 mm/kasan/common.c264 kasan_slab_free include/linux/kasan.h233 [inline] slab_free_hook mm/slub.c2338 [inline] slab_free mm/slub.c4598 [inline] kfree+0x196/0x420 mm/slub.c4746 mgmt_pending_foreach+0xd1/0x130 net/bluetooth/mgmt_util.c259 __mgmt_power_off+0x183/0x430 net/bluetooth/mgmt.c9550 hci_dev_close_sync+0x6c4/0x11c0 net/bluetooth/hci_sync.c5208 hci_dev_do_close net/bluetooth/hci_core.c483 [inline] hci_dev_close+0x112/0x210 net/bluetooth/hci_core.c508 sock_do_ioctl+0x158/0x460 net/socket.c1209 sock_ioctl+0x626/0x8e0 net/socket.c1328 vfs_ioctl fs/ioctl.c51 [inline] __do_sys_ioctl fs/ioctl.c906 [inline] __se_sys_ioctl+0xf5/0x170 fs/ioctl.c892 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f",
    "keyphrases": {
        "rootcause": "slab-use-after-free",
        "weakness": "use-after-free",
        "impact": "crash",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.12.0-syzkaller-10684-gf1cd565ce577",
        "component": "Bluetooth MGMT"
    }
}
