{
    "cveId": "CVE-2024-36979",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net bridge mst fix vlan use-after-free syzbot reported a suspicious rcu usage[1] in bridges mst code. While fixing it I noticed that nothing prevents a vlan to be freed while walking the list from the same path (br forward delay timer). Fix the rcu usage and also make sure we are not accessing freed memory by making br_mst_vlan_set_state use rcu read lock. [1] WARNING suspicious RCU usage 6.9.0-rc6-syzkaller #0 Not tainted ----------------------------- net/bridge/br_private.h1599 suspicious rcu_dereference_protected() usage! ... stack backtrace CPU 1 PID 8017 Comm syz-executor.1 Not tainted 6.9.0-rc6-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c114 lockdep_rcu_suspicious+0x221/0x340 kernel/locking/lockdep.c6712 nbp_vlan_group net/bridge/br_private.h1599 [inline] br_mst_set_state+0x1ea/0x650 net/bridge/br_mst.c105 br_set_state+0x28a/0x7b0 net/bridge/br_stp.c47 br_forward_delay_timer_expired+0x176/0x440 net/bridge/br_stp_timer.c88 call_timer_fn+0x18e/0x650 kernel/time/timer.c1793 expire_timers kernel/time/timer.c1844 [inline] __run_timers kernel/time/timer.c2418 [inline] __run_timer_base+0x66a/0x8e0 kernel/time/timer.c2429 run_timer_base kernel/time/timer.c2438 [inline] run_timer_softirq+0xb7/",
    "keyphrases": {
        "rootcause": "suspicious rcu usage",
        "weakness": "use-after-free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.9.0-rc6-syzkaller",
        "component": "net bridge mst fix vlan"
    }
}
