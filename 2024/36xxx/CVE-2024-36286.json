{
    "cveId": "CVE-2024-36286",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednetfilter nfnetlink_queue acquire rcu_read_lock() in instance_destroy_rcu()syzbot reported that nf_reinject() could be called without rcu_read_lock() WARNING suspicious RCU usage6.9.0-rc7-syzkaller-02060-g5c1672705a1a #0 Not taintednet/netfilter/nfnetlink_queue.c263 suspicious rcu_dereference_check() usage!other info that might help us debug thisrcu_scheduler_active = 2, debug_locks = 12 locks held by syz-executor.4/13427 #0 ffffffff8e334f60 (rcu_callback){....}-{00}, at rcu_lock_acquire include/linux/rcupdate.h329 [inline] #0 ffffffff8e334f60 (rcu_callback){....}-{00}, at rcu_do_batch kernel/rcu/tree.c2190 [inline] #0 ffffffff8e334f60 (rcu_callback){....}-{00}, at rcu_core+0xa86/0x1830 kernel/rcu/tree.c2471 #1 ffff88801ca92958 (&inst->lock){+.-.}-{22}, at spin_lock_bh include/linux/spinlock.h356 [inline] #1 ffff88801ca92958 (&inst->lock){+.-.}-{22}, at nfqnl_flush net/netfilter/nfnetlink_queue.c405 [inline] #1 ffff88801ca92958 (&inst->lock){+.-.}-{22}, at instance_destroy_rcu+0x30/0x220 net/netfilter/nfnetlink_queue.c172stack backtraceCPU 0 PID 13427 Comm syz-executor.4 Not tainted 6.9.0-rc7-syzkaller-02060-g5c1672705a1a #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 04/02/2024Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c114 lockdep_rcu_suspicious+0x221/0x340 kernel/locking/lockdep.c6712 nf_reinject net/netfilter/nfnetlink_queue.c323 [inline] nfqnl_reinject+0x6ec/0x1120 net/netfilter/nfnetlink_queue.c397 nfqnl_flush net/netfilter/nfnetlink_queue.c410 [inline] instance_destroy_rcu+0x1ae/0x220 net/netfilter/nfnetlink_queue.c172 rcu_do_batch kernel/rcu/tree.c2196 [inline] rcu_core+0xafd/0x1830 kernel/rcu/tree.c2471 handle_softirqs+0x2d6/0x990 kernel/softirq.c554 __do_softirq kernel/softirq.c588 [inline] invoke_softirq kernel/softirq.c428 [inline] __irq_exit_rcu+0xf4/0x1c0 kernel/softirq.c637 irq_exit_rcu+0x9/0x30 kernel/softirq.c649 instr_sysvec_apic_timer_interrupt arch/x86/kernel/apic/apic.c1043 [inline] sysvec_apic_timer_interrupt+0xa6/0xc0 arch/x86/kernel/apic/apic.c1043",
    "keyphrases": {
        "rootcause": "nf_reinject() could be called without rcu_read_lock()",
        "weakness": "Missing rcu_read_lock() in nf_reinject()",
        "impact": "RCU lock violation leading to a kernel panic",
        "vector": "Network packet injection via netfilter",
        "attacker": "A local attacker capable of injecting network packets.",
        "product": "Linux Kernel",
        "version": "6.9.0-rc7",
        "component": "netfilter nfnetlink_queue"
    }
}
