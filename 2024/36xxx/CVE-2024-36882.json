{
    "cveId": "CVE-2024-36882",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedmm use memalloc_nofs_save() in page_cache_ra_order()See commit f2c817bed58d (mm use memalloc_nofs_save in readahead path),ensure that page_cache_ra_order() do not attempt to reclaim file-backedpages too, or it leads to a deadlock, found issue when test ext4 largefolio. INFO task DataXceiver for7494 blocked for more than 120 seconds. echo 0 > /proc/sys/kernel/hung_task_timeout_secs disables this message. taskDataXceiver for stateD stack0 pid7494 ppid1 flags0x00000200 Call trace __switch_to+0x14c/0x240 __schedule+0x82c/0xdd0 schedule+0x58/0xf0 io_schedule+0x24/0xa0 __folio_lock+0x130/0x300 migrate_pages_batch+0x378/0x918 migrate_pages+0x350/0x700 compact_zone+0x63c/0xb38 compact_zone_order+0xc0/0x118 try_to_compact_pages+0xb0/0x280 __alloc_pages_direct_compact+0x98/0x248 __alloc_pages+0x510/0x1110 alloc_pages+0x9c/0x130 folio_alloc+0x20/0x78 filemap_alloc_folio+0x8c/0x1b0 page_cache_ra_order+0x174/0x308 ondemand_readahead+0x1c8/0x2b8 page_cache_async_ra+0x68/0xb8 filemap_readahead.isra.0+0x64/0xa8 filemap_get_pages+0x3fc/0x5b0 filemap_splice_read+0xf4/0x280 ext4_file_splice_read+0x2c/0x48 [ext4] vfs_splice_read.part.0+0xa8/0x118 splice_direct_to_actor+0xbc/0x288 do_splice_direct+0x9c/0x108 do_sendfile+0x328/0x468 __arm64_sys_sendfile64+0x8c/0x148 invoke_syscall+0x4c/0x118 el0_svc_common.constprop.0+0xc8/0xf0 do_el0_svc+0x24/0x38 el0_svc+0x4c/0x1f8 el0t_64_sync_handler+0xc0/0xc8 el0t_64_sync+0x188/0x190",
    "keyphrases": {
        "rootcause": "The page_cache_ra_order() function in the Linux kernel was attempting to reclaim file-backed pages while holding a lock, leading to a deadlock.",
        "weakness": "Improper handling of file-backed pages during readahead operations while holding locks.",
        "impact": "System deadlock, causing the system to become unresponsive.",
        "vector": "Exploited through a file read operation using sendfile syscall which triggers readahead",
        "attacker": "A local attacker who can trigger a file read operation.",
        "product": "Linux Kernel",
        "version": "Vulnerable versions are prior to commit f2c817bed58d",
        "component": "Memory Management (mm) and ext4 file system"
    }
}
