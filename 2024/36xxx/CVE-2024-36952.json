{
    "cveId": "CVE-2024-36952",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved scsi lpfc Move NPIVs transport unregistration to after resource clean up There are cases after NPIV deletion where the fabric switch still believes the NPIV is logged into the fabric. This occurs when a vport is unregistered before the Remove All DA_ID CT and LOGO ELS are sent to the fabric. Currently fc_remove_host(), which calls dev_loss_tmo for all D_IDs including the fabric D_ID, removes the last ndlp reference and frees the ndlp rport object. This sometimes causes the race condition where the final DA_ID and LOGO are skipped from being sent to the fabric switch. Fix by moving the fc_remove_host() and scsi_remove_host() calls after DA_ID and LOGO are sent.",
    "keyphrases": {
        "rootcause": "race condition",
        "weakness": "",
        "impact": "skip DA_ID and LOGO from being sent to fabric switch",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "scsi lpfc NPIVs transport unregistration"
    }
}
