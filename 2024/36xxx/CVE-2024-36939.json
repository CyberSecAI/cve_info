{
    "cveId": "CVE-2024-36939",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved nfs Handle error of rpc_proc_register() in nfs_net_init(). syzkaller reported a warning [0] triggered while destroying immature netns. rpc_proc_register() was called in init_nfs_fs(), but its error has been ignored since at least the initial commit 1da177e4c3f4 (Linux-2.6.12-rc2). Recently, commit d47151b79e32 (nfs expose /proc/net/sunrpc/nfs in net namespaces) converted the procfs to per-netns and made the problem more visible. Even when rpc_proc_register() fails, nfs_net_init() could succeed, and thus nfs_net_exit() will be called while destroying the netns. Then, remove_proc_entry() will be called for non-existing proc directory and trigger the warning below. Lets handle the error of rpc_proc_register() properly in nfs_net_init(). [0] name nfs WARNING CPU 1 PID 1710 at fs/proc/generic.c711 remove_proc_entry+0x1bb/0x2d0 fs/proc/generic.c711 Modules linked in CPU 1 PID 1710 Comm syz-executor.2 Not tainted 6.8.0-12822-gcd51db110a7e #12 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014 RIP 0010remove_proc_entry+0x1bb/0x2d0 fs/proc/generic.c711 Code 41 5d 41 5e c3 e8 85 09 b5 ff 48 c7 c7 88 58 64 86 e8 09 0e 71 02 e8 74 09 b5 ff 4c 89 e6 48 c7 c7 de 1b 80 84 e8 c5 ad 97 ff 0b eb b1 e8 5c 09 b5 ff 48 c7 c7 88 58 64 86 e8 e0 0d 71 02 eb RSP 0018ffffc9000c6d7ce0 EFLAGS 00010286 RAX 0000000000000000 RBX ffff88"
}
