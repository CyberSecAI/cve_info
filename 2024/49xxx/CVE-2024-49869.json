{
    "cveId": "CVE-2024-49869",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved btrfs send fix buffer overflow detection when copying path to cache entry Starting with commit c0247d289e73 (btrfs send annotate struct name_cache_entry with __counted_by()) we annotated the variable length array name from the name_cache_entry structure with __counted_by() to improve overflow detection. However that alone was not correct, because the length of that array does not match the name_len field - it matches that plus 1 to include the NUL string terminator, so that makes a fortified kernel think theres an overflow and report a splat like this strcpy detected buffer overflow 20 byte write of buffer size 19 WARNING CPU 3 PID 3310 at __fortify_report+0x45/0x50 CPU 3 UID 0 PID 3310 Comm btrfs Not tainted 6.11.0-prnet #1 Hardware name CompuLab Ltd. sbc-ihsw/Intense-PC2 (IPC2), BIOS IPC2_3.330.7 X64 03/15/2018 RIP 0010__fortify_report+0x45/0x50 Code 48 8b 34 (...) RSP 0018ffff97ebc0d6f650 EFLAGS 00010246 RAX 7749924ef60fa600 RBX ffff8bf5446a521a RCX 0000000000000027 RDX 00000000ffffdfff RSI ffff97ebc0d6f548 RDI ffff8bf84e7a1cc8 RBP ffff8bf548574080 R08 ffffffffa8c40e10 R09 0000000000005ffd R10 0000000000000004 R11 ffffffffa8c70e10 R12 ffff8bf551eef400 R13 0000000000000000 R14 0000000000000013 R15 00000000000003a8 FS 00007fae144de8c0(0000) GSffff8bf84e780000(0000) knlGS0000000000000000 CS 0010 DS 0000 ES 0000 CR0 00000000800"
}
