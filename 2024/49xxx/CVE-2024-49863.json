{
    "cveId": "CVE-2024-49863",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved vhost/scsi null-ptr-dereference in vhost_scsi_get_req() Since commit 3f8ca2e115e5 (vhost/scsi Extract common handling code from control queue handler) a null pointer dereference bug can be triggered when guest sends an SCSI AN request. In vhost_scsi_ctl_handle_vq(), `vc.target` is assigned with `&v_req.tmf.lun[1]` within a switch-case block and is then passed to vhost_scsi_get_req() which extracts `vc->req` and `tpg`. However, for a `VIRTIO_SCSI_T_AN_*` request, tpg is not required, so `vc.target` is set to NULL in this branch. Later, in vhost_scsi_get_req(), `vc->target` is dereferenced without being checked, leading to a null pointer dereference bug. This bug can be triggered from guest. When this bug occurs, the vhost_worker process is killed while holding `vq->mutex` and the corresponding tpg will remain occupied indefinitely. Below is the KASAN report Oops general protection fault, probably for non-canonical address 0xdffffc0000000000 0000 [#1] PREEMPT SMP KASAN NOPTI KASAN null-ptr-deref in range [0x0000000000000000-0x0000000000000007] CPU 1 PID 840 Comm poc Not tainted 6.10.0+ #1 Hardware name QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014 RIP 0010vhost_scsi_get_req+0x165/0x3a0 Code 00 fc ff df 48 89 fa 48 c1 ea 03 80 3c 02 00 0f 85 2b 02 00 00 48 b8 00 00 00 00 00 fc ff df 4d 8b 65 30 4c 89 e2 48 c1 ea 03 b6 04 02 4c 89 e2 83 e2 07 38 d0 7f",
    "keyphrases": {
        "rootcause": "null pointer dereference",
        "weakness": "",
        "impact": "denial of service",
        "vector": "SCSI AN request",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "vhost/scsi"
    }
}
