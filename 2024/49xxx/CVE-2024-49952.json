{
    "cveId": "CVE-2024-49952",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved netfilter nf_tables prevent nf_skb_duplicated corruption syzbot found that nf_dup_ipv4() or nf_dup_ipv6() could write per-cpu variable nf_skb_duplicated in an unsafe way [1]. Disabling preemption as hinted by the splat is not enough, we have to disable soft interrupts as well. [1] BUG using __this_cpu_write() in preemptible [00000000] code syz.4.282/6316 caller is nf_dup_ipv4+0x651/0x8f0 net/ipv4/netfilter/nf_dup_ipv4.c87 CPU 0 UID 0 PID 6316 Comm syz.4.282 Not tainted 6.11.0-rc7-syzkaller-00104-g7052622fccb1 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 08/06/2024 Call Trace __dump_stack lib/dump_stack.c93 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c119 check_preemption_disabled+0x10e/0x120 lib/smp_processor_id.c49 nf_dup_ipv4+0x651/0x8f0 net/ipv4/netfilter/nf_dup_ipv4.c87 nft_dup_ipv4_eval+0x1db/0x300 net/ipv4/netfilter/nft_dup_ipv4.c30 expr_call_ops_eval net/netfilter/nf_tables_core.c240 [inline] nft_do_chain+0x4ad/0x1da0 net/netfilter/nf_tables_core.c288 nft_do_chain_ipv4+0x202/0x320 net/netfilter/nft_chain_filter.c23 nf_hook_entry_hookfn include/linux/netfilter.h154 [inline] nf_hook_slow+0xc3/0x220 net/netfilter/core.c626 nf_hook+0x2c4/0x450 include/linux/netfilter.h269 NF_HOOK_COND include/linux/netfilter.h302 [inline] ip_output+0x185/0x230 net/ipv4/ip_output.c433 ip_local_out net/ipv4/ip_output.c"
}
