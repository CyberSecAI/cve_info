{
  "cveId": "CVE-2024-49932",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved btrfs dont readahead the relocation inode on RST On relocation were doing readahead on the relocation inode, but if the filesystem is backed by a RAID stripe tree we can get ENOENT (e.g. due to preallocated extents not being mapped in the RST) from the lookup. But readahead doesnt handle the error and submits invalid reads to the device, causing an assertion in the scatter-gather list code BTRFS info (device nvme1n1) balance start -d -m -s BTRFS info (device nvme1n1) relocating block group 6480920576 flags data|raid0 BTRFS error (device nvme1n1) cannot find raid-stripe for logical [6481928192, 6481969152] devid 2, profile raid0 ------------[ cut here ]------------ kernel BUG at include/linux/scatterlist.h115! Oops invalid opcode 0000 [#1] PREEMPT SMP PTI CPU 0 PID 1012 Comm btrfs Not tainted 6.10.0-rc7+ #567 RIP 0010__blk_rq_map_sg+0x339/0x4a0 RSP 0018ffffc90001a43820 EFLAGS 00010202 RAX 0000000000000000 RBX 0000000000000000 RCX ffffea00045d4802 RDX 0000000117520000 RSI 0000000000000000 RDI ffff8881027d1000 RBP 0000000000003000 R08 ffffea00045d4902 R09 0000000000000000 R10 0000000000000000 R11 0000000000001000 R12 ffff8881003d10b8 R13 ffffc90001a438f0 R14 0000000000000000 R15 0000000000003000 FS 00007fcc048a6900(0000) GSffff88813bc00000(0000) knlGS0000000000000000 CS 0010 DS 0000 ES 0000 CR0 0000000080050033 CR2 000000002cd1100",
  "keyphrases": {
    "rootcause": "readahead doesn't handle the error",
    "weakness": "",
    "impact": [
      "Oops",
      "assertion in the scatter-gather list code",
      "kernel BUG"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "btrfs"
  },
  "mitreTechnicalImpacts": []
}