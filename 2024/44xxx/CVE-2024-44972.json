{
    "cveId": "CVE-2024-44972",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved btrfs do not clear page dirty inside extent_write_locked_range() [BUG] For subpage + zoned case, the following workload can lead to rsv data leak at unmount time # mkfs.btrfs -f -s 4k $dev # mount $dev $mnt # fsstress -w -n 8 -d $mnt -s 1709539240 0/0 fiemap - no filename 0/1 copyrange read - no filename 0/2 write - no filename 0/3 rename - no source filename 0/4 creat f0 x0 0 0 0/4 creat add id=0,parent=-1 0/5 writev f0[259 1 0 0 0 0] [778052,113,965] 0 0/6 ioctl(FIEMAP) f0[259 1 0 0 224 887097] [1294220,2291618343991484791,0x10000] -1 0/7 dwrite - xfsctl(XFS_IOC_DIOINFO) f0[259 1 0 0 224 887097] return 25, fallback to stat() 0/7 dwrite f0[259 1 0 0 224 887097] [696320,102400] 0 # umount $mnt The dmesg includes the following rsv leak detection warning (all call trace skipped) ------------[ cut here ]------------ WARNING CPU 2 PID 4528 at fs/btrfs/inode.c8653 btrfs_destroy_inode+0x1e0/0x200 [btrfs] ---[ end trace 0000000000000000 ]--- ------------[ cut here ]------------ WARNING CPU 2 PID 4528 at fs/btrfs/inode.c8654 btrfs_destroy_inode+0x1a8/0x200 [btrfs] ---[ end trace 0000000000000000 ]--- ------------[ cut here ]------------ WARNING CPU 2 PID 4528 at fs/btrfs/inode.c8660 btrfs_destroy_inode+0x1a0/0x200 [btrfs] ---[ end trace 0000000000000000 ]--- BTRFS info (device sda) last unmount of filesystem 1b4abba9-de34-4f07-9e7f-157cf1"
}
