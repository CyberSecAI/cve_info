{
    "cveId": "CVE-2024-44999",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedgtp pull network headers in gtp_dev_xmit()syzbot/KMSAN reported use of uninit-value in get_dev_xmit() [1]We must make sure the IPv4 or Ipv6 header is pulled in skb->headbefore accessing fields in them.Use pskb_inet_may_pull() to fix this issue.[1]BUG KMSAN uninit-value in ipv6_pdp_find drivers/net/gtp.c220 [inline] BUG KMSAN uninit-value in gtp_build_skb_ip6 drivers/net/gtp.c1229 [inline] BUG KMSAN uninit-value in gtp_dev_xmit+0x1424/0x2540 drivers/net/gtp.c1281 ipv6_pdp_find drivers/net/gtp.c220 [inline] gtp_build_skb_ip6 drivers/net/gtp.c1229 [inline] gtp_dev_xmit+0x1424/0x2540 drivers/net/gtp.c1281 __netdev_start_xmit include/linux/netdevice.h4913 [inline] netdev_start_xmit include/linux/netdevice.h4922 [inline] xmit_one net/core/dev.c3580 [inline] dev_hard_start_xmit+0x247/0xa20 net/core/dev.c3596 __dev_queue_xmit+0x358c/0x5610 net/core/dev.c4423 dev_queue_xmit include/linux/netdevice.h3105 [inline] packet_xmit+0x9c/0x6c0 net/packet/af_packet.c276 packet_snd net/packet/af_packet.c3145 [inline] packet_sendmsg+0x90e3/0xa3a0 net/packet/af_packet.c3177 sock_sendmsg_nosec net/socket.c730 [inline] __sock_sendmsg+0x30f/0x380 net/socket.c745 __sys_sendto+0x685/0x830 net/socket.c2204 __do_sys_sendto net/socket.c2216 [inline] __se_sys_sendto net/socket.c2212 [inline] __x64_sys_sendto+0x125/0x1d0 net/socket.c2212 x64_sys_call+0x3799/0x3c10 arch/x86/include/generated/asm/syscalls_64.h45 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7fUninit was created at slab_post_alloc_hook mm/slub.c3994 [inline] slab_alloc_node mm/slub.c4037 [inline] kmem_cache_alloc_node_noprof+0x6bf/0xb80 mm/slub.c4080 kmalloc_reserve+0x13d/0x4a0 net/core/skbuff.c583 __alloc_skb+0x363/0x7b0 net/core/skbuff.c674 alloc_skb include/linux/skbuff.h1320 [inline] alloc_skb_with_frags+0xc8/0xbf0 net/core/skbuff.c6526 sock_alloc_send_pskb+0xa81/0xbf0 net/core/sock.c2815 packet_alloc_skb net/packet/af_packet.c2994 [inline] packet_snd net/packet/af_packet.c3088 [inline] packet_sendmsg+0x749c/0xa3a0 net/packet/af_packet.c3177 sock_sendmsg_nosec net/socket.c730 [inline] __sock_sendmsg+0x30f/0x380 net/socket.c745 __sys_sendto+0x685/0x830 net/socket.c2204 __do_sys_sendto net/socket.c2216 [inline] __se_sys_sendto net/socket.c2212 [inline] __x64_sys_sendto+0x125/0x1d0 net/socket.c2212 x64_sys_call+0x3799/0x3c10 arch/x86/include/generated/asm/syscalls_64.h45 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7fCPU 0 UID 0 PID 7115 Comm syz.1.515 Not tainted 6.11.0-rc1-syzkaller-00043-g94ede2a3e913 #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 06/27/2024",
    "keyphrases": {
        "rootcause": "The IPv4 or IPv6 header was not being pulled into the skb->head before accessing fields in them.",
        "weakness": "Use of uninitialized value in network header processing.",
        "impact": "KMSAN reports use of uninitialized values leading to potential crashes or unexpected behavior.",
        "vector": "Network packet processing within the GTP module.",
        "attacker": "A malicious actor sending crafted packets.",
        "product": "Linux Kernel",
        "version": "6.11.0-rc1",
        "component": "drivers/net/gtp.c"
    }
}
