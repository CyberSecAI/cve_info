{
  "cveId": "CVE-2024-39467",
  "version": "1.0.0",
  "timestamp": "2024-12-19T08:32:02.878079+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolvedf2fs fix to do sanity check on i_xattr_nid in sanity_check_inode()syzbot reports a kernel bug as belowF2FS-fs (loop0) Mounted with checkpoint version = 48b305e4==================================================================BUG KASAN slab-out-of-bounds in f2fs_test_bit fs/f2fs/f2fs.h2933 [inline]BUG KASAN slab-out-of-bounds in current_nat_addr fs/f2fs/node.h213 [inline]BUG KASAN slab-out-of-bounds in f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c600Read of size 1 at addr ffff88807a58c76c by task syz-executor280/5076CPU 1 PID 5076 Comm syz-executor280 Not tainted 6.9.0-rc5-syzkaller #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c114 print_address_description mm/kasan/report.c377 [inline] print_report+0x169/0x550 mm/kasan/report.c488 kasan_report+0x143/0x180 mm/kasan/report.c601 f2fs_test_bit fs/f2fs/f2fs.h2933 [inline] current_nat_addr fs/f2fs/node.h213 [inline] f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c600 f2fs_xattr_fiemap fs/f2fs/data.c1848 [inline] f2fs_fiemap+0x55d/0x1ee0 fs/f2fs/data.c1925 ioctl_fiemap fs/ioctl.c220 [inline] do_vfs_ioctl+0x1c07/0x2e50 fs/ioctl.c838 __do_sys_ioctl fs/ioctl.c902 [inline] __se_sys_ioctl+0x81/0x170 fs/ioctl.c890 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf5/0x240 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7fThe root cause is we missed to do sanity check on i_xattr_nid duringf2fs_iget(), so that in fiemap() path, current_nat_addr() will accessnat_bitmap w/ offset from invalid i_xattr_nid, result in triggeringkasan bug report, fix it.",
  "keyphrases": {
    "rootcause": "missed sanity check on i_xattr_nid",
    "weakness": "slab-out-of-bounds",
    "impact": "kernel bug",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "f2fs"
  },
  "mitreTechnicalImpacts": []
}