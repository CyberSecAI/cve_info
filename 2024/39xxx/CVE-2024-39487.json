{
  "cveId": "CVE-2024-39487",
  "version": "1.0.0",
  "timestamp": "2024-12-19T22:22:49.126128+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolvedbonding Fix out-of-bounds read in bond_option_arp_ip_targets_set()In function bond_option_arp_ip_targets_set(), if newval->string is anempty string, newval->string+1 will point to the byte after thestring, causing an out-of-bound read.BUG KASAN slab-out-of-bounds in strlen+0x7d/0xa0 lib/string.c418Read of size 1 at addr ffff8881119c4781 by task syz-executor665/8107CPU 1 PID 8107 Comm syz-executor665 Not tainted 6.7.0-rc7 #1Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xd9/0x150 lib/dump_stack.c106 print_address_description mm/kasan/report.c364 [inline] print_report+0xc1/0x5e0 mm/kasan/report.c475 kasan_report+0xbe/0xf0 mm/kasan/report.c588 strlen+0x7d/0xa0 lib/string.c418 __fortify_strlen include/linux/fortify-string.h210 [inline] in4_pton+0xa3/0x3f0 net/core/utils.c130 bond_option_arp_ip_targets_set+0xc2/0x910drivers/net/bonding/bond_options.c1201 __bond_opt_set+0x2a4/0x1030 drivers/net/bonding/bond_options.c767 __bond_opt_set_notify+0x48/0x150 drivers/net/bonding/bond_options.c792 bond_opt_tryset_rtnl+0xda/0x160 drivers/net/bonding/bond_options.c817 bonding_sysfs_store_option+0xa1/0x120 drivers/net/bonding/bond_sysfs.c156 dev_attr_store+0x54/0x80 drivers/base/core.c2366 sysfs_kf_write+0x114/0x170 fs/sysfs/file.c136 kernfs_fop_write_iter+0x337/0x500 fs/kernfs/file.c334 call_write_iter include/linux/fs.h2020 [inline] new_sync_write fs/read_write.c491 [inline] vfs_write+0x96a/0xd80 fs/read_write.c584 ksys_write+0x122/0x250 fs/read_write.c637 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0x40/0x110 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x63/0x6b---[ end trace ]---Fix it by adding a check of string length before using it.",
  "keyphrases": {
    "rootcause": "Out-of-bounds read in bond_option_arp_ip_targets_set()",
    "weakness": [
      "If newval->string is an empty string",
      "causing an out-of-bound read.",
      "newval->string+1 will point to the byte after the string",
      "out-of-bounds read",
      "slab-out-of-bounds"
    ],
    "impact": "Kernel crash due to out-of-bounds read.",
    "vector": "An attacker could trigger the vulnerability by providing a specific configuration to the bonding driver via sysfs.",
    "attacker": "Local user with the capability to configure the bonding driver via sysfs.",
    "product": "Linux Kernel",
    "version": "6.7.0-rc7",
    "component": "Bonding driver"
  },
  "mitreTechnicalImpacts": []
}