{
    "cveId": "CVE-2024-39503",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved netfilter ipset Fix race between namespace cleanup and gc in the listset type Lion Ackermann reported that there is a race condition between namespace cleanup in ipset and the garbage collection of the listset type. The namespace cleanup can destroy the listset type of sets while the gc of the set type is waiting to run in rcu cleanup. The latter uses data from the destroyed set which thus leads use after free. The patch contains the following parts - When destroying all sets, first remove the garbage collectors, then wait if needed and then destroy the sets. - Fix the badly ordered wait then remove gc for the destroy a single set case. - Fix the missing rcu locking in the listset type in the userspace test case. - Use proper RCU list handlings in the listset type. The patch depends on c1193d9bbbd3 (netfilter ipset Add list flush to cancel_gc).",
    "keyphrases": {
        "rootcause": "race condition",
        "weakness": "use after free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "netfilter ipset"
    }
}
