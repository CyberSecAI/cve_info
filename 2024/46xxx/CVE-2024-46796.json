{
    "cveId": "CVE-2024-46796",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved smb client fix double put of @cfile in smb2_set_path_size() If smb2_compound_op() is called with a valid @cfile and returned -EINVAL, we need to call cifs_get_writable_path() before retrying it as the reference of @cfile was already dropped by previous call. This fixes the following KASAN splat when running fstests generic/013 against Windows Server 2022 CIFS Attempting to mount //w22-fs0/scratch run fstests generic/013 at 2024-09-02 194859 ================================================================== BUG KASAN slab-use-after-free in detach_if_pending+0xab/0x200 Write of size 8 at addr ffff88811f1a3730 by task kworker/32/176 CPU 3 UID 0 PID 176 Comm kworker/32 Not tainted 6.11.0-rc6 #2 Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-2.fc40 04/01/2014 Workqueue cifsoplockd cifs_oplock_break [cifs] Call Trace dump_stack_lvl+0x5d/0x80 ? detach_if_pending+0xab/0x200 print_report+0x156/0x4d9 ? detach_if_pending+0xab/0x200 ? __virt_addr_valid+0x145/0x300 ? __phys_addr+0x46/0x90 ? detach_if_pending+0xab/0x200 kasan_report+0xda/0x110 ? detach_if_pending+0xab/0x200 detach_if_pending+0xab/0x200 timer_delete+0x96/0xe0 ? __pfx_timer_delete+0x10/0x10 ? rcu_is_watching+0x20/0x50 try_to_grab_pending+0x46/0x3b0 __cancel_work+0x89/0x1b0 ? __pfx___cancel_work+0x10/0x10 ? kasan_save_track+0x14/0x30 cifs_",
    "keyphrases": {
        "rootcause": "double put of @cfile in smb2_set_path_size()",
        "weakness": "",
        "impact": "KASAN slab-use-after-free",
        "vector": "Attempting to mount //w22-fs0/scratch run fstests generic/013",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "smb client"
    }
}
