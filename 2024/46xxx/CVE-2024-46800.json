{
    "cveId": "CVE-2024-46800",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved sch/netem fix use after free in netem_dequeue If netem_dequeue() enqueues packet to inner qdisc and that qdisc returns __NET_XMIT_STOLEN. The packet is dropped but qdisc_tree_reduce_backlog() is not called to update the parents q.qlen, leading to the similar use-after-free as Commit e04991a48dbaf382 (netem fix return value if duplicate enqueue fails) Commands to trigger KASAN UaF ip link add type dummy ip link set lo up ip link set dummy0 up tc qdisc add dev lo parent root handle 1 drr tc filter add dev lo parent 1 basic classid 11 tc class add dev lo classid 11 drr tc qdisc add dev lo parent 11 handle 2 netem tc qdisc add dev lo parent 2 handle 3 drr tc filter add dev lo parent 3 basic classid 31 action mirred egress redirect dev dummy0 tc class add dev lo classid 31 drr ping -c1 -W0.01 localhost # Trigger bug tc class del dev lo classid 11 tc class add dev lo classid 11 drr ping -c1 -W0.01 localhost # UaF",
    "keyphrases": {
        "rootcause": "",
        "weakness": "use after free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "sch/netem"
    }
}
