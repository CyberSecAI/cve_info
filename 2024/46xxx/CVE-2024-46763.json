{
    "cveId": "CVE-2024-46763",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved fou Fix null-ptr-deref in GRO. We observed a null-ptr-deref in fou_gro_receive() while shutting down a host. [0] The NULL pointer is sk->sk_user_data, and the offset 8 is of protocol in struct fou. When fou_release() is called due to netns dismantle or explicit tunnel teardown, udp_tunnel_sock_release() sets NULL to sk->sk_user_data. Then, the tunnel socket is destroyed after a single RCU grace period. So, in-flight udp4_gro_receive() could find the socket and execute the FOU GRO handler, where sk->sk_user_data could be NULL. Lets use rcu_dereference_sk_user_data() in fou_from_sock() and add NULL checks in FOU GRO handlers. [0] BUG kernel NULL pointer dereference, address 0000000000000008 PF supervisor read access in kernel mode PF error_code(0x0000) - not-present page PGD 80000001032f4067 P4D 80000001032f4067 PUD 103240067 PMD 0 SMP PTI CPU 0 PID 0 Comm swapper/0 Not tainted 5.10.216-204.855.amzn2.x86_64 #1 Hardware name Amazon EC2 c5.large/, BIOS 1.0 10/16/2017 RIP 0010fou_gro_receive (net/ipv4/fou.c233) [fou] Code 41 5f c3 cc cc cc cc e8 e7 2e 69 f4 0f 1f 80 00 00 00 00 0f 1f 44 00 00 49 89 f8 41 54 48 89 f7 48 89 d6 49 8b 80 88 02 00 00 b6 48 08 0f b7 42 4a 66 25 fd fd 80 cc 02 66 89 42 4a 0f b6 42 RSP 0018ffffa330c0003d08 EFLAGS 00010297 RAX 0000000000000000 RBX ffff93d9e3a6b900 RCX 0000000000000010 RDX ffff93d9e3a6b900 RSI ffff93d9e3a6b900 RDI ffff93dac2e24d08 RBP",
    "keyphrases": {
        "rootcause": "NULL pointer in sk_user_data",
        "weakness": "null-ptr-deref",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "fou_gro_receive() in GRO"
    }
}
