{
    "cveId": "CVE-2024-38555",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednet/mlx5 Discard command completions in internal errorFix use after free when FW completion arrives while device is ininternal error state. Avoid calling completion handler in this case,since the device will flush the command interface and trigger allcompletions manually.Kernel log------------[ cut here ]------------refcount_t underflow use-after-free....RIP 0010refcount_warn_saturate+0xd8/0xe0...Call Trace? __warn+0x79/0x120? refcount_warn_saturate+0xd8/0xe0? report_bug+0x17c/0x190? handle_bug+0x3c/0x60? exc_invalid_op+0x14/0x70? asm_exc_invalid_op+0x16/0x20? refcount_warn_saturate+0xd8/0xe0cmd_ent_put+0x13b/0x160 [mlx5_core]mlx5_cmd_comp_handler+0x5f9/0x670 [mlx5_core]cmd_comp_notifier+0x1f/0x30 [mlx5_core]notifier_call_chain+0x35/0xb0atomic_notifier_call_chain+0x16/0x20mlx5_eq_async_int+0xf6/0x290 [mlx5_core]notifier_call_chain+0x35/0xb0atomic_notifier_call_chain+0x16/0x20irq_int_handler+0x19/0x30 [mlx5_core]__handle_irq_event_percpu+0x4b/0x160handle_irq_event+0x2e/0x80handle_edge_irq+0x98/0x230__common_interrupt+0x3b/0xa0common_interrupt+0x7b/0xa0asm_common_interrupt+0x22/0x40",
    "keyphrases": {
        "rootcause": "Use-after-free vulnerability due to incorrect handling of command completions when the device is in an internal error state.",
        "weakness": "The completion handler is called even when the device is in an internal error state, leading to a use-after-free vulnerability.",
        "impact": "Kernel crash due to a refcount underflow, potentially leading to system instability and denial of service.",
        "vector": "The vulnerability is triggered by a specific sequence of events: an internal device error occurs followed by a command completion, which results in the execution of the completion handler while the associated memory has already been freed.",
        "attacker": "This vulnerability can be triggered by a local attacker who is able to trigger internal error states, or possibly through a malicious device.",
        "product": "Linux Kernel",
        "version": "Unknown, affects versions before the fix",
        "component": "mlx5_core (Mellanox network driver)"
    }
}
