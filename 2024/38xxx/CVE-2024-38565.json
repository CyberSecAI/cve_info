{
    "cveId": "CVE-2024-38565",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedwifi ar5523 enable proper endpoint verificationSyzkaller reports [1] hitting a warning about an endpoint in usenot having an expected type to it.Fix the issue by checking for the existence of all properendpoints with their according types intact.Sadly, this patch has not been tested on real hardware.[1] Syzkaller report------------[ cut here ]------------usb 1-1 BOGUS urb xfer, pipe 3 != type 1WARNING CPU 0 PID 3643 at drivers/usb/core/urb.c504 usb_submit_urb+0xed6/0x1880 drivers/usb/core/urb.c504...Call Trace ar5523_cmd+0x41b/0x780 drivers/net/wireless/ath/ar5523/ar5523.c275 ar5523_cmd_read drivers/net/wireless/ath/ar5523/ar5523.c302 [inline] ar5523_host_available drivers/net/wireless/ath/ar5523/ar5523.c1376 [inline] ar5523_probe+0x14b0/0x1d10 drivers/net/wireless/ath/ar5523/ar5523.c1655 usb_probe_interface+0x30f/0x7f0 drivers/usb/core/driver.c396 call_driver_probe drivers/base/dd.c560 [inline] really_probe+0x249/0xb90 drivers/base/dd.c639 __driver_probe_device+0x1df/0x4d0 drivers/base/dd.c778 driver_probe_device+0x4c/0x1a0 drivers/base/dd.c808 __device_attach_driver+0x1d4/0x2e0 drivers/base/dd.c936 bus_for_each_drv+0x163/0x1e0 drivers/base/bus.c427 __device_attach+0x1e4/0x530 drivers/base/dd.c1008 bus_probe_device+0x1e8/0x2a0 drivers/base/bus.c487 device_add+0xbd9/0x1e90 drivers/base/core.c3517 usb_set_configuration+0x101d/0x1900 drivers/usb/core/message.c2170 usb_generic_driver_probe+0xbe/0x100 drivers/usb/core/generic.c238 usb_probe_device+0xd8/0x2c0 drivers/usb/core/driver.c293 call_driver_probe drivers/base/dd.c560 [inline] really_probe+0x249/0xb90 drivers/base/dd.c639 __driver_probe_device+0x1df/0x4d0 drivers/base/dd.c778 driver_probe_device+0x4c/0x1a0 drivers/base/dd.c808 __device_attach_driver+0x1d4/0x2e0 drivers/base/dd.c936 bus_for_each_drv+0x163/0x1e0 drivers/base/bus.c427 __device_attach+0x1e4/0x530 drivers/base/dd.c1008 bus_probe_device+0x1e8/0x2a0 drivers/base/bus.c487 device_add+0xbd9/0x1e90 drivers/base/core.c3517 usb_new_device.cold+0x685/0x10ad drivers/usb/core/hub.c2573 hub_port_connect drivers/usb/core/hub.c5353 [inline] hub_port_connect_change drivers/usb/core/hub.c5497 [inline] port_event drivers/usb/core/hub.c5653 [inline] hub_event+0x26cb/0x45d0 drivers/usb/core/hub.c5735 process_one_work+0x9bf/0x1710 kernel/workqueue.c2289 worker_thread+0x669/0x1090 kernel/workqueue.c2436 kthread+0x2e8/0x3a0 kernel/kthread.c376 ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S306",
    "keyphrases": {
        "rootcause": "The ar5523 driver does not properly verify the type of USB endpoints before using them.",
        "weakness": "The driver assumes that endpoints will have the expected type without proper verification.",
        "impact": "A malicious or buggy USB device can provide endpoints with unexpected types, potentially leading to driver errors or unexpected behavior.",
        "vector": "A malicious or buggy USB device can provide incorrect endpoint types.",
        "attacker": "Malicious or buggy USB device.",
        "product": "Linux Kernel",
        "version": "N/A",
        "component": "ar5523 driver"
    }
}
