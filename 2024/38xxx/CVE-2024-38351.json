{
    "cveId": "CVE-2024-38351",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "Pocketbase is an open source web backend written in go. In affected versions a malicious user may be able to compromise other user accounts. In order to be exploited users must have both OAuth2 and Password auth methods enabled. A possible attack scenario could be 1. a malicious actor register with the targeted users email (it is unverified), 2. at some later point in time the targeted user stumble on your app and decides to sign-up with OAuth2 (_this step could be also initiated by the attacker by sending an invite email to the targeted user_), 3. on successful OAuth2 auth we search for an existing PocketBase user matching with the OAuth2 users email and associate them, 4. because we havent changed the password of the existing PocketBase user during the linking, the malicious actor has access to the targeted user account and will be able to login with the initially created email/password. To prevent this for happening we now reset the password for this specific case if the previously created user wasnt verified (an exception to this is if the linking is explicit/manual, aka. when you send `AuthorizationTOKEN` with the OAuth2 auth call). Additionally to warn existing users we now send an email alert in case the user has logged in with password but has at least one OAuth2 account linked. The flow will be further improved with ongoing refactoring and we will start sending emails for unrecognized device logins (OTP and MFA is already implemented and will be available wit",
    "keyphrases": {
        "rootcause": [
            "lack of account verification",
            "unverified OAuth2 accounts"
        ],
        "weakness": "",
        "impact": "account takeover",
        "vector": "",
        "attacker": "malicious actor",
        "product": "Pocketbase",
        "version": "",
        "component": ""
    }
}
