{
    "cveId": "CVE-2024-38626",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved fuse clear FR_SENT when re-adding requests into pending list The following warning was reported by lee bruce ------------[ cut here ]------------ WARNING CPU 0 PID 8264 at fs/fuse/dev.c300 fuse_request_end+0x685/0x7e0 fs/fuse/dev.c300 Modules linked in CPU 0 PID 8264 Comm ab2 Not tainted 6.9.0-rc7 Hardware name QEMU Standard PC (i440FX + PIIX, 1996) RIP 0010fuse_request_end+0x685/0x7e0 fs/fuse/dev.c300 ...... Call Trace fuse_dev_do_read.constprop.0+0xd36/0x1dd0 fs/fuse/dev.c1334 fuse_dev_read+0x166/0x200 fs/fuse/dev.c1367 call_read_iter include/linux/fs.h2104 [inline] new_sync_read fs/read_write.c395 [inline] vfs_read+0x85b/0xba0 fs/read_write.c476 ksys_read+0x12f/0x260 fs/read_write.c619 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xce/0x260 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f ...... The warning is due to the FUSE_NOTIFY_RESEND notify sent by the write() syscall in the reproducer program and it happens as follows (1) calls fuse_dev_read() to read the INIT request The read succeeds. During the read, bit FR_SENT will be set on the request. (2) calls fuse_dev_write() to send an USE_NOTIFY_RESEND notify The resend notify will resend all processing requests, so the INIT request is moved from processing list to pending list again. (3) calls fuse_dev_read() with an invalid output"
}
