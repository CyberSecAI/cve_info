{
    "cveId": "CVE-2024-38626",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedfuse clear FR_SENT when re-adding requests into pending listThe following warning was reported by lee bruce ------------[ cut here ]------------ WARNING CPU 0 PID 8264 at fs/fuse/dev.c300 fuse_request_end+0x685/0x7e0 fs/fuse/dev.c300 Modules linked in CPU 0 PID 8264 Comm ab2 Not tainted 6.9.0-rc7 Hardware name QEMU Standard PC (i440FX + PIIX, 1996) RIP 0010fuse_request_end+0x685/0x7e0 fs/fuse/dev.c300 ...... Call Trace fuse_dev_do_read.constprop.0+0xd36/0x1dd0 fs/fuse/dev.c1334 fuse_dev_read+0x166/0x200 fs/fuse/dev.c1367 call_read_iter include/linux/fs.h2104 [inline] new_sync_read fs/read_write.c395 [inline] vfs_read+0x85b/0xba0 fs/read_write.c476 ksys_read+0x12f/0x260 fs/read_write.c619 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xce/0x260 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f ...... The warning is due to the FUSE_NOTIFY_RESEND notify sent by the write()syscall in the reproducer program and it happens as follows(1) calls fuse_dev_read() to read the INIT requestThe read succeeds. During the read, bit FR_SENT will be set on therequest.(2) calls fuse_dev_write() to send an USE_NOTIFY_RESEND notifyThe resend notify will resend all processing requests, so the INITrequest is moved from processing list to pending list again.(3) calls fuse_dev_read() with an invalid output addressfuse_dev_read() will try to copy the same INIT request to the outputaddress, but it will fail due to the invalid address, so the INITrequest is ended and triggers the warning in fuse_request_end().Fix it by clearing FR_SENT when re-adding requests into pending list.",
    "keyphrases": {
        "rootcause": "The FUSE_NOTIFY_RESEND notify sent by the write() syscall causes a request to be moved from the processing list to the pending list without clearing the FR_SENT bit. Later, when the request is processed again, it triggers a warning in fuse_request_end() due to the set FR_SENT bit.",
        "weakness": "The FR_SENT flag is not cleared when a request is moved back to the pending list after a resend notification.",
        "impact": "A warning is triggered in fuse_request_end() when a request with FR_SENT set is reprocessed.",
        "vector": "A user space program can trigger the vulnerability by using the FUSE_NOTIFY_RESEND notify.",
        "attacker": "A local user with access to the FUSE filesystem.",
        "product": "Linux Kernel",
        "version": "6.9.0-rc7",
        "component": "FUSE filesystem"
    }
}
