{
    "cveId": "CVE-2024-35934",
    "version": "1.0.0",
    "timestamp": "2024-12-18T22:42:50.929578+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednet/smc reduce rtnl pressure in smc_pnet_create_pnetids_list()Many syzbot reports show extreme rtnl pressure, and many of them hintthat smc acquires rtnl in netns creation for no good reason [1]This patch returns early from smc_pnet_net_init()if there is no netdevice yet.I am not even sure why smc_pnet_create_pnetids_list() even exists,because smc_pnet_netdev_event() is also callingsmc_pnet_add_base_pnetid() when handling NETDEV_UP event.[1] extract of typical syzbot reports2 locks held by syz-executor.3/12252 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.4/12253 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.1/12257 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.2/12261 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.0/12265 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.3/12268 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.4/12271 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.1/12274 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c8782 locks held by syz-executor.2/12280 #0 ffffffff8f369610 (pernet_ops_rwsem){++++}-{33}, at copy_net_ns+0x4c7/0x7b0 net/core/net_namespace.c491 #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_create_pnetids_list net/smc/smc_pnet.c809 [inline] #1 ffffffff8f375b88 (rtnl_mutex){+.+.}-{33}, at smc_pnet_net_init+0x10a/0x1e0 net/smc/smc_pnet.c878",
    "keyphrases": {
        "rootcause": "",
        "weakness": "",
        "impact": "extreme rtnl pressure",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net/smc"
    }
}
