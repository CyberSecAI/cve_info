{
    "cveId": "CVE-2024-35832",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved bcachefs kvfree bch_fssnapshots in bch2_fs_snapshots_exit bch_fssnapshots is allocated by kvzalloc in __snapshot_t_mut. It should be freed by kvfree not kfree. Or umount will triger [ 406.829178 ] BUG unable to handle page fault for address ffffe7b487148008 [ 406.830676 ] #PF supervisor read access in kernel mode [ 406.831643 ] #PF error_code(0x0000) - not-present page [ 406.832487 ] PGD 0 P4D 0 [ 406.832898 ] Oops 0000 [#1] PREEMPT SMP PTI [ 406.833512 ] CPU 2 PID 1754 Comm umount Kdump loaded Tainted G OE 6.7.0-rc7-custom+ #90 [ 406.834746 ] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS Arch Linux 1.16.3-1-1 04/01/2014 [ 406.835796 ] RIP 0010kfree+0x62/0x140 [ 406.836197 ] Code 80 48 01 d8 0f 82 e9 00 00 00 48 c7 c2 00 00 00 80 48 2b 15 78 9f 1f 01 48 01 d0 48 c1 e8 0c 48 c1 e0 06 48 03 05 56 9f 1f 01 8b 50 08 48 89 c7 f6 c2 01 0f 85 b0 00 00 00 66 90 48 8b 07 f6 [ 406.837810 ] RSP 0018ffffb9d641607e48 EFLAGS 00010286 [ 406.838213 ] RAX ffffe7b487148000 RBX ffffb9d645200000 RCX ffffb9d641607dc4 [ 406.838738 ] RDX 000065bb00000000 RSI ffffffffc0d88b84 RDI ffffb9d645200000 [ 406.839217 ] RBP ffff9a4625d00068 R08 0000000000000001 R09 0000000000000001 [ 406.839650 ] R10 0000000000000001 R11 000000000000001f R12 ffff9a4625d4da80 [ 406.840055 ] R13 ffff9a4625d00000 R14 ffffffffc0e2eb20 R15 0000000000000000 [ 406.840451 ] FS",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "kernel Oops",
        "vector": "umount",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "bcachefs kvfree bch_fssnapshots in bch2_fs_snapshots_exit"
    }
}
