{
    "cveId": "CVE-2024-35888",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved erspan make sure erspan_base_hdr is present in skb->head syzbot reported a problem in ip6erspan_rcv() [1] Issue is that ip6erspan_rcv() (and erspan_rcv()) no longer make sure erspan_base_hdr is present in skb linear part (skb->head) before getting @ver field from it. Add the missing pskb_may_pull() calls. v2 Reload iph pointer in erspan_rcv() after pskb_may_pull() because skb->head might have changed. [1] BUG KMSAN uninit-value in pskb_may_pull_reason include/linux/skbuff.h2742 [inline] BUG KMSAN uninit-value in pskb_may_pull include/linux/skbuff.h2756 [inline] BUG KMSAN uninit-value in ip6erspan_rcv net/ipv6/ip6_gre.c541 [inline] BUG KMSAN uninit-value in gre_rcv+0x11f8/0x1930 net/ipv6/ip6_gre.c610 pskb_may_pull_reason include/linux/skbuff.h2742 [inline] pskb_may_pull include/linux/skbuff.h2756 [inline] ip6erspan_rcv net/ipv6/ip6_gre.c541 [inline] gre_rcv+0x11f8/0x1930 net/ipv6/ip6_gre.c610 ip6_protocol_deliver_rcu+0x1d4c/0x2ca0 net/ipv6/ip6_input.c438 ip6_input_finish net/ipv6/ip6_input.c483 [inline] NF_HOOK include/linux/netfilter.h314 [inline] ip6_input+0x15d/0x430 net/ipv6/ip6_input.c492 ip6_mc_input+0xa7e/0xc80 net/ipv6/ip6_input.c586 dst_input include/net/dst.h460 [inline] ip6_rcv_finish+0x955/0x970 net/ipv6/ip6_input.c79 NF_HOOK include/linux/netfilter.h314 [inline] ipv6_rcv+0xde/0x390 net/ipv6/ip6_input.c310 __netif_receive_skb_one"
}
