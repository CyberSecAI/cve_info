{
    "cveId": "CVE-2024-35920",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedmedia mediatek vcodec adding lock to protect decoder context listAdd a lock for the ctx_list, to avoid accessing a NULL pointerwithin the vpu_dec_ipi_handler function when the ctx_list hasbeen deleted due to an unexpected behavior on the SCP IP block.Hardware name Google juniper sku16 board (DT)pstate 20400005 (nzCv daif +PAN -UAO -TCO BTYPE=--)pc vpu_dec_ipi_handler+0x58/0x1f8 [mtk_vcodec_dec]lr scp_ipi_handler+0xd0/0x194 [mtk_scp]sp ffffffc0131dbbd0x29 ffffffc0131dbbd0 x28 0000000000000000x27 ffffff9bb277f348 x26 ffffff9bb242ad00x25 ffffffd2d440d3b8 x24 ffffffd2a13ff1d4x23 ffffff9bb7fe85a0 x22 ffffffc0133fbdb0x21 0000000000000010 x20 ffffff9b050ea328x19 ffffffc0131dbc08 x18 0000000000001000x17 0000000000000000 x16 ffffffd2d461c6e0x15 0000000000000242 x14 000000000000018fx13 000000000000004d x12 0000000000000000x11 0000000000000001 x10 fffffffffffffff0x9 ffffff9bb6e793a8 x8 0000000000000000x7 0000000000000000 x6 000000000000003fx5 0000000000000040 x4 fffffffffffffff0x3 0000000000000020 x2 ffffff9bb6e79080x1 0000000000000010 x0 ffffffc0131dbc08Call tracevpu_dec_ipi_handler+0x58/0x1f8 [mtk_vcodec_dec (HASH6c3f 2)]scp_ipi_handler+0xd0/0x194 [mtk_scp (HASH7046 3)]mt8183_scp_irq_handler+0x44/0x88 [mtk_scp (HASH7046 3)]scp_irq_handler+0x48/0x90 [mtk_scp (HASH7046 3)]irq_thread_fn+0x38/0x94irq_thread+0x100/0x1c0kthread+0x140/0x1fcret_from_fork+0x10/0x30Code 54000088 f94ca50a eb14015f 54000060 (f9400108)---[ end trace ace43ce36cbd5c93 ]---Kernel panic - not syncing Oops Fatal exceptionSMP stopping secondary CPUsKernel Offset 0x12c4000000 from 0xffffffc010000000PHYS_OFFSET 0xffffffe580000000CPU features 0x08240002,2188200cMemory Limit none",
    "keyphrases": {
        "rootcause": "The vpu_dec_ipi_handler function attempts to access the ctx_list after it has been deleted, leading to a NULL pointer dereference.",
        "weakness": "Lack of proper locking mechanism to protect the decoder context list (ctx_list) from concurrent access and deletion.",
        "impact": "Kernel panic and system instability due to a NULL pointer dereference.",
        "vector": "An unexpected behavior on the SCP IP block causes the ctx_list to be deleted while the vpu_dec_ipi_handler attempts to access it via an inter-processor interrupt (IPI)",
        "attacker": "An unexpected behavior on the SCP IP block",
        "product": "Linux Kernel",
        "version": "Not specified",
        "component": "MediaTek VCodec driver (mtk_vcodec_dec)"
    }
}
