{
    "cveId": "CVE-2024-47688",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved driver core Fix a potential null-ptr-deref in module_add_driver() Inject fault while probing of-fpga-region, if kasprintf() fails in module_add_driver(), the second sysfs_remove_link() in exit path will cause null-ptr-deref as below because kernfs_name_hash() will call strlen() with NULL driver_name. Fix it by releasing resources based on the exit path sequence. KASAN null-ptr-deref in range [0x0000000000000000-0x0000000000000007] Mem abort info ESR = 0x0000000096000005 EC = 0x25 DABT (current EL), IL = 32 bits SET = 0, FnV = 0 EA = 0, S1PTW = 0 FSC = 0x05 level 1 translation fault Data abort info ISV = 0, ISS = 0x00000005, ISS2 = 0x00000000 CM = 0, WnR = 0, TnD = 0, TagAccess = 0 GCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0 [dfffffc000000000] address between user and kernel address ranges Internal error Oops 0000000096000005 [#1] PREEMPT SMP Dumping ftrace buffer (ftrace buffer empty) Modules linked in of_fpga_region(+) fpga_region fpga_bridge cfg80211 rfkill 8021q garp mrp stp llc ipv6 [last unloaded of_fpga_region] CPU 2 UID 0 PID 2036 Comm modprobe Not tainted 6.11.0-rc2-g6a0e38264012 #295 Hardware name linux,dummy-virt (DT) pstate 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--) pc strlen+0x24/0xb0 lr kernfs_name_hash+0x1c/0xc4 sp ffffffc081f97380 x29 ffffffc081f97380 x28 ffffffc081f97b90 x27 ffffff80c821c2a0 x26 ffffffedac0be",
    "keyphrases": {
        "rootcause": "",
        "weakness": "null-ptr-deref",
        "impact": "",
        "vector": "KASAN null-ptr-deref",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "module_add_driver()"
    }
}
