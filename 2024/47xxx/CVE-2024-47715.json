{
    "cveId": "CVE-2024-47715",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved wifi mt76 mt7915 fix oops on non-dbdc mt7986 mt7915_band_config() sets band_idx = 1 on the main phy for mt7986 with MT7975_ONE_ADIE or MT7976_ONE_ADIE. Commit 0335c034e726 (wifi mt76 fix race condition related to checking tx queue fill status) introduced a dereference of the phys array indirectly indexed by band_idx via wcid->phy_idx in mt76_wcid_cleanup(). This caused the following Oops on affected mt7986 devices Unable to handle kernel read from unreadable memory at virtual address 0000000000000024 Mem abort info ESR = 0x0000000096000005 EC = 0x25 DABT (current EL), IL = 32 bits SET = 0, FnV = 0 EA = 0, S1PTW = 0 FSC = 0x05 level 1 translation fault Data abort info ISV = 0, ISS = 0x00000005 CM = 0, WnR = 0 user pgtable 4k pages, 39-bit VAs, pgdp=0000000042545000 [0000000000000024] pgd=0000000000000000, p4d=0000000000000000, pud=0000000000000000 Internal error Oops 0000000096000005 [#1] SMP Modules linked in ... mt7915e mt76_connac_lib mt76 mac80211 cfg80211 ... CPU 2 PID 1631 Comm hostapd Not tainted 5.15.150 #0 Hardware name ZyXEL EX5700 (Telenor) (DT) pstate 80400005 (Nzcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--) pc mt76_wcid_cleanup+0x84/0x22c [mt76] lr mt76_wcid_cleanup+0x64/0x22c [mt76] sp ffffffc00a803700 x29 ffffffc00a803700 x28 ffffff80008f7300 x27 ffffff80003f3c00 x26 ffffff80000a7880 x25 ffffffc008c26e00 x24 0000000000000001",
    "keyphrases": {
        "rootcause": "dereference of the phys array indirectly indexed by band_idx",
        "weakness": "race condition",
        "impact": "Oops",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "wifi mt76 mt7915 fix oops on non-dbdc mt7986"
    }
}
