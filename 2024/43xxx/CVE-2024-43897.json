{
    "cveId": "CVE-2024-43897",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net drop bad gso csum_start and offset in virtio_net_hdr Tighten csum_start and csum_offset checks in virtio_net_hdr_to_skb for GSO packets. The function already checks that a checksum requested with VIRTIO_NET_HDR_F_NEEDS_CSUM is in skb linear. But for GSO packets this might not hold for segs after segmentation. Syzkaller demonstrated to reach this warning in skb_checksum_help offset = skb_checksum_start_offset(skb) ret = -EINVAL if (WARN_ON_ONCE(offset >= skb_headlen(skb))) By injecting a TSO packet WARNING CPU 1 PID 3539 at net/core/dev.c3284 skb_checksum_help+0x3d0/0x5b0 ip_do_fragment+0x209/0x1b20 net/ipv4/ip_output.c774 ip_finish_output_gso net/ipv4/ip_output.c279 [inline] __ip_finish_output+0x2bd/0x4b0 net/ipv4/ip_output.c301 iptunnel_xmit+0x50c/0x930 net/ipv4/ip_tunnel_core.c82 ip_tunnel_xmit+0x2296/0x2c70 net/ipv4/ip_tunnel.c813 __gre_xmit net/ipv4/ip_gre.c469 [inline] ipgre_xmit+0x759/0xa60 net/ipv4/ip_gre.c661 __netdev_start_xmit include/linux/netdevice.h4850 [inline] netdev_start_xmit include/linux/netdevice.h4864 [inline] xmit_one net/core/dev.c3595 [inline] dev_hard_start_xmit+0x261/0x8c0 net/core/dev.c3611 __dev_queue_xmit+0x1b97/0x3c90 net/core/dev.c4261 packet_snd net/packet/af_packet.c3073 [inline] The geometry of the bad input packet at tcp_gso_segment [ 52.003050][ T8403] skb len=12202 headroom=244 headlen=12093 tailroom=0 [ 52.003050][ T8403"
}
