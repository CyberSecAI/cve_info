{
  "cveId": "CVE-2024-27399",
  "version": "1.0.0",
  "timestamp": "2024-12-18T22:42:50.929578+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolvedBluetooth l2cap fix null-ptr-deref in l2cap_chan_timeoutThere is a race condition between l2cap_chan_timeout() andl2cap_chan_del(). When we use l2cap_chan_del() to delete thechannel, the chan->conn will be set to null. But the conn couldbe dereferenced again in the mutex_lock() of l2cap_chan_timeout().As a result the null pointer dereference bug will happen. TheKASAN report triggered by POC is shown below[ 472.074580] ==================================================================[ 472.075284] BUG KASAN null-ptr-deref in mutex_lock+0x68/0xc0[ 472.075308] Write of size 8 at addr 0000000000000158 by task kworker/00/7[ 472.075308][ 472.075308] CPU 0 PID 7 Comm kworker/00 Not tainted 6.9.0-rc5-00356-g78c0094a146b #36[ 472.075308] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu4[ 472.075308] Workqueue events l2cap_chan_timeout[ 472.075308] Call Trace[ 472.075308] [ 472.075308] dump_stack_lvl+0x137/0x1a0[ 472.075308] print_report+0x101/0x250[ 472.075308] ? __virt_addr_valid+0x77/0x160[ 472.075308] ? mutex_lock+0x68/0xc0[ 472.075308] kasan_report+0x139/0x170[ 472.075308] ? mutex_lock+0x68/0xc0[ 472.075308] kasan_check_range+0x2c3/0x2e0[ 472.075308] mutex_lock+0x68/0xc0[ 472.075308] l2cap_chan_timeout+0x181/0x300[ 472.075308] process_one_work+0x5d2/0xe00[ 472.075308] worker_thread+0xe1d/0x1660[ 472.075308] ? pr_cont_work+0x5e0/0x5e0[ 472.075308] kthread+0x2b7/0x350[ 472.075308] ? pr_cont_work+0x5e0/0x5e0[ 472.075308] ? kthread_blkcg+0xd0/0xd0[ 472.075308] ret_from_fork+0x4d/0x80[ 472.075308] ? kthread_blkcg+0xd0/0xd0[ 472.075308] ret_from_fork_asm+0x11/0x20[ 472.075308] [ 472.075308] ==================================================================[ 472.094860] Disabling lock debugging due to kernel taint[ 472.096136]",
  "keyphrases": {
    "rootcause": "race condition",
    "weakness": "null-ptr-deref",
    "impact": "null pointer dereference",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "Bluetooth l2cap"
  },
  "mitreTechnicalImpacts": []
}