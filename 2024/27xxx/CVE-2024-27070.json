{
    "cveId": "CVE-2024-27070",
    "version": "1.0.0",
    "timestamp": "2024-12-17T08:36:27.567979+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedf2fs fix to avoid use-after-free issue in f2fs_filemap_faultsyzbot reports a f2fs bug as belowBUG KASAN slab-use-after-free in f2fs_filemap_fault+0xd1/0x2c0 fs/f2fs/file.c49Read of size 8 at addr ffff88807bb22680 by task syz-executor184/5058CPU 0 PID 5058 Comm syz-executor184 Not tainted 6.7.0-syzkaller-09928-g052d534373b7 #0Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 11/17/2023Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x1e7/0x2d0 lib/dump_stack.c106 print_address_description mm/kasan/report.c377 [inline] print_report+0x163/0x540 mm/kasan/report.c488 kasan_report+0x142/0x170 mm/kasan/report.c601 f2fs_filemap_fault+0xd1/0x2c0 fs/f2fs/file.c49 __do_fault+0x131/0x450 mm/memory.c4376 do_shared_fault mm/memory.c4798 [inline] do_fault mm/memory.c4872 [inline] do_pte_missing mm/memory.c3745 [inline] handle_pte_fault mm/memory.c5144 [inline] __handle_mm_fault+0x23b7/0x72b0 mm/memory.c5285 handle_mm_fault+0x27e/0x770 mm/memory.c5450 do_user_addr_fault arch/x86/mm/fault.c1364 [inline] handle_page_fault arch/x86/mm/fault.c1507 [inline] exc_page_fault+0x456/0x870 arch/x86/mm/fault.c1563 asm_exc_page_fault+0x26/0x30 arch/x86/include/asm/idtentry.h570The root cause is in f2fs_filemap_fault(), vmf->vma may be not alive afterfilemap_fault(), so it may cause use-after-free issue when accessingvmf->vma->vm_flags in trace_f2fs_filemap_fault(). So it needs to keep vm_flagsin separated temporary variable for tracepoint use.",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "f2fs_filemap_fault() in fs/f2fs/file.c"
    }
}
