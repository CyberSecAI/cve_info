{
    "cveId": "CVE-2024-27001",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved comedi vmk80xx fix incomplete endpoint checking While vmk80xx does have endpoint checking implemented, some things can fall through the cracks. Depending on the hardware model, URBs can have either bulk or interrupt type, and current version of vmk80xx_find_usb_endpoints() function does not take that fully into account. While this warning does not seem to be too harmful, at the very least it will crash systems with panic_on_warn set on them. Fix the issue found by Syzkaller [1] by somewhat simplifying the endpoint checking process with usb_find_common_endpoints() and ensuring that only expected endpoint types are present. This patch has not been tested on real hardware. [1] Syzkaller report usb 1-1 BOGUS urb xfer, pipe 1 != type 3 WARNING CPU 0 PID 781 at drivers/usb/core/urb.c504 usb_submit_urb+0xc4e/0x18c0 drivers/usb/core/urb.c503 ... Call Trace usb_start_wait_urb+0x113/0x520 drivers/usb/core/message.c59 vmk80xx_reset_device drivers/comedi/drivers/vmk80xx.c227 [inline] vmk80xx_auto_attach+0xa1c/0x1a40 drivers/comedi/drivers/vmk80xx.c818 comedi_auto_config+0x238/0x380 drivers/comedi/drivers.c1067 usb_probe_interface+0x5cd/0xb00 drivers/usb/core/driver.c399 ... Similar issue also found by Syzkaller",
    "keyphrases": {
        "rootcause": "incomplete endpoint checking",
        "weakness": "",
        "impact": "crash systems with panic_on_warn set on them",
        "vector": "BOGUS urb xfer",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "comedi vmk80xx"
    }
}
