{
    "cveId": "CVE-2024-27066",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved virtio packed fix unmap leak for indirect desc table When use_dma_api and premapped are true, then the do_unmap is false. Because the do_unmap is false, vring_unmap_extra_packed is not called by detach_buf_packed. if (unlikely(vq->do_unmap)) { curr = id for (i = 0 i num i++) { vring_unmap_extra_packed(vq, &vq->packed.desc_extra[curr]) curr = vq->packed.desc_extra[curr].next } } So the indirect desc table is not unmapped. This causes the unmap leak. So here, we check vq->use_dma_api instead. Synchronously, dma info is updated based on use_dma_api judgment This bug does not occur, because no driver use the premapped with indirect.",
    "keyphrases": {
        "rootcause": "do_unmap is false",
        "weakness": "",
        "impact": "unmap leak",
        "vector": "premapped with indirect",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "virtio packed fix unmap leak"
    }
}
