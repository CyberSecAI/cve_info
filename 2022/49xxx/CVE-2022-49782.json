{
    "cveId": "CVE-2022-49782",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved perf Improve missing SIGTRAP checking To catch missing SIGTRAP we employ a WARN in __perf_event_overflow(), which fires if pending_sigtrap was already set returning to user space without consuming pending_sigtrap, and then having the event fire again would re-enter the kernel and trigger the WARN. This, however, seemed to miss the case where some events not associated with progress in the user space task can fire and the interrupt handler runs before the IRQ work meant to consume pending_sigtrap (and generate the SIGTRAP). syzbot gifted us this stack trace | WARNING CPU 0 PID 3607 at kernel/events/core.c9313 __perf_event_overflow | Modules linked in | CPU 0 PID 3607 Comm syz-executor100 Not tainted 6.1.0-rc2-syzkaller-00073-g88619e77b33d #0 | Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 10/11/2022 | RIP 0010__perf_event_overflow+0x498/0x540 kernel/events/core.c9313 | | Call Trace | | perf_swevent_hrtimer+0x34f/0x3c0 kernel/events/core.c10729 | __run_hrtimer kernel/time/hrtimer.c1685 [inline] | __hrtimer_run_queues+0x1c6/0xfb0 kernel/time/hrtimer.c1749 | hrtimer_interrupt+0x31c/0x790 kernel/time/hrtimer.c1811 | local_apic_timer_interrupt arch/x86/kernel/apic/apic.c1096 [inline] | __sysvec_apic_timer_interrupt+0x17c/0x640 arch/x86/kernel/apic/apic.c1113 | sysvec_apic_timer_interrupt+0x40/0xc0 arch/x86/kernel/apic/apic.c1107 | asm_sysvec_apic_timer_interrupt+0x16/0x20 arch/x86/include/asm/idtentry.h649 | | In this case, syzbot produced a program with event type PERF_TYPE_SOFTWARE and config PERF_COUNT_SW_CPU_CLOCK. The hrtimer manages to fire again before the IRQ work got a chance to run, all while never having returned to user space. Improve the WARN to check for real progress in user space approximate this by storing a 32-bit hash of the current IP into pending_sigtrap, and if an event fires while pending_sigtrap still matches the previous IP, we assume no progress (false negatives are possible given we could return to user space and trigger again on the same IP).",
    "keyphrases": {
        "rootcause": "",
        "weakness": "improve missing SIGTRAP checking",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.1.0-rc2-syzkaller-00073-g88619e77b33d",
        "component": "perf"
    }
}
