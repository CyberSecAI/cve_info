{
    "cveId": "CVE-2022-49380",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved f2fs fix to avoid f2fs_bug_on() in dec_valid_node_count() As Yanming reported in bugzilla https//bugzilla.kernel.org/show_bug.cgi?id=215897 I have encountered a bug in F2FS file system in kernel v5.17. The kernel should enable CONFIG_KASAN=y and CONFIG_KASAN_INLINE=y. You can reproduce the bug by running the following commands The kernel message is shown below kernel BUG at fs/f2fs/f2fs.h2511! Call Trace f2fs_remove_inode_page+0x2a2/0x830 f2fs_evict_inode+0x9b7/0x1510 evict+0x282/0x4e0 do_unlinkat+0x33a/0x540 __x64_sys_unlinkat+0x8e/0xd0 do_syscall_64+0x3b/0x90 entry_SYSCALL_64_after_hwframe+0x44/0xae The root cause is .total_valid_block_count or .total_valid_node_count could fuzzed to zero, then once dec_valid_node_count() was called, it will cause BUG_ON(), this patch fixes to print warning info and set SBI_NEED_FSCK into CP instead of panic.",
    "keyphrases": {
        "component": "F2FS file system",
        "rootcause": "f2fs_bug_on",
        "vector": "fuzzed to zero",
        "weakness": "",
        "product": "Linux kernel",
        "impact": "BUG_ON, f2fs_remove_inode_page+0x2a2/0x830, f2fs_evict_inode+0x9b7/0x1510, evict+0x282/0x4e0, do_unlinkat+0x33a/0x540, __x64_sys_unlinkat+0x8e/0xd0, do_syscall_64+0x3b/0x90, entry_SYSCALL_64_after_hwframe+0x44/0xae",
        "attacker": "",
        "version": "5.17"
    }
}
