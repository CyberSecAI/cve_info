{
    "cveId": "CVE-2022-49871",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net tun Fix memory leaks of napi_get_frags kmemleak reports after running test_progs unreferenced object 0xffff8881b1672dc0 (size 232) comm test_progs, pid 394388, jiffies 4354712116 (age 841.975s) hex dump (first 32 bytes) e0 84 d7 a8 81 88 ff ff 80 2c 67 b1 81 88 ff ff .........,g..... 00 40 c5 9b 81 88 ff ff 00 00 00 00 00 00 00 00 .@.............. backtrace [] napi_skb_cache_get+0xd4/0x150 [] __napi_build_skb+0x15/0x50 [] __napi_alloc_skb+0x26e/0x540 [] napi_get_frags+0x59/0x140 [] tun_get_user+0x183d/0x3bb0 [tun] [] tun_chr_write_iter+0xc0/0x1b1 [tun] [] do_iter_readv_writev+0x19f/0x320 [] do_iter_write+0x135/0x630 [] vfs_writev+0x12e/0x440 [] do_writev+0x104/0x280 [] do_syscall_64+0x3b/0x90 [] entry_SYSCALL_64_after_hwframe+0x63/0xcd The issue occurs in the following scenarios tun_get_user() napi_gro_frags() napi_frags_finish() case GRO_NORMAL gro_normal_one() list_add_tail(&skb->list, &napi->rx_list) rx_count rx_list is not empty rx_list is not empty, which caused memory leaks To fix, add napi_complete() after napi_gro_frags().",
    "keyphrases": {
        "rootcause": "Memory leaks",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net tun"
    }
}
