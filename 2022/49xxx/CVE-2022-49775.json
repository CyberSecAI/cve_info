{
    "cveId": "CVE-2022-49775",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved tcp cdg allow tcp_cdg_release() to be called multiple times Apparently, mptcp is able to call tcp_disconnect() on an already disconnected flow. This is generally fine, unless current congestion control is CDG, because it might trigger a double-free [1] Instead of fixing MPTCP, and future bugs, we can make tcp_disconnect() more resilient. [1] BUG KASAN double-free in slab_free mm/slub.c3539 [inline] BUG KASAN double-free in kfree+0xe2/0x580 mm/slub.c4567 CPU 0 PID 3645 Comm kworker/07 Not tainted 6.0.0-syzkaller-02734-g0326074ff465 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/22/2022 Workqueue events mptcp_worker Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c106 print_address_description mm/kasan/report.c317 [inline] print_report.cold+0x2ba/0x719 mm/kasan/report.c433 kasan_report_invalid_free+0x81/0x190 mm/kasan/report.c462 ____kasan_slab_free+0x18b/0x1c0 mm/kasan/common.c356 kasan_slab_free include/linux/kasan.h200 [inline] slab_free_hook mm/slub.c1759 [inline] slab_free_freelist_hook+0x8b/0x1c0 mm/slub.c1785 slab_free mm/slub.c3539 [inline] kfree+0xe2/0x580 mm/slub.c4567 tcp_disconnect+0x980/0x1e20 net/ipv4/tcp.c3145 __mptcp_close_ssk+0x5ca/0x7e0 net/mptcp/protocol.c2327 mptcp_do_fastclose net/mptcp/protocol.c2592 [inline] mptcp_worker+0x78c/0xff0 net/mptcp/protocol.c2627 process_one_work+0x991/0x1610 kernel/workqueue.c2289 worker_thread+0x665/0x1080 kernel/workqueue.c2436 kthread+0x2e4/0x3a0 kernel/kthread.c376 ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S306 Allocated by task 3671 kasan_save_stack+0x1e/0x40 mm/kasan/common.c38 kasan_set_track mm/kasan/common.c45 [inline] set_alloc_info mm/kasan/common.c437 [inline] ____kasan_kmalloc mm/kasan/common.c516 [inline] ____kasan_kmalloc mm/kasan/common.c475 [inline] __kasan_kmalloc+0xa9/0xd0 mm/kasan/common.c525 kmalloc_array include/linux/slab.h640 [inline] kcalloc include/linux/slab.h671 [inline] tcp_cdg_init+0x10d/0x170 net/ipv4/tcp_cdg.c380 tcp_init_congestion_control+0xab/0x550 net/ipv4/tcp_cong.c193 tcp_reinit_congestion_control net/ipv4/tcp_cong.c217 [inline] tcp_set_congestion_control+0x96c/0xaa0 net/ipv4/tcp_cong.c391 do_tcp_setsockopt+0x505/0x2320 net/ipv4/tcp.c3513 tcp_setsockopt+0xd4/0x100 net/ipv4/tcp.c3801 mptcp_setsockopt+0x35f/0x2570 net/mptcp/sockopt.c844 __sys_setsockopt+0x2d6/0x690 net/socket.c2252 __do_sys_setsockopt net/socket.c2263 [inline] __se_sys_setsockopt net/socket.c2260 [inline] __x64_sys_setsockopt+0xba/0x150 net/socket.c2260 do_syscall_x64 arch/x86/entry/common.c50 [inline] do_syscall_64+0x35/0xb0 arch/x86/entry/common.c80 entry_SYSCALL_64_after_hwframe+0x63/0xcd Freed by task 16 kasan_save_stack+0x1e/0x40 mm/kasan/common.c38 kasan_set_track+0x21/0x30 mm/kasan/common.c45 kasan_set_free_info+0x20/0x30 mm/kasan/generic.c370 ____kasan_slab_free mm/kasan/common.c367 [inline] ____kasan_slab_free+0x166/0x1c0 mm/kasan/common.c329 kasan_slab_free include/linux/kasan.h200 [inline] slab_free_hook mm/slub.c1759 [inline] slab_free_freelist_hook+0x8b/0x1c0 mm/slub.c1785 slab_free mm/slub.c3539 [inline] kfree+0xe2/0x580 mm/slub.c4567 tcp_cleanup_congestion_control+0x70/0x120 net/ipv4/tcp_cong.c226 tcp_v4_destroy_sock+0xdd/0x750 net/ipv4/tcp_ipv4.c2254 tcp_v6_destroy_sock+0x11/0x20 net/ipv6/tcp_ipv6.c1969 inet_csk_destroy_sock+0x196/0x440 net/ipv4/inet_connection_sock.c1157 tcp_done+0x23b/0x340 net/ipv4/tcp.c4649 tcp_rcv_state_process+0x40e7/0x4990 net/ipv4/tcp_input.c6624 tcp_v6_do_rcv+0x3fc/0x13c0 net/ipv6/tcp_ipv6.c1525 tcp_v6_rcv+0x2e8e/0x3830 net/ipv6/tcp_ipv6.c1759 ip6_protocol_deliver_rcu+0x2db/0x1950 net/ipv6/ip6_input.c439 ip6_input_finish+0x14c/0x2c0 net/ipv6/ip6_input.c484 NF_HOOK include/linux/netfilter.h302 [inline] NF_HOOK include/linux/netfilter.h296 [inline] ip6_input+0x9c/0xd ---truncated---",
    "keyphrases": {
        "rootcause": "",
        "weakness": "double-free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.0.0-syzkaller-02734-g0326074ff465",
        "component": "tcp cdg"
    }
}
