{
  "cveId": "CVE-2022-49648",
  "version": "1.0.0",
  "timestamp": "2025-07-04T16:12:41.853043+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved tracing/histograms Fix memory leak problem This reverts commit 46bbe5c671e06f070428b9be142cc4ee5cedebac. As commit 46bbe5c671e0 (tracing fix double free) said, the double free problem reported by clang static analyzer is > In parse_var_defs() if there is a problem allocating > var_defs.expr, the earlier var_defs.name is freed. > This free is duplicated by free_var_defs() which frees > the rest of the list. However, if there is a problem allocating N-th var_defs.expr + in parse_var_defs(), the freed earlier var_defs.name is actually the N-th var_defs.name + then in free_var_defs(), the names from 0th to (N-1)-th are freed IF ALLOCATING PROBLEM HAPPENED HERE!!! -+ \\\\ | 0th 1th (N-1)-th N-th V +-------------+-------------+-----+-------------+----------- var_defs | name | expr | name | expr | ... | name | expr | name | /// +-------------+-------------+-----+-------------+----------- These two frees dont act on same name, so there was no double free problem before. Conversely, after that commit, we get a memory leak problem because the above N-th var_defs.name is not freed. If enable CONFIG_DEBUG_KMEMLEAK and inject a fault at where the N-th var_defs.expr allocated, then execute on shell like $ echo histkey=call_siteval=$v1,$v2v1=bytes_req,v2=bytes_alloc > \\\\ /sys/kernel/debug/tracing/events/kmem/kmalloc/trigger Then kmemleak reports unreferenced object 0xffff8fb100ef3518 (size 8) comm bash, pid 196, jiffies 4295681690 (age 28.538s) hex dump (first 8 bytes) 76 31 00 00 b1 8f ff ff v1...... backtrace [] kstrdup+0x2d/0x60 [] event_hist_trigger_parse+0x206f/0x20e0 [] trigger_process_regex+0xc0/0x110 [] event_trigger_write+0x75/0xd0 [] vfs_write+0xbb/0x2a0 [] ksys_write+0x59/0xd0 [] do_syscall_64+0x3a/0x80 [] entry_SYSCALL_64_after_hwframe+0x46/0xb0",
  "keyphrases": {
    "rootcause": "",
    "weakness": [
      "double free",
      "memory leak"
    ],
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "tracing/histograms"
  },
  "mitreTechnicalImpacts": []
}