{
    "cveId": "CVE-2022-49504",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved scsi lpfc Inhibit aborts if external loopback plug is inserted After running a short external loopback test, when the external loopback is removed and a normal cable inserted that is directly connected to a target device, the system oops in the llpfc_set_rrq_active() routine. When the loopback was inserted an FLOGI was transmit. As were looped back, we receive the FLOGI request. The FLOGI is ABTSd as we recognize the same wppn thus understand its a loopback. However, as the ABTS sends address information the port is not set to (fffffe), the ABTS is dropped on the wire. A short 1 frame loopback test is run and completes before the ABTS times out. The looback is unplugged and the new cable plugged in, and the an FLOGI to the new device occurs and completes. Due to a mixup in ref counting the completion of the new FLOGI releases the fabric ndlp. Then the original ABTS completes and references the released ndlp generating the oops. Correct by no-oping the ABTS when in loopback mode (it will be dropped anyway). Added a flag to track the mode to recognize when it should be no-opd.",
    "keyphrases": {
        "rootcause": "mixup in ref counting",
        "weakness": "",
        "impact": "oops",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "scsi lpfc"
    }
}
