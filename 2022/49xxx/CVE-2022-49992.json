{
    "cveId": "CVE-2022-49992",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mm/mprotect only reference swap pfn page if type match Yu Zhao reported a bug after the commit mm/swap Add swp_offset_pfn() to fetch PFN from swap entry added a check in swp_offset_pfn() for swap type [1] kernel BUG at include/linux/swapops.h117! CPU 46 PID 5245 Comm EventManager_De Tainted G S O L 6.0.0-dbg-DEV #2 RIP 0010pfn_swap_entry_to_page+0x72/0xf0 Code c6 48 8b 36 48 83 fe ff 74 53 48 01 d1 48 83 c1 08 48 8b 09 f6 c1 01 75 7b 66 90 48 89 c1 48 8b 09 f6 c1 01 74 74 5d c3 eb 9e 0b 48 ba ff ff ff ff 03 00 00 00 eb ae a9 ff 0f 00 00 75 13 48 RSP 0018ffffa59e73fabb80 EFLAGS 00010282 RAX 00000000ffffffe8 RBX 0c00000000000000 RCX ffffcd5440000000 RDX 1ffffffffff7a80a RSI 0000000000000000 RDI 0c0000000000042b RBP ffffa59e73fabb80 R08 ffff9965ca6e8bb8 R09 0000000000000000 R10 ffffffffa5a2f62d R11 0000030b372e9fff R12 ffff997b79db5738 R13 000000000000042b R14 0c0000000000042b R15 1ffffffffff7a80a FS 00007f549d1bb700(0000) GSffff99d3cf680000(0000) knlGS0000000000000000 CS 0010 DS 0000 ES 0000 CR0 0000000080050033 CR2 0000440d035b3180 CR3 0000002243176004 CR4 00000000003706e0 DR0 0000000000000000 DR1 0000000000000000 DR2 0000000000000000 DR3 0000000000000000 DR6 00000000fffe0ff0 DR7 0000000000000400 Call Trace change_pte_range+0x36e/0x880 change_p4d_range+0x2e8/0x670 change_protection_range+0x14e/0x2c0 mprotect_fixup+0x1ee/0x330 do_mprotect_pkey+0x34c/0x440 __x64_sys_mprotect+0x1d/0x30 It triggers because pfn_swap_entry_to_page() could be called upon e.g. a genuine swap entry. Fix it by only calling it when its a write migration entry where the page* is used. [1] https//lore.kernel.org/lkml/CAOUHufaVC2Za-p8m0aiHw6YkheDcrO-C3wRGixwDS32VTS+k1w@mail.gmail.com/",
    "keyphrases": {
        "rootcause": "",
        "weakness": "",
        "impact": "kernel BUG",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.0.0-dbg-DEV",
        "component": "mm/mprotect"
    }
}
