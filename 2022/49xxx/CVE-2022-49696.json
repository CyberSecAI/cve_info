{
    "cveId": "CVE-2022-49696",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved tipc fix use-after-free Read in tipc_named_reinit syzbot found the following issue on ================================================================== BUG KASAN use-after-free in tipc_named_reinit+0x94f/0x9b0 net/tipc/name_distr.c413 Read of size 8 at addr ffff88805299a000 by task kworker/19/23764 CPU 1 PID 23764 Comm kworker/19 Not tainted 5.18.0-rc4-syzkaller-00878-g17d49e6e8012 #0 Hardware name Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011 Workqueue events tipc_net_finalize_work Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c106 print_address_description.constprop.0.cold+0xeb/0x495 mm/kasan/report.c313 print_report mm/kasan/report.c429 [inline] kasan_report.cold+0xf4/0x1c6 mm/kasan/report.c491 tipc_named_reinit+0x94f/0x9b0 net/tipc/name_distr.c413 tipc_net_finalize+0x234/0x3d0 net/tipc/net.c138 process_one_work+0x996/0x1610 kernel/workqueue.c2289 worker_thread+0x665/0x1080 kernel/workqueue.c2436 kthread+0x2e9/0x3a0 kernel/kthread.c376 ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S298 [...] ================================================================== In the commit d966ddcc3821 (tipc fix a deadlock when flushing scheduled work), the cancel_work_sync() function just to make sure ONLY the work tipc_net_finalize_work() is executing/pending on any CPU completed before tipc namespace is destroyed through tipc_exit_net(). But this function is not guaranteed the work is the last queued. So, the destroyed instance may be accessed in the work which will try to enqueue later. In order to completely fix, we re-order the calling of cancel_work_sync() to make sure the work tipc_net_finalize_work() was last queued and it must be completed by calling cancel_work_sync().",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "use-after-free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "5.18.0-rc4-syzkaller-00878-g17d49e6e8012",
        "component": "tipc_named_reinit"
    }
}
