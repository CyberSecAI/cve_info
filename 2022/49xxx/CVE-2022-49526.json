{
    "cveId": "CVE-2022-49526",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved md/bitmap dont set sb values if cant pass sanity check If bitmap area contains invalid data, kernel will crash then mdadm triggers Segmentation fault. This is cluster-md speical bug. In non-clustered env, mdadm will handle broken metadata case. In clustered array, only kernel space handles bitmap slot info. But even this bug only happened in clustered env, current sanity check is wrong, the code should be changed. How to trigger (faulty injection) dd if=/dev/zero bs=1M count=1 oflag=direct of=/dev/sda dd if=/dev/zero bs=1M count=1 oflag=direct of=/dev/sdb mdadm -C /dev/md0 -b clustered -e 1.2 -n 2 -l mirror /dev/sda /dev/sdb mdadm -Ss echo aaa > magic.txt == below modifying slot 2 bitmap data == dd if=magic.txt of=/dev/sda seek=16384 bs=1 count=3 <== destroy magic dd if=/dev/zero of=/dev/sda seek=16436 bs=1 count=4 <== ZERO chunksize mdadm -A /dev/md0 /dev/sda /dev/sdb == kernel crashes. mdadm outputs Segmentation fault == Reason of kernel crash In md_bitmap_read_sb (called by md_bitmap_create), bad bitmap magic didnt block chunksize assignment, and zero value made DIV_ROUND_UP_SECTOR_T() trigger divide error. Crash log kernel md md0 stopped. kernel md/raid1md0 not clean -- starting background reconstruction kernel md/raid1md0 active with 2 out of 2 mirrors kernel dlm ... ... kernel md-cluster Joined cluster 44810aba-38bb-e6b8-daca-bc97a0b254aa slot 1 kernel md0 invalid bitmap file superblock bad magic kernel md_bitmap_copy_from_slot cant get bitmap from slot 2 kernel md-cluster Could not gather bitmaps from slot 2 kernel divide error 0000",
    "keyphrases": {
        "component": "md/bitmap",
        "rootcause": "bad bitmap magic, bad metadata",
        "vector": "dd if=/dev/zero...",
        "weakness": "",
        "product": "Linux kernel",
        "impact": "Segmentation fault, kernel crash",
        "attacker": "",
        "version": ""
    }
}
