{
    "cveId": "CVE-2022-49636",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved vlan fix memory leak in vlan_newlink() Blamed commit added back a bug I fixed in commit 9bbd917e0bec (vlan fix memory leak in vlan_dev_set_egress_priority) If a memory allocation fails in vlan_changelink() after other allocations succeeded, we need to call vlan_dev_free_egress_priority() to free all allocated memory because after a failed ->newlink() we do not call any methods like ndo_uninit() or dev->priv_destructor(). In following example, if the allocation for last element 20002001 fails, we need to free eight prior allocations ip link add link dummy0 dummy0.100 type vlan id 100 \\\\ egress-qos-map 12 23 34 45 56 67 78 89 20002001 syzbot report was BUG memory leak unreferenced object 0xffff888117bd1060 (size 32) comm syz-executor408, pid 3759, jiffies 4294956555 (age 34.090s) hex dump (first 32 bytes) 09 00 00 00 00 a0 00 00 00 00 00 00 00 00 00 00 ................ 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ backtrace [] kmalloc include/linux/slab.h600 [inline] [] vlan_dev_set_egress_priority+0xed/0x170 net/8021q/vlan_dev.c193 [] vlan_changelink+0x178/0x1d0 net/8021q/vlan_netlink.c128 [] vlan_newlink+0x148/0x260 net/8021q/vlan_netlink.c185 [] rtnl_newlink_create net/core/rtnetlink.c3363 [inline] [] __rtnl_newlink+0xa58/0xdc0 net/core/rtnetlink.c3580 [] rtnl_newlink+0x49/0x70 net/core/rtnetlink.c3593 [] rtnetlink_rcv_msg+0x21c/0x5c0 net/core/rtnetlink.c6089 [] netlink_rcv_skb+0x87/0x1d0 net/netlink/af_netlink.c2501 [] netlink_unicast_kernel net/netlink/af_netlink.c1319 [inline] [] netlink_unicast+0x397/0x4c0 net/netlink/af_netlink.c1345 [] netlink_sendmsg+0x396/0x710 net/netlink/af_netlink.c1921 [] sock_sendmsg_nosec net/socket.c714 [inline] [] sock_sendmsg+0x56/0x80 net/socket.c734 [] ____sys_sendmsg+0x36c/0x390 net/socket.c2488 [] ___sys_sendmsg+0x8b/0xd0 net/socket.c2542 [] __sys_sendmsg net/socket.c2571 [inline] [] __do_sys_sendmsg net/socket.c2580 [inline] [] __se_sys_sendmsg net/socket.c2578 [inline] [] __x64_sys_sendmsg+0x78/0xf0 net/socket.c2578 [] do_syscall_x64 arch/x86/entry/common.c50 [inline] [] do_syscall_64+0x35/0xb0 arch/x86/entry/common.c80 [] entry_SYSCALL_64_after_hwframe+0x46/0xb0",
    "keyphrases": {
        "rootcause": "",
        "weakness": "memory leak",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "",
        "version": "",
        "component": "vlan fix memory leak in vlan_dev_set_egress_priority"
    }
}
