{
    "cveId": "CVE-2022-50225",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved riscvuprobe fix SR_SPIE set/clear handling In riscv the process of uprobe going to clear spie before exec the origin insn,and set spie after that.But When access the page which origin insn has been placed a page fault may happen and irq was disabled in arch_uprobe_pre_xol function,It cause a WARN as follows. There is no need to clear/set spie in arch_uprobe_pre/post/abort_xol. We can just remove it. [ 31.684157] BUG sleeping function called from invalid context at kernel/locking/rwsem.c1488 [ 31.684677] in_atomic() 0, irqs_disabled() 1, non_block 0, pid 76, name work [ 31.684929] preempt_count 0, expected 0 [ 31.685969] CPU 2 PID 76 Comm work Tainted G [ 31.686542] Hardware name riscv-virtio,qemu (DT) [ 31.686797] Call Trace [ 31.687053] [] dump_backtrace+0x30/0x38 [ 31.687699] [] show_stack+0x40/0x4c [ 31.688141] [] dump_stack_lvl+0x44/0x5c [ 31.688396] [] dump_stack+0x18/0x20 [ 31.688653] [] __might_resched+0x114/0x122 [ 31.688948] [] __might_sleep+0x50/0x7a [ 31.689435] [] down_read+0x30/0x130 [ 31.689728] [] do_page_fault+0x166/x446 [ 31.689997] [] ret_from_exception+0x0/0xc",
    "keyphrases": {
        "rootcause": "",
        "weakness": "sleeping function called from invalid context",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "riscvuprobe fix SR_SPIE"
    }
}
