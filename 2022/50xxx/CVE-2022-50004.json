{
    "cveId": "CVE-2022-50004",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved xfrm policy fix metadata dst->dev xmit null pointer dereference When we try to transmit an skb with metadata_dst attached (i.e. dst->dev == NULL) through xfrm interface we can hit a null pointer dereference[1] in xfrmi_xmit2() -> xfrm_lookup_with_ifid() due to the check for a loopback skb device when theres no policy which dereferences dst->dev unconditionally. Not having dst->dev can be interepreted as it not being a loopback device, so just add a check for a null dst_orig->dev. With this fix xfrm interfaces Tx error counters go up as usual. [1] net-next calltrace captured via netconsole",
    "keyphrases": {
        "component": "xfrm policy, xfrmi_xmit2()",
        "rootcause": "",
        "vector": "transmit an skb with metadata_dst attached (i.e. dst->dev == NULL) through xfrm interface",
        "weakness": "null pointer dereference",
        "product": "Linux kernel",
        "impact": "",
        "attacker": "",
        "version": ""
    }
}
