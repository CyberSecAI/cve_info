{
    "cveId": "CVE-2022-0866",
    "version": "1.0.0",
    "timestamp": "2024-12-15T20:24:27.876763+00:00",
    "description": "This is a concurrency issue that can result in the wrong caller principal being returned from the session context of an EJB that is configured with a RunAs principal. In particular, the org.jboss.as.ejb3.component.EJBComponent class has an incomingRunAsIdentity field. This field is used by the org.jboss.as.ejb3.security.RunAsPrincipalInterceptor to keep track of the current identity prior to switching to a new identity created using the RunAs principal. The exploit consist that the EJBComponent#incomingRunAsIdentity field is currently just a SecurityIdentity. This means in a concurrent environment, where multiple users are repeatedly invoking an EJB that is configured with a RunAs principal, its possible for the wrong the caller principal to be returned from EJBComponent#getCallerPrincipal. Similarly, its also possible for EJBComponent#isCallerInRole to return the wrong value. Both of these methods rely on incomingRunAsIdentity. Affects all versions of JBoss EAP from 7.1.0 and all versions of WildFly 11+ when Elytron is enabled.",
    "keyphrases": {
        "rootcause": "concurrency issue",
        "weakness": "",
        "impact": "wrong caller principal being returned from the session context of an EJB that is configured with a RunAs principal",
        "vector": "",
        "attacker": "",
        "product": [
            "JBoss EAP",
            "WildFly"
        ],
        "version": "EAP 7.1.0+",
        "component": [
            "org.jboss.as.ejb3.component.EJBComponent class",
            "org.jboss.as.ejb3.security.RunAsPrincipalInterceptor"
        ]
    }
}
