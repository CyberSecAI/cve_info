{
    "cveId": "CVE-2022-48878",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved Bluetooth hci_qca Fix driver shutdown on closed serdev The driver shutdown callback (which sends EDL_SOC_RESET to the device over serdev) should not be invoked when HCI device is not open (e.g. if hci_dev_open_sync() failed), because the serdev and its TTY are not open either. Also skip this step if device is powered off (qca_power_shutdown()). The shutdown callback causes use-after-free during system reboot with Qualcomm Atheros Bluetooth Unable to handle kernel paging request at virtual address 0072662f67726fd7 ... CPU 6 PID 1 Comm systemd-shutdow Tainted G W 6.1.0-rt5-00325-g8a5f56bcfcca #8 Hardware name Qualcomm Technologies, Inc. Robotics RB5 (DT) Call trace tty_driver_flush_buffer+0x4/0x30 serdev_device_write_flush+0x24/0x34 qca_serdev_shutdown+0x80/0x130 [hci_uart] device_shutdown+0x15c/0x260 kernel_restart+0x48/0xac KASAN report BUG KASAN use-after-free in tty_driver_flush_buffer+0x1c/0x50 Read of size 8 at addr ffff16270c2e0018 by task systemd-shutdow/1 CPU 7 PID 1 Comm systemd-shutdow Not tainted 6.1.0-next-20221220-00014-gb85aaf97fb01-dirty #28 Hardware name Qualcomm Technologies, Inc. Robotics RB5 (DT) Call trace dump_backtrace.part.0+0xdc/0xf0 show_stack+0x18/0x30 dump_stack_lvl+0x68/0x84 print_report+0x188/0x488 kasan_report+0xa4/0xf0 __asan_load8+0x80/0xac tty_driver_flush_buffer+0x1c/0x50 ttyport_w",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "kernel paging request",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "6.1.0-rt5-00325-g8a5f56bcfcca",
        "component": "Bluetooth hci_qca Fix driver shutdown on closed serdev"
    }
}
