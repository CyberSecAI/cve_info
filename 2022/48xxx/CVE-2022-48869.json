{
    "cveId": "CVE-2022-48869",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved USB gadgetfs Fix race between mounting and unmounting The syzbot fuzzer and Gerald Lee have identified a use-after-free bug in the gadgetfs driver, involving processes concurrently mounting and unmounting the gadgetfs filesystem. In particular, gadgetfs_fill_super() can race with gadgetfs_kill_sb(), causing the latter to deallocate the_device while the former is using it. The output from KASAN says, in part BUG KASAN use-after-free in instrument_atomic_read_write include/linux/instrumented.h102 [inline] BUG KASAN use-after-free in atomic_fetch_sub_release include/linux/atomic/atomic-instrumented.h176 [inline] BUG KASAN use-after-free in __refcount_sub_and_test include/linux/refcount.h272 [inline] BUG KASAN use-after-free in __refcount_dec_and_test include/linux/refcount.h315 [inline] BUG KASAN use-after-free in refcount_dec_and_test include/linux/refcount.h333 [inline] BUG KASAN use-after-free in put_dev drivers/usb/gadget/legacy/inode.c159 [inline] BUG KASAN use-after-free in gadgetfs_kill_sb+0x33/0x100 drivers/usb/gadget/legacy/inode.c2086 Write of size 4 at addr ffff8880276d7840 by task syz-executor126/18689 CPU 0 PID 18689 Comm syz-executor126 Not tainted 6.1.0-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 10/26/2022 Call Trace ... atomic_fetch_sub_release include/linux/atomic/atomic-instrumented.h176 [inline] __ref",
    "keyphrases": {
        "rootcause": "race between mounting and unmounting",
        "weakness": "use-after-free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "USB gadgetfs"
    }
}
