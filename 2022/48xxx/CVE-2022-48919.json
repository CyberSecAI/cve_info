{
    "cveId": "CVE-2022-48919",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved cifs fix double free race when mount fails in cifs_get_root() When cifs_get_root() fails during cifs_smb3_do_mount() we call deactivate_locked_super() which eventually will call delayed_free() which will free the context. In this situation we should not proceed to enter the out section in cifs_smb3_do_mount() and free the same resources a second time. [Thu Feb 10 125906 2022] BUG KASAN use-after-free in rcu_cblist_dequeue+0x32/0x60 [Thu Feb 10 125906 2022] Read of size 8 at addr ffff888364f4d110 by task swapper/1/0 [Thu Feb 10 125906 2022] CPU 1 PID 0 Comm swapper/1 Tainted G OE 5.17.0-rc3+ #4 [Thu Feb 10 125906 2022] Hardware name Microsoft Corporation Virtual Machine/Virtual Machine, BIOS Hyper-V UEFI Release v4.0 12/17/2019 [Thu Feb 10 125906 2022] Call Trace [Thu Feb 10 125906 2022] [Thu Feb 10 125906 2022] dump_stack_lvl+0x5d/0x78 [Thu Feb 10 125906 2022] print_address_description.constprop.0+0x24/0x150 [Thu Feb 10 125906 2022] ? rcu_cblist_dequeue+0x32/0x60 [Thu Feb 10 125906 2022] kasan_report.cold+0x7d/0x117 [Thu Feb 10 125906 2022] ? rcu_cblist_dequeue+0x32/0x60 [Thu Feb 10 125906 2022] __asan_load8+0x86/0xa0 [Thu Feb 10 125906 2022] rcu_cblist_dequeue+0x32/0x60 [Thu Feb 10 125906 2022] rcu_core+0x547/0xca0 [Thu Feb 10 125906 2022] ? call_rcu+0x3c0/0x3c0 [Thu Feb 10 125906 2022] ? __this_cpu_preempt_check+0x13/0x20 [Thu Feb",
    "keyphrases": {
        "rootcause": "double free race",
        "weakness": "",
        "impact": "use-after-free",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "cifs_get_root()"
    }
}
