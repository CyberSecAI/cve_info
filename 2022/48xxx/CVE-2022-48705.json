{
    "cveId": "CVE-2022-48705",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedwifi mt76 mt7921e fix crash in chip reset failIn case of drv own fail in reset, we may need to run mac_reset severaltimes. The sequence would trigger system crash as the log below.Because we do not re-enable/schedule tx_napi before disable it again,the process would keep waiting for state change in napi_diable(). Toavoid the problem and keep status synchronize for each run, goto finalresource handling if drv own failed.[ 5857.353423] mt7921e 00003b00.0 driver own failed[ 5858.433427] mt7921e 00003b00.0 Timeout for driver own[ 5859.633430] mt7921e 00003b00.0 driver own failed[ 5859.633444] ------------[ cut here ]------------[ 5859.633446] WARNING CPU 6 at kernel/kthread.c659 kthread_park+0x11d[ 5859.633717] Workqueue mt76 mt7921_mac_reset_work [mt7921_common][ 5859.633728] RIP 0010kthread_park+0x11d/0x150[ 5859.633736] RSP 0018ffff8881b676fc68 EFLAGS 00010202......[ 5859.633766] Call Trace[ 5859.633768] [ 5859.633771] mt7921e_mac_reset+0x176/0x6f0 [mt7921e][ 5859.633778] mt7921_mac_reset_work+0x184/0x3a0 [mt7921_common][ 5859.633785] ? mt7921_mac_set_timing+0x520/0x520 [mt7921_common][ 5859.633794] ? __kasan_check_read+0x11/0x20[ 5859.633802] process_one_work+0x7ee/0x1320[ 5859.633810] worker_thread+0x53c/0x1240[ 5859.633818] kthread+0x2b8/0x370[ 5859.633824] ? process_one_work+0x1320/0x1320[ 5859.633828] ? kthread_complete_and_exit+0x30/0x30[ 5859.633834] ret_from_fork+0x1f/0x30[ 5859.633842]",
    "keyphrases": {
        "rootcause": "The system crashes because the tx_napi is not re-enabled/scheduled before being disabled again during multiple mac_reset attempts after a driver own failure.",
        "weakness": "The driver fails to properly manage the tx_napi state during repeated mac_reset attempts, leading to a deadlock.",
        "impact": "System crash",
        "vector": "The vulnerability is triggered when a driver fails to acquire ownership, causing repeated mac resets.",
        "attacker": "Not applicable",
        "product": "Linux Kernel",
        "version": "Not specified",
        "component": "mt76 mt7921e wifi driver"
    }
}
