{
    "cveId": "CVE-2022-48631",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ext4 fix bug in extents parsing when eh_entries == 0 and eh_depth > 0 When walking through an inode extents, the ext4_ext_binsearch_idx() function assumes that the extent header has been previously validated. However, there are no checks that verify that the number of entries (eh->eh_entries) is non-zero when depth is > 0. And this will lead to problems because the EXT_FIRST_INDEX() and EXT_LAST_INDEX() will return garbage and result in this [ 135.245946] ------------[ cut here ]------------ [ 135.247579] kernel BUG at fs/ext4/extents.c2258! [ 135.249045] invalid opcode 0000 [#1] PREEMPT SMP [ 135.250320] CPU 2 PID 238 Comm tmp118 Not tainted 5.19.0-rc8+ #4 [ 135.252067] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.15.0-0-g2dd4b9b-rebuilt.opensuse.org 04/01/2014 [ 135.255065] RIP 0010ext4_ext_map_blocks+0xc20/0xcb0 [ 135.256475] Code [ 135.261433] RSP 0018ffffc900005939f8 EFLAGS 00010246 [ 135.262847] RAX 0000000000000024 RBX ffffc90000593b70 RCX 0000000000000023 [ 135.264765] RDX ffff8880038e5f10 RSI 0000000000000003 RDI ffff8880046e922c [ 135.266670] RBP ffff8880046e9348 R08 0000000000000001 R09 ffff888002ca580c [ 135.268576] R10 0000000000002602 R11 0000000000000000 R12 0000000000000024 [ 135.270477] R13 0000000000000000 R14 0000000000000024 R15 0000000000000000 [ 135.272394] FS 00007fdabdc56740(0000) GSffff88807dd00000(0000) knlGS0000",
    "keyphrases": {
        "rootcause": "improper validation of eh_entries",
        "weakness": "out-of-bounds read",
        "impact": "kernel BUG",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "ext4 fix bug in extents parsing"
    }
}
