{
    "cveId": "CVE-2022-48956",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ipv6 avoid use-after-free in ip6_fragment() Blamed commit claimed rcu_read_lock() was held by ip6_fragment() callers. It seems to not be always true, at least for UDP stack. syzbot reported BUG KASAN use-after-free in ip6_dst_idev include/net/ip6_fib.h245 [inline] BUG KASAN use-after-free in ip6_fragment+0x2724/0x2770 net/ipv6/ip6_output.c951 Read of size 8 at addr ffff88801d403e80 by task syz-executor.3/7618 CPU 1 PID 7618 Comm syz-executor.3 Not tainted 6.1.0-rc6-syzkaller-00012-g4312098baf37 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 10/26/2022 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xd1/0x138 lib/dump_stack.c106 print_address_description mm/kasan/report.c284 [inline] print_report+0x15e/0x45d mm/kasan/report.c395 kasan_report+0xbf/0x1f0 mm/kasan/report.c495 ip6_dst_idev include/net/ip6_fib.h245 [inline] ip6_fragment+0x2724/0x2770 net/ipv6/ip6_output.c951 __ip6_finish_output net/ipv6/ip6_output.c193 [inline] ip6_finish_output+0x9a3/0x1170 net/ipv6/ip6_output.c206 NF_HOOK_COND include/linux/netfilter.h291 [inline] ip6_output+0x1f1/0x540 net/ipv6/ip6_output.c227 dst_output include/net/dst.h445 [inline] ip6_local_out+0xb3/0x1a0 net/ipv6/output_core.c161 ip6_send_skb+0xbb/0x340 net/ipv6/ip6_output.c1966 udp_v6_send_skb+0x82a/0x18a0 net/ipv6/udp.c1286 udp_v6_push_pending_frames+0x140/0x200"
}
