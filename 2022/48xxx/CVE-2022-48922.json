{
  "cveId": "CVE-2022-48922",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved riscv fix oops caused by irqsoff latency tracer The trace_hardirqs_{on,off}() require the caller to setup frame pointer properly. This because these two functions use macro CALLER_ADDR1 (aka. __builtin_return_address(1)) to acquire caller info. If the $fp is used for other purpose, the code generated this macro (as below) could trigger memory access fault. 0xffffffff8011510e ld a1,-16(s0) 0xffffffff80115112 ld s2,-8(a1) # <-- paging fault here The oops message during booting if compiled with irqoff tracer enabled [ 0.039615][ T0] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000f8 [ 0.041925][ T0] Oops [#1] [ 0.042063][ T0] Modules linked in [ 0.042864][ T0] CPU 0 PID 0 Comm swapper/0 Not tainted 5.17.0-rc1-00233-g9a20c48d1ed2 #29 [ 0.043568][ T0] Hardware name riscv-virtio,qemu (DT) [ 0.044343][ T0] epc trace_hardirqs_on+0x56/0xe2 [ 0.044601][ T0] ra restore_all+0x12/0x6e [ 0.044721][ T0] epc ffffffff80126a5c ra ffffffff80003b94 sp ffffffff81403db0 [ 0.044801][ T0] gp ffffffff8163acd8 tp ffffffff81414880 t0 0000000000000020 [ 0.044882][ T0] t1 0098968000000000 t2 0000000000000000 s0 ffffffff81403de0 [ 0.044967][ T0] s1 0000000000000000 a0 0000000000000001 a1 0000000000000100 [ 0.045046][ T0] a2 0000000000000000 a3 000",
  "keyphrases": {
    "rootcause": "improper frame pointer setup",
    "weakness": "NULL pointer dereference",
    "impact": [
      "memory access fault",
      "oops"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": [
      "trace_hardirqs_{on",
      "off}() functions"
    ]
  },
  "mitreTechnicalImpacts": []
}