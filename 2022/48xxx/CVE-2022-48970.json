{
    "cveId": "CVE-2022-48970",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved af_unix Get user_ns from in_skb in unix_diag_get_exact(). Wei Chen reported a NULL deref in sk_user_ns() [0][1], and Paolo diagnosed the root cause in unix_diag_get_exact(), the newly allocated skb does not have sk. [2] We must get the user_ns from the NETLINK_CB(in_skb).sk and pass it to sk_diag_fill(). [0] BUG kernel NULL pointer dereference, address 0000000000000270 #PF supervisor read access in kernel mode #PF error_code(0x0000) - not-present page PGD 12bbce067 P4D 12bbce067 PUD 12bc40067 PMD 0 Oops 0000 [#1] PREEMPT SMP CPU 0 PID 27942 Comm syz-executor.0 Not tainted 6.1.0-rc5-next-20221118 #2 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.13.0-48-gd9c812dda519-prebuilt.qemu.org 04/01/2014 RIP 0010sk_user_ns include/net/sock.h920 [inline] RIP 0010sk_diag_dump_uid net/unix/diag.c119 [inline] RIP 0010sk_diag_fill+0x77d/0x890 net/unix/diag.c170 Code 89 ef e8 66 d4 2d fd c7 44 24 40 00 00 00 00 49 8d 7c 24 18 e8 54 d7 2d fd 49 8b 5c 24 18 48 8d bb 70 02 00 00 e8 43 d7 2d fd 8b 9b 70 02 00 00 48 8d 7b 10 e8 33 d7 2d fd 48 8b 5b 10 48 8d RSP 0018ffffc90000d67968 EFLAGS 00010246 RAX ffff88812badaa48 RBX 0000000000000000 RCX ffffffff840d481d RDX 0000000000000465 RSI 0000000000000000 RDI 0000000000000270 RBP ffffc90000d679a8 R08 0000000000000277 R09 0000000000000000 R10 0001ffffffffffff R11 0001c90000d679a8 R12 ffff88812ac03800 R13 ffff88812c87c400",
    "keyphrases": {
        "rootcause": "NULL deref",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "af_unix Get user_ns from in_skb in unix_diag_get_exact()"
    }
}
