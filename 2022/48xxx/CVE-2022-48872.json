{
    "cveId": "CVE-2022-48872",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved misc fastrpc Fix use-after-free race condition for maps It is possible that in between calling fastrpc_map_get() until map->fl->lock is taken in fastrpc_free_map(), another thread can call fastrpc_map_lookup() and get a reference to a map that is about to be deleted. Rewrite fastrpc_map_get() to only increase the reference count of a map if its non-zero. Propagate this to callers so they can know if a map is about to be deleted. Fixes this warning refcount_t addition on 0 use-after-free. WARNING CPU 5 PID 10100 at lib/refcount.c25 refcount_warn_saturate ... Call trace refcount_warn_saturate [fastrpc_map_get inlined] [fastrpc_map_lookup inlined] fastrpc_map_create fastrpc_internal_invoke fastrpc_device_ioctl __arm64_sys_ioctl invoke_syscall",
    "keyphrases": {
        "rootcause": "use-after-free race condition",
        "weakness": "",
        "impact": "delete map",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "misc fastrpc"
    }
}
