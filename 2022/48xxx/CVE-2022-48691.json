{
    "cveId": "CVE-2022-48691",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvednetfilter nf_tables clean up hook list when offload flags check failssplice back the hook list so nft_chain_release_hook() has a chance torelease the hooks.BUG memory leakunreferenced object 0xffff88810180b100 (size 96) comm syz-executor133, pid 3619, jiffies 4294945714 (age 12.690s) hex dump (first 32 bytes) 28 64 23 02 81 88 ff ff 28 64 23 02 81 88 ff ff (d#.....(d#..... 90 a8 aa 83 ff ff ff ff 00 00 b5 0f 81 88 ff ff ................ backtrace [] kmalloc include/linux/slab.h600 [inline] [] nft_netdev_hook_alloc+0x3b/0xc0 net/netfilter/nf_tables_api.c1901 [] nft_chain_parse_netdev net/netfilter/nf_tables_api.c1998 [inline] [] nft_chain_parse_hook+0x33a/0x530 net/netfilter/nf_tables_api.c2073 [] nf_tables_addchain.constprop.0+0x10b/0x950 net/netfilter/nf_tables_api.c2218 [] nf_tables_newchain+0xa8b/0xc60 net/netfilter/nf_tables_api.c2593 [] nfnetlink_rcv_batch+0xa46/0xd20 net/netfilter/nfnetlink.c517 [] nfnetlink_rcv_skb_batch net/netfilter/nfnetlink.c638 [inline] [] nfnetlink_rcv+0x1f9/0x220 net/netfilter/nfnetlink.c656 [] netlink_unicast_kernel net/netlink/af_netlink.c1319 [inline] [] netlink_unicast+0x397/0x4c0 net/netlink/af_netlink.c1345 [] netlink_sendmsg+0x396/0x710 net/netlink/af_netlink.c1921 [] sock_sendmsg_nosec net/socket.c714 [inline] [] sock_sendmsg+0x56/0x80 net/socket.c734 [] ____sys_sendmsg+0x36c/0x390 net/socket.c2482 [] ___sys_sendmsg+0xa8/0x110 net/socket.c2536 [] __sys_sendmsg+0x88/0x100 net/socket.c2565 [] do_syscall_x64 arch/x86/entry/common.c50 [inline] [] do_syscall_64+0x35/0xb0 arch/x86/entry/common.c80 [] entry_SYSCALL_64_after_hwframe+0x63/0xcd",
    "keyphrases": {
        "rootcause": "The netfilter nf_tables code fails to properly clean up the hook list when offload flags check fails, leading to a memory leak.",
        "weakness": "Improper resource cleanup in the netfilter nf_tables module.",
        "impact": "Memory leak of an unreferenced object.",
        "vector": "The vulnerability is triggered through the netlink interface when adding a chain with netdev hooks.",
        "attacker": "An attacker can trigger the vulnerability by sending crafted netlink messages.",
        "product": "Linux Kernel",
        "version": "Not specified in the text provided",
        "component": "netfilter nf_tables"
    }
}
