{
  "cveId": "CVE-2022-48785",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved ipv6 mcast use rcu-safe version of ipv6_get_lladdr() Some time ago 8965779d2c0e (ipv6,mcast always hold idev->lock before mca_lock) switched ipv6_get_lladdr() to __ipv6_get_lladdr(), which is rcu-unsafe version. That was OK, because idev->lock was held for these codepaths. In 88e2ca308094 (mld convert ifmcaddr6 to RCU) these external locks were removed, so we probably need to restore the original rcu-safe call. Otherwise, we occasionally get a machine crashed/stalled with the following in dmesg [ 3405.966610][T230589] general protection fault, probably for non-canonical address 0xdead00000000008c 0000 [#1] SMP NOPTI [ 3405.982083][T230589] CPU 44 PID 230589 Comm kworker/443 Tainted G O 5.15.19-cloudflare-2022.2.1 #1 [ 3405.998061][T230589] Hardware name SUPA-COOL-SERV [ 3406.009552][T230589] Workqueue mld mld_ifc_work [ 3406.017224][T230589] RIP 0010__ipv6_get_lladdr+0x34/0x60 [ 3406.025780][T230589] Code 57 10 48 83 c7 08 48 89 e5 48 39 d7 74 3e 48 8d 82 38 ff ff ff eb 13 48 8b 90 d0 00 00 00 48 8d 82 38 ff ff ff 48 39 d7 74 22 83 78 32 20 77 1b 75 e4 89 ca 23 50 2c 75 dd 48 8b 50 08 48 8b [ 3406.055748][T230589] RSP 0018ffff94e4b3fc3d10 EFLAGS 00010202 [ 3406.065617][T230589] RAX dead00000000005a RBX ffff94e4b3fc3d30 RCX 0000000000000040 [ 3406.077477][T230589] RDX dead000000000122 RSI ffff94e4b3fc3d30 RDI ffff8c3a31431008 [ 3406.089389][T230589] RBP ff",
  "keyphrases": {
    "rootcause": "use rcu-unsafe version of ipv6_get_lladdr()",
    "weakness": "",
    "impact": [
      "general protection fault",
      "machine crashed/stalled"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": ""
  },
  "mitreTechnicalImpacts": []
}