{
  "cveId": "CVE-2022-48818",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved net dsa mv88e6xxx dont use devres for mdiobus As explained in commits 74b6d7d13307 (net dsa realtek register the MDIO bus under devres) 5135e96a3dd2 (net dsa dont allocate the slave_mii_bus using devres) mdiobus_free() will panic when called from devm_mdiobus_free() remove on ->shutdown) do not apply. But there is one more which applies here. If the DSA master itself is on a bus that calls ->remove from ->shutdown (like dpaa2-eth, which is on the fsl-mc bus), there is a device link between the switch and the DSA master, and device_links_unbind_consumers() will unbind the Marvell switch driver on shutdown. systemd-shutdown[1] Powering off. mv88e6085 0x0000000008b9600000 sw_gl0 Link is Down fsl-mc dpbp.9 Removing from iommu group 7 fsl-mc dpbp.8 Removing from iommu group 7 ------------[ cut here ]------------ kernel BUG at drivers/net/phy/mdio_bus.c677! Internal error Oops - BUG 0 [#1] PREEMPT SMP Modules linked in CPU 0 PID 1 Comm systemd-shutdow Not tainted 5.16.5-00040-gdc05f73788e5 #15 pc mdiobus_free+0x44/0x50 lr devm_mdiobus_free+0x10/0x20 Call trace mdiobus_free+0x44/0x50 devm_mdiobus_free+0x10/0x20 devres_release_all+0xa0/0x100 __de",
  "keyphrases": {
    "rootcause": "",
    "weakness": "devres is not used to allocate mdiobus",
    "impact": [
      "Oops",
      "kernel BUG",
      "panic"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "5.16.5",
    "component": "net dsa mv88e6xxx"
  },
  "mitreTechnicalImpacts": []
}