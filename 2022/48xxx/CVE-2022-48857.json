{
    "cveId": "CVE-2022-48857",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedNFC port100 fix use-after-free in port100_send_completeSyzbot reported UAF in port100_send_complete(). The root case is inmissing usb_kill_urb() calls on error handling path of ->probe function.port100_send_complete() accesses devm allocated memory which will befreed on probe failure. We should kill this urbs before returning anerror from probe function to prevent reported use-after-freeFail logBUG KASAN use-after-free in port100_send_complete+0x16e/0x1a0 drivers/nfc/port100.c935Read of size 1 at addr ffff88801bb59540 by task ksoftirqd/2/26...Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c106 print_address_description.constprop.0.cold+0x8d/0x303 mm/kasan/report.c255 __kasan_report mm/kasan/report.c442 [inline] kasan_report.cold+0x83/0xdf mm/kasan/report.c459 port100_send_complete+0x16e/0x1a0 drivers/nfc/port100.c935 __usb_hcd_giveback_urb+0x2b0/0x5c0 drivers/usb/core/hcd.c1670...Allocated by task 1255 kasan_save_stack+0x1e/0x40 mm/kasan/common.c38 kasan_set_track mm/kasan/common.c45 [inline] set_alloc_info mm/kasan/common.c436 [inline] ____kasan_kmalloc mm/kasan/common.c515 [inline] ____kasan_kmalloc mm/kasan/common.c474 [inline] __kasan_kmalloc+0xa6/0xd0 mm/kasan/common.c524 alloc_dr drivers/base/devres.c116 [inline] devm_kmalloc+0x96/0x1d0 drivers/base/devres.c823 devm_kzalloc include/linux/device.h209 [inline] port100_probe+0x8a/0x1320 drivers/nfc/port100.c1502Freed by task 1255 kasan_save_stack+0x1e/0x40 mm/kasan/common.c38 kasan_set_track+0x21/0x30 mm/kasan/common.c45 kasan_set_free_info+0x20/0x30 mm/kasan/generic.c370 ____kasan_slab_free mm/kasan/common.c366 [inline] ____kasan_slab_free+0xff/0x140 mm/kasan/common.c328 kasan_slab_free include/linux/kasan.h236 [inline] __cache_free mm/slab.c3437 [inline] kfree+0xf8/0x2b0 mm/slab.c3794 release_nodes+0x112/0x1a0 drivers/base/devres.c501 devres_release_all+0x114/0x190 drivers/base/devres.c530 really_probe+0x626/0xcc0 drivers/base/dd.c670",
    "keyphrases": {
        "rootcause": "Missing usb_kill_urb() calls on error handling path of ->probe function.",
        "weakness": "Use-after-free",
        "impact": "Memory corruption",
        "vector": "usb device insertion",
        "attacker": "local attacker",
        "product": "Linux Kernel",
        "version": "not specified",
        "component": "drivers/nfc/port100.c"
    }
}
