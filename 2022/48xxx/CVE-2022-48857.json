{
    "cveId": "CVE-2022-48857",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved NFC port100 fix use-after-free in port100_send_complete Syzbot reported UAF in port100_send_complete(). The root case is in missing usb_kill_urb() calls on error handling path of ->probe function. port100_send_complete() accesses devm allocated memory which will be freed on probe failure. We should kill this urbs before returning an error from probe function to prevent reported use-after-free Fail log BUG KASAN use-after-free in port100_send_complete+0x16e/0x1a0 drivers/nfc/port100.c935 Read of size 1 at addr ffff88801bb59540 by task ksoftirqd/2/26 ... Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c106 print_address_description.constprop.0.cold+0x8d/0x303 mm/kasan/report.c255 __kasan_report mm/kasan/report.c442 [inline] kasan_report.cold+0x83/0xdf mm/kasan/report.c459 port100_send_complete+0x16e/0x1a0 drivers/nfc/port100.c935 __usb_hcd_giveback_urb+0x2b0/0x5c0 drivers/usb/core/hcd.c1670 ... Allocated by task 1255 kasan_save_stack+0x1e/0x40 mm/kasan/common.c38 kasan_set_track mm/kasan/common.c45 [inline] set_alloc_info mm/kasan/common.c436 [inline] ____kasan_kmalloc mm/kasan/common.c515 [inline] ____kasan_kmalloc mm/kasan/common.c474 [inline] __kasan_kmalloc+0xa6/0xd0 mm/kasan/common.c524 alloc_dr drivers/base/devres.c116 [inline] devm_kmalloc+0x96/0x1d0 drivers/base/devres.c823 devm_kzalloc include/linux/devic"
}
