{
    "cveId": "CVE-2022-48662",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved drm/i915/gem Really move i915_gem_context.link under ref protection i915_perf assumes that it can use the i915_gem_context reference to protect its i915->gem.contexts.list iteration. However, this requires that we do not remove the context from the list until after we drop the final reference and release the struct. If, as currently, we remove the context from the list during context_close(), the link.next pointer may be poisoned while we are holding the context reference and cause a GPF [ 4070.573157] i915 00000002.0 [drmi915_perf_open_ioctl [i915]] filtering on ctx_id=0x1fffff ctx_id_mask=0x1fffff [ 4070.574881] general protection fault, probably for non-canonical address 0xdead000000000100 0000 [#1] PREEMPT SMP [ 4070.574897] CPU 1 PID 284392 Comm amd_performance Tainted G E 5.17.9 #180 [ 4070.574903] Hardware name Intel Corporation NUC7i5BNK/NUC7i5BNB, BIOS BNKBL357.86A.0052.2017.0918.1346 09/18/2017 [ 4070.574907] RIP 0010oa_configure_all_contexts.isra.0+0x222/0x350 [i915] [ 4070.574982] Code 08 e8 32 6e 10 e1 4d 8b 6d 50 b8 ff ff ff ff 49 83 ed 50 f0 41 0f c1 04 24 83 f8 01 0f 84 e3 00 00 00 85 c0 0f 8e fa 00 00 00 8b 45 50 48 8d 70 b0 49 8d 45 50 48 39 44 24 10 0f 85 34 fe ff [ 4070.574990] RSP 0018ffffc90002077b78 EFLAGS 00010202 [ 4070.574995] RAX 0000000000000002 RBX 0000000000000002 RCX 0000000000000000 [ 4070.575000] RDX 0000000000000001 RSI ffffc90002",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "denial of service",
        "vector": "poison the link.next pointer",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "drm/i915/gem"
    }
}
