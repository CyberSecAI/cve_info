{
    "cveId": "CVE-2022-48726",
    "version": "1.0.0",
    "timestamp": "2024-12-18T22:42:50.929578+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedRDMA/ucma Protect mc during concurrent multicast leavesPartially revert the commit mentioned in the Fixes line to make sure thatallocation and erasing multicast struct are locked. BUG KASAN use-after-free in ucma_cleanup_multicast drivers/infiniband/core/ucma.c491 [inline] BUG KASAN use-after-free in ucma_destroy_private_ctx+0x914/0xb70 drivers/infiniband/core/ucma.c579 Read of size 8 at addr ffff88801bb74b00 by task syz-executor.1/25529 CPU 0 PID 25529 Comm syz-executor.1 Not tainted 5.16.0-rc7-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c106 print_address_description.constprop.0.cold+0x8d/0x320 mm/kasan/report.c247 __kasan_report mm/kasan/report.c433 [inline] kasan_report.cold+0x83/0xdf mm/kasan/report.c450 ucma_cleanup_multicast drivers/infiniband/core/ucma.c491 [inline] ucma_destroy_private_ctx+0x914/0xb70 drivers/infiniband/core/ucma.c579 ucma_destroy_id+0x1e6/0x280 drivers/infiniband/core/ucma.c614 ucma_write+0x25c/0x350 drivers/infiniband/core/ucma.c1732 vfs_write+0x28e/0xae0 fs/read_write.c588 ksys_write+0x1ee/0x250 fs/read_write.c643 do_syscall_x64 arch/x86/entry/common.c50 [inline] do_syscall_64+0x35/0xb0 arch/x86/entry/common.c80 entry_SYSCALL_64_after_hwframe+0x44/0xaeCurrently the xarray search can touch a concurrently freeing mc as thexa_for_each() is not surrounded by any lock. Rather than hold the lock fora full scan hold it only for the effected items, which is usually an emptylist.",
    "keyphrases": {
        "rootcause": "concurrent access to ucma_cleanup_multicast+0x914/0xb70",
        "weakness": "use-after-free",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "5.16.0-rc7-syzkaller",
        "component": "RDMA/ucma Protect mc"
    }
}
