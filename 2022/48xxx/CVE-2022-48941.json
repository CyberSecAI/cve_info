{
  "cveId": "CVE-2022-48941",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved ice fix concurrent reset and removal of VFs Commit c503e63200c6 (ice Stop processing VF messages during teardown) introduced a driver state flag, ICE_VF_DEINIT_IN_PROGRESS, which is intended to prevent some issues with concurrently handling messages from VFs while tearing down the VFs. This change was motivated by crashes caused while tearing down and bringing up VFs in rapid succession. It turns out that the fix actually introduces issues with the VF driver caused because the PF no longer responds to any messages sent by the VF during its .remove routine. This results in the VF potentially removing its DMA memory before the PF has shut down the device queues. Additionally, the fix doesnt actually resolve concurrency issues within the ice driver. It is possible for a VF to initiate a reset just prior to the ice driver removing VFs. This can result in the remove task concurrently operating while the VF is being reset. This results in similar memory corruption and panics purportedly fixed by that commit. Fix this concurrency at its root by protecting both the reset and removal flows using the existing VF cfg_lock. This ensures that we cannot remove the VF while any outstanding critical tasks such as a virtchnl message or a reset are occurring. This locking change also fixes the root cause originally fixed by commit c503e63200c6 (ice Stop processing VF messages during teardown), so we can simply r",
  "keyphrases": {
    "rootcause": "concurrent access to shared resource",
    "weakness": "memory corruption",
    "impact": "memory corruption and panics",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "ice driver"
  },
  "mitreTechnicalImpacts": []
}