{
    "cveId": "CVE-2022-41678",
    "version": "1.0.0",
    "timestamp": "2024-12-17T08:36:27.567979+00:00",
    "description": "Once an user is authenticated on Jolokia, he can potentially trigger arbitrary code execution.In details, in ActiveMQ configurations, jetty allowsorg.jolokia.http.AgentServlet to handler request to /api/jolokiaorg.jolokia.http.HttpRequestHandler#handlePostRequest is able tocreate JmxRequest through JSONObject. And calls toorg.jolokia.http.HttpRequestHandler#executeRequest.Into deeper calling stacks,org.jolokia.handler.ExecHandler#doHandleRequest can be invokedthrough refection. This could lead to RCE through viavarious mbeans. One example is unrestricted deserialization in jdk.management.jfr.FlightRecorderMXBeanImpl which exists on Java version above 11.1 Call newRecording.2 Call setConfiguration. And a webshell data hides in it.3 Call startRecording.4 Call copyTo method. The webshell will be written to a .jsp file.The mitigation is to restrict (by default) the actions authorized on Jolokia, or disable Jolokia.A more restrictive Jolokia configuration has been defined in default ActiveMQ distribution. We encourage users to upgrade to ActiveMQ distributions version including updated Jolokia configuration 5.16.6, 5.17.4, 5.18.0, 6.0.0.",
    "keyphrases": {
        "rootcause": "unrestricted deserialization",
        "weakness": "",
        "impact": "remote code execution",
        "vector": "org.jolokia.http.AgentServlet handler in ActiveMQ jetty",
        "attacker": "authenticated user",
        "product": "ActiveMQ",
        "version": "",
        "component": ""
    }
}
