{
    "cveId": "CVE-2021-47449",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ice fix locking for Tx timestamp tracking flush Commit 4dd0d5c33c3e (ice add lock around Tx timestamp tracker flush) added a lock around the Tx timestamp tracker flow which is used to cleanup any left over SKBs and prepare for device removal. This lock is problematic because it is being held around a call to ice_clear_phy_tstamp. The clear function takes a mutex to send a PHY write command to firmware. This could lead to a deadlock if the mutex actually sleeps, and causes the following warning on a kernel with preemption debugging enabled [ 715.419426] BUG sleeping function called from invalid context at kernel/locking/mutex.c573 [ 715.427900] in_atomic() 1, irqs_disabled() 0, non_block 0, pid 3100, name rmmod [ 715.435652] INFO lockdep is turned off. [ 715.439591] Preemption disabled at [ 715.439594] [] 0x0 [ 715.446678] CPU 52 PID 3100 Comm rmmod Tainted G W OE 5.15.0-rc4+ #42 bdd7ec3018e725f159ca0d372ce8c2c0e784891c [ 715.458058] Hardware name Intel Corporation S2600STQ/S2600STQ, BIOS SE5C620.86B.02.01.0010.010620200716 01/06/2020 [ 715.468483] Call Trace [ 715.470940] dump_stack_lvl+0x6a/0x9a [ 715.474613] ___might_sleep.cold+0x224/0x26a [ 715.478895] __mutex_lock+0xb3/0x1440 [ 715.482569] ? stack_depot_save+0x378/0x500 [ 715.486763] ? ice_sq_send_cmd+0x78/0x14c0 [ice 9a7e1ec00971c89ecd3fe0d4dc7da2b3786a421d] [ 715.494979] ? kfree+0"
}
