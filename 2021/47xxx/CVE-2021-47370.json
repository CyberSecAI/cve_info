{
    "cveId": "CVE-2021-47370",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mptcp ensure tx skbs always have the MPTCP ext Due to signed/unsigned comparison, the expression info->size_goal - skb->len > 0 evaluates to true when the size goal is smaller than the skb size. That results in lack of tx cache refill, so that the skb allocated by the core TCP code lacks the required MPTCP skb extensions. Due to the above, syzbot is able to trigger the following WARN_ON() WARNING CPU 1 PID 810 at net/mptcp/protocol.c1366 mptcp_sendmsg_frag+0x1362/0x1bc0 net/mptcp/protocol.c1366 Modules linked in CPU 1 PID 810 Comm syz-executor.4 Not tainted 5.14.0-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011 RIP 0010mptcp_sendmsg_frag+0x1362/0x1bc0 net/mptcp/protocol.c1366 Code ff 4c 8b 74 24 50 48 8b 5c 24 58 e9 0f fb ff ff e8 13 44 8b f8 4c 89 e7 45 31 ed e8 98 57 2e fe e9 81 f4 ff ff e8 fe 43 8b f8 0b 41 bd ea ff ff ff e9 6f f4 ff ff 4c 89 e7 e8 b9 8e d2 f8 e9 RSP 0018ffffc9000531f6a0 EFLAGS 00010216 RAX 000000000000697f RBX 0000000000000000 RCX ffffc90012107000 RDX 0000000000040000 RSI ffffffff88eac9e2 RDI 0000000000000003 RBP ffff888078b15780 R08 0000000000000000 R09 0000000000000000 R10 ffffffff88eac017 R11 0000000000000000 R12 ffff88801de0a280 R13 0000000000006b58 R14 ffff888066278280 R15 ffff88803c2fe9c0 FS 00007fd9f866e700(0000) GSffff8880b9d00000(0000) knlGS0000000000000000 CS 0010 DS 0000 E"
}
