{
    "cveId": "CVE-2021-47578",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved scsi scsi_debug Dont call kcalloc() if size arg is zero If the size arg to kcalloc() is zero, it returns ZERO_SIZE_PTR. Because of that, for a following NULL pointer check to work on the returned pointer, kcalloc() must not be called with the size arg equal to zero. Return early without error before the kcalloc() call if size arg is zero. BUG KASAN null-ptr-deref in memcpy include/linux/fortify-string.h191 [inline] BUG KASAN null-ptr-deref in sg_copy_buffer+0x138/0x240 lib/scatterlist.c974 Write of size 4 at addr 0000000000000010 by task syz-executor.1/22789 CPU 1 PID 22789 Comm syz-executor.1 Not tainted 5.15.0-syzk #1 Hardware name Red Hat KVM, BIOS 1.13.0-2 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0x89/0xb5 lib/dump_stack.c106 __kasan_report mm/kasan/report.c446 [inline] kasan_report.cold.14+0x112/0x117 mm/kasan/report.c459 check_region_inline mm/kasan/generic.c183 [inline] kasan_check_range+0x1a3/0x210 mm/kasan/generic.c189 memcpy+0x3b/0x60 mm/kasan/shadow.c66 memcpy include/linux/fortify-string.h191 [inline] sg_copy_buffer+0x138/0x240 lib/scatterlist.c974 do_dout_fetch drivers/scsi/scsi_debug.c2954 [inline] do_dout_fetch drivers/scsi/scsi_debug.c2946 [inline] resp_verify+0x49e/0x930 drivers/scsi/scsi_debug.c4276 schedule_resp+0x4d8/0x1a70 drivers/scsi/scsi_debug.c5478 scsi_debug_queuecommand+0x8c9/0x1ec0 drivers/scsi/scsi_debug.c753"
}
