{
  "cveId": "CVE-2021-47400",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved net hns3 do not allow call hns3_nic_net_open repeatedly hns3_nic_net_open() is not allowed to called repeatly, but there is no checking for this. When doing device reset and setup tc concurrently, there is a small oppotunity to call hns3_nic_net_open repeatedly, and cause kernel bug by calling napi_enable twice. The calltrace information is like below [ 3078.222780] ------------[ cut here ]------------ [ 3078.230255] kernel BUG at net/core/dev.c6991! [ 3078.236224] Internal error Oops - BUG 0 [#1] PREEMPT SMP [ 3078.243431] Modules linked in hns3 hclgevf hclge hnae3 vfio_iommu_type1 vfio_pci vfio_virqfd vfio pv680_mii(O) [ 3078.258880] CPU 0 PID 295 Comm kworker/u85 Tainted G O 5.14.0-rc4+ #1 [ 3078.269102] Hardware name , BIOS KpxxxFPGA 1P B600 V181 08/12/2021 [ 3078.276801] Workqueue hclge hclge_service_task [hclge] [ 3078.288774] pstate 60400009 (nZCv daif +PAN -UAO -TCO BTYPE=--) [ 3078.296168] pc napi_enable+0x80/0x84 tc qdisc sho[w 3d0e7v8 .e3t0h218 79] lr hns3_nic_net_open+0x138/0x510 [hns3] [ 3078.314771] sp ffff8000108abb20 [ 3078.319099] x29 ffff8000108abb20 x28 0000000000000000 x27 ffff0820a8490300 [ 3078.329121] x26 0000000000000001 x25 ffff08209cfc6200 x24 0000000000000000 [ 3078.339044] x23 ffff0820a8490300 x22 ffff08209cd76000 x21 ffff0820abfe3880 [ 3078.349018] x20 0000000000000000 x19 ffff08209cd76900 x18 0000000000000000 [ 3078.358620] x1",
  "keyphrases": {
    "rootcause": [
      "hns3_nic_net_open() is not allowed to called repeatly",
      "but there is no checking for this"
    ],
    "weakness": "",
    "impact": [
      "Oops",
      "kernel BUG"
    ],
    "vector": "calling hns3_nic_net_open repeatedly",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "net hns3"
  },
  "mitreTechnicalImpacts": []
}