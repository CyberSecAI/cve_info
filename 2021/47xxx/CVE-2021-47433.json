{
    "cveId": "CVE-2021-47433",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved btrfs fix abort logic in btrfs_replace_file_extents Error injection testing uncovered a case where wed end up with a corrupt file system with a missing extent in the middle of a file. This occurs because the if statement to decide if we should abort is wrong. The only way we would abort in this case is if we got a ret != -EOPNOTSUPP and we called from the file clone code. However the prealloc code uses this path too. Instead we need to abort if there is an error, and the only error we _dont_ abort on is -EOPNOTSUPP and only if we came from the clone file code.",
    "keyphrases": {
        "rootcause": "error injection testing",
        "weakness": "if statement to decide if we should abort is wrong",
        "impact": "corrupt file system",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "btrfs_replace_file_extents"
    }
}
