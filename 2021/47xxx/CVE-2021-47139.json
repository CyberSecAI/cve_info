{
  "cveId": "CVE-2021-47139",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved net hns3 put off calling register_netdev() until client initialize complete Currently, the netdevice is registered before client initializing complete. So there is a timewindow between netdevice available and usable. In this case, if user try to change the channel number or ring param, it may cause the hns3_set_rx_cpu_rmap() being called twice, and report bug. [47199.416502] hns3 00003500.0 eth1 set channels tqp_num=1, rxfh=0 [47199.430340] hns3 00003500.0 eth1 already uninitialized [47199.438554] hns3 00003500.0 rss changes from 4 to 1 [47199.511854] hns3 00003500.0 Channels changed, rss_size from 4 to 1, tqps from 4 to 1 [47200.163524] ------------[ cut here ]------------ [47200.171674] kernel BUG at lib/cpu_rmap.c142! [47200.177847] Internal error Oops - BUG 0 [#1] PREEMPT SMP [47200.185259] Modules linked in hclge(+) hns3(-) hns3_cae(O) hns_roce_hw_v2 hnae3 vfio_iommu_type1 vfio_pci vfio_virqfd vfio pv680_mii(O) [last unloaded hclge] [47200.205912] CPU 1 PID 8260 Comm ethtool Tainted G O 5.11.0-rc3+ #1 [47200.215601] Hardware name , xxxxxx 02/04/2021 [47200.223052] pstate 60400009 (nZCv daif +PAN -UAO -TCO BTYPE=--) [47200.230188] pc cpu_rmap_add+0x38/0x40 [47200.237472] lr irq_cpu_rmap_add+0x84/0x140 [47200.243291] sp ffff800010e93a30 [47200.247295] x29 ffff800010e93a30 x28 ffff082100584880 [47200.254155] x27 0000000000000000 x26 0000000000000000 [47",
  "keyphrases": {
    "rootcause": "netdevice is registered before client initializing complete",
    "weakness": "",
    "impact": [
      "Oops",
      "call hns3_set_rx_cpu_rmap() twice",
      "kernel BUG"
    ],
    "vector": "",
    "attacker": "user",
    "product": "Linux kernel",
    "version": "",
    "component": "net hns3"
  },
  "mitreTechnicalImpacts": []
}