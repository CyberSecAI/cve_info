{
    "cveId": "CVE-2021-47247",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/mlx5e Fix use-after-free of encap entry in neigh update handler Function mlx5e_rep_neigh_update() wasnt updated to accommodate rtnl lock removal from TC filter update path and properly handle concurrent encap entry insertion/deletion which can lead to following use-after-free [23827.464923] ================================================================== [23827.469446] BUG KASAN use-after-free in mlx5e_encap_take+0x72/0x140 [mlx5_core] [23827.470971] Read of size 4 at addr ffff8881d132228c by task kworker/u206/21635 [23827.472251] [23827.472615] CPU 9 PID 21635 Comm kworker/u206 Not tainted 5.13.0-rc3+ #5 [23827.473788] Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014 [23827.475639] Workqueue mlx5e mlx5e_rep_neigh_update [mlx5_core] [23827.476731] Call Trace [23827.477260] dump_stack+0xbb/0x107 [23827.477906] print_address_description.constprop.0+0x18/0x140 [23827.478896] ? mlx5e_encap_take+0x72/0x140 [mlx5_core] [23827.479879] ? mlx5e_encap_take+0x72/0x140 [mlx5_core] [23827.480905] kasan_report.cold+0x7c/0xd8 [23827.481701] ? mlx5e_encap_take+0x72/0x140 [mlx5_core] [23827.482744] kasan_check_range+0x145/0x1a0 [23827.493112] mlx5e_encap_take+0x72/0x140 [mlx5_core] [23827.494054] ? mlx5e_tc_tun_encap_info_equal_generic+0x140/0x140 [mlx5_core] [23827.495296] mlx5e_rep_neigh_update+0x41e/0x5e0 [mlx5_",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "use-after-free",
        "vector": "concurrent encap entry insertion/deletion",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net/mlx5e, mlx5e_rep_neigh_update()"
    }
}
