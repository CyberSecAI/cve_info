{
    "cveId": "CVE-2021-47219",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedscsi scsi_debug Fix out-of-bound read in resp_report_tgtpgs()The following issue was observed running syzkallerBUG KASAN slab-out-of-bounds in memcpy include/linux/string.h377 [inline]BUG KASAN slab-out-of-bounds in sg_copy_buffer+0x150/0x1c0 lib/scatterlist.c831Read of size 2132 at addr ffff8880aea95dc8 by task syz-executor.0/9815CPU 0 PID 9815 Comm syz-executor.0 Not tainted 4.19.202-00874-gfc0fe04215a9 #2Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014Call Trace __dump_stack lib/dump_stack.c77 [inline] dump_stack+0xe4/0x14a lib/dump_stack.c118 print_address_description+0x73/0x280 mm/kasan/report.c253 kasan_report_error mm/kasan/report.c352 [inline] kasan_report+0x272/0x370 mm/kasan/report.c410 memcpy+0x1f/0x50 mm/kasan/kasan.c302 memcpy include/linux/string.h377 [inline] sg_copy_buffer+0x150/0x1c0 lib/scatterlist.c831 fill_from_dev_buffer+0x14f/0x340 drivers/scsi/scsi_debug.c1021 resp_report_tgtpgs+0x5aa/0x770 drivers/scsi/scsi_debug.c1772 schedule_resp+0x464/0x12f0 drivers/scsi/scsi_debug.c4429 scsi_debug_queuecommand+0x467/0x1390 drivers/scsi/scsi_debug.c5835 scsi_dispatch_cmd+0x3fc/0x9b0 drivers/scsi/scsi_lib.c1896 scsi_request_fn+0x1042/0x1810 drivers/scsi/scsi_lib.c2034 __blk_run_queue_uncond block/blk-core.c464 [inline] __blk_run_queue+0x1a4/0x380 block/blk-core.c484 blk_execute_rq_nowait+0x1c2/0x2d0 block/blk-exec.c78 sg_common_write.isra.19+0xd74/0x1dc0 drivers/scsi/sg.c847 sg_write.part.23+0x6e0/0xd00 drivers/scsi/sg.c716 sg_write+0x64/0xa0 drivers/scsi/sg.c622 __vfs_write+0xed/0x690 fs/read_write.c485kill_bdevblock_device00000000e138492c vfs_write+0x184/0x4c0 fs/read_write.c549 ksys_write+0x107/0x240 fs/read_write.c599 do_syscall_64+0xc2/0x560 arch/x86/entry/common.c293 entry_SYSCALL_64_after_hwframe+0x49/0xbeWe get alen from command its type is int. If userspace passes a largelength we will get a negative alen.Switch n, alen, and rlen to u32.",
    "keyphrases": {
        "rootcause": "Integer overflow in the calculation of the length of the data to be copied, leading to an out-of-bounds read.",
        "weakness": "Improper input validation, specifically the use of a signed integer for length calculation which could lead to negative values.",
        "impact": "Out-of-bounds read, potentially causing a kernel crash or information disclosure.",
        "vector": "A malicious userspace application can provide a large length value in a SCSI command leading to the integer overflow.",
        "attacker": "Malicious userspace application.",
        "product": "Linux Kernel",
        "version": "4.19.202-00874-gfc0fe04215a9",
        "component": "scsi_debug driver"
    }
}
