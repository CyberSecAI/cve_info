{
    "cveId": "CVE-2021-47412",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved block dont call rq_qos_ops->done_bio if the bio isnt tracked rq_qos framework is only applied on request based driver, so 1) rq_qos_done_bio() neednt to be called for bio based driver 2) rq_qos_done_bio() neednt to be called for bio which isnt tracked, such as bios ended from error handling code. Especially in bio_endio() 1) request queue is referred via bio->bi_bdev->bd_disk->queue, which may be gone since request queue refcount may not be held in above two cases 2) q->rq_qos may be freed in blk_cleanup_queue() when calling into __rq_qos_done_bio() Fix the potential kernel panic by not calling rq_qos_ops->done_bio if the bio isnt tracked. This way is safe because both ioc_rqos_done_bio() and blkcg_iolatency_done_bio() are nop if the bio isnt tracked.",
    "keyphrases": {
        "rootcause": "request queue refcount may not be held, q->rq_qos may be freed",
        "weakness": "",
        "impact": "kernel panic",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "rq_qos framework"
    }
}
