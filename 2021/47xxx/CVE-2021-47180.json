{
    "cveId": "CVE-2021-47180",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedNFC nci fix memory leak in nci_allocate_devicenfcmrvl_disconnect fails to free the hci_dev field in struct nci_dev.Fix this by freeing hci_dev in nci_free_device.BUG memory leakunreferenced object 0xffff888111ea6800 (size 1024) comm kworker/10, pid 19, jiffies 4294942308 (age 13.580s) hex dump (first 32 bytes) 00 00 00 00 00 00 00 00 00 60 fd 0c 81 88 ff ff .........`...... 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ backtrace [] kmalloc include/linux/slab.h552 [inline] [] kzalloc include/linux/slab.h682 [inline] [] nci_hci_allocate+0x21/0xd0 net/nfc/nci/hci.c784 [] nci_allocate_device net/nfc/nci/core.c1170 [inline] [] nci_allocate_device+0x10b/0x160 net/nfc/nci/core.c1132 [] nfcmrvl_nci_register_dev+0x10a/0x1c0 drivers/nfc/nfcmrvl/main.c153 [] nfcmrvl_probe+0x223/0x290 drivers/nfc/nfcmrvl/usb.c345 [] usb_probe_interface+0x177/0x370 drivers/usb/core/driver.c396 [] really_probe+0x159/0x4a0 drivers/base/dd.c554 [] driver_probe_device+0x84/0x100 drivers/base/dd.c740 [] __device_attach_driver+0xee/0x110 drivers/base/dd.c846 [] bus_for_each_drv+0xb7/0x100 drivers/base/bus.c431 [] __device_attach+0x122/0x250 drivers/base/dd.c914 [] bus_probe_device+0xc6/0xe0 drivers/base/bus.c491 [] device_add+0x5be/0xc30 drivers/base/core.c3109 [] usb_set_configuration+0x9d9/0xb90 drivers/usb/core/message.c2164 [] usb_generic_driver_probe+0x8c/0xc0 drivers/usb/core/generic.c238 [] usb_probe_device+0x5c/0x140 drivers/usb/core/driver.c293 [] really_probe+0x159/0x4a0 drivers/base/dd.c554",
    "keyphrases": {
        "rootcause": "Memory leak due to not freeing the hci_dev field in struct nci_dev during disconnect.",
        "weakness": "Improper resource management; specifically, not freeing allocated memory.",
        "impact": "Memory leak, potentially leading to system instability or denial of service over time.",
        "vector": "The vulnerability occurs during the disconnection of an NFC device and is triggered through the function `nfcmrvl_disconnect`.",
        "attacker": "An attacker could trigger the vulnerability by repeatedly connecting and disconnecting the NFC device.",
        "product": "Linux Kernel",
        "version": "Not specified in the provided text, but present in affected versions.",
        "component": "NFC subsystem, specifically the `nci` and `nfcmrvl` drivers."
    }
}
