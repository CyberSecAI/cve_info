{
    "cveId": "CVE-2021-47594",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mptcp never allow the PM to close a listener subflow Currently, when deleting an endpoint the netlink PM treverses all the local MPTCP sockets, regardless of their status. If an MPTCP listener socket is bound to the IP matching the delete endpoint, the listener TCP socket will be closed. That is unexpected, the PM should only affect data subflows. Additionally, syzbot was able to trigger a NULL ptr dereference due to the above general protection fault, probably for non-canonical address 0xdffffc0000000003 0000 [#1] PREEMPT SMP KASAN KASAN null-ptr-deref in range [0x0000000000000018-0x000000000000001f] CPU 1 PID 6550 Comm syz-executor122 Not tainted 5.16.0-rc4-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011 RIP 0010__lock_acquire+0xd7d/0x54a0 kernel/locking/lockdep.c4897 Code 0f 0e 41 be 01 00 00 00 0f 86 c8 00 00 00 89 05 69 cc 0f 0e e9 bd 00 00 00 48 b8 00 00 00 00 00 fc ff df 48 89 da 48 c1 ea 03 3c 02 00 0f 85 f3 2f 00 00 48 81 3b 20 75 17 8f 0f 84 52 f3 ff RSP 0018ffffc90001f2f818 EFLAGS 00010016 RAX dffffc0000000000 RBX 0000000000000018 RCX 0000000000000000 RDX 0000000000000003 RSI 0000000000000000 RDI 0000000000000001 RBP 0000000000000000 R08 0000000000000001 R09 0000000000000001 R10 0000000000000000 R11 000000000000000a R12 0000000000000000 R13 ffff88801b98d700 R14 0000000000000000 R15 0000000000000001 FS 00",
    "keyphrases": {
        "rootcause": "traversal of all local MPTCP sockets when deleting an endpoint",
        "weakness": "null pointer dereference",
        "impact": "",
        "vector": "delete endpoint",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "mptcp"
    }
}
