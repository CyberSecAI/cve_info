{
  "cveId": "CVE-2021-47269",
  "version": "1.0.0",
  "timestamp": "2024-12-19T22:22:49.126128+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolvedusb dwc3 ep0 fix NULL pointer exceptionThere is no validation of the index from dwc3_wIndex_to_dep() and we mightbe referring a non-existing ep and trigger a NULL pointer exception. Incertain configurations we might use fewer eps and the index might wronglyindicate a larger ep index than existing.By adding this validation from the patch we can actually report a wrongindex back to the caller.In our usecase we are using a composite device on an older kernel, butupstream might use this fix also. Unfortunately, I cannot describe thehardware for others to reproduce the issue as it is a proprietaryimplementation.[ 82.958261] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000a4[ 82.966891] Mem abort info[ 82.969663] ESR = 0x96000006[ 82.972703] Exception class = DABT (current EL), IL = 32 bits[ 82.978603] SET = 0, FnV = 0[ 82.981642] EA = 0, S1PTW = 0[ 82.984765] Data abort info[ 82.987631] ISV = 0, ISS = 0x00000006[ 82.991449] CM = 0, WnR = 0[ 82.994409] user pgtable 4k pages, 39-bit VAs, pgdp = 00000000c6210ccc[ 83.000999] [00000000000000a4] pgd=0000000053aa5003, pud=0000000053aa5003, pmd=0000000000000000[ 83.009685] Internal error Oops 96000006",
  "keyphrases": {
    "rootcause": "NULL pointer dereference due to missing index validation in dwc3_wIndex_to_dep()",
    "weakness": "Insufficient validation of the index from dwc3_wIndex_to_dep() leading to potential access of non-existent endpoint",
    "impact": [
      "Kernel crash due to NULL pointer dereference",
      "Oops"
    ],
    "vector": "Accessing a non-existent endpoint due to an invalid index.",
    "attacker": "An attacker or misconfiguration triggering an invalid index.",
    "product": "Linux Kernel",
    "version": "Older kernel (version unspecified)",
    "component": "USB DWC3 driver"
  },
  "mitreTechnicalImpacts": []
}