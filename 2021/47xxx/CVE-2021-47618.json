{
    "cveId": "CVE-2021-47618",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ARM 9170/1 fix panic when kasan and kprobe are enabled arm32 uses software to simulate the instruction replaced by kprobe. some instructions may be simulated by constructing assembly functions. therefore, before executing instruction simulation, it is necessary to construct assembly function execution environment in C language through binding registers. after kasan is enabled, the register binding relationship will be destroyed, resulting in instruction simulation errors and causing kernel panic. the kprobe emulate instruction function is distributed in three files actions-common.c actions-arm.c actions-thumb.c, so disable KASAN when compiling these files. for example, use kprobe insert on cap_capable+20 after kasan enabled, the cap_capable assembly code is as follows e92d47f0push{r4, r5, r6, r7, r8, r9, sl, lr} e1a05000movr5, r0 e280006caddr0, r0, #108 0x6c e1a04001movr4, r1 e1a06002movr6, r2 e59fa090ldrsl, [pc, #144] ebfc7bf8blc03aa4b4 e595706cldrr7, [r5, #108] 0x6c e2859014addr9, r5, #20 ...... The emulate_ldr assembly code after enabling kasan is as follows c06f1384 e92d47f0push{r4, r5, r6, r7, r8, r9, sl, lr} e282803caddr8, r2, #60 0x3c e1a05000movr5, r0 e7e37855ubfxr7, r5, #16, #4 e1a00008movr0, r8 e1a09001movr9, r1 e1a04002movr4, r2 ebf35462blc03c6530 e357000fcmpr7, #15 e7e36655ubfxr6, r5, #12, #4 e205a00fandsl, r5, #",
    "keyphrases": {
        "rootcause": "inconsistent register binding",
        "weakness": "",
        "impact": "kernel panic",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": ""
    }
}
