{
    "cveId": "CVE-2021-47462",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mm/mempolicy do not allow illegal MPOL_F_NUMA_BALANCING | MPOL_LOCAL in mbind() syzbot reported access to unitialized memory in mbind() [1] Issue came with commit bda420b98505 (numa balancing migrate on fault among multiple bound nodes) This commit added a new bit in MPOL_MODE_FLAGS, but only checked valid combination (MPOL_F_NUMA_BALANCING can only be used with MPOL_BIND) in do_set_mempolicy() This patch moves the check in sanitize_mpol_flags() so that it is also used by mbind() [1] BUG KMSAN uninit-value in __mpol_equal+0x567/0x590 mm/mempolicy.c2260 __mpol_equal+0x567/0x590 mm/mempolicy.c2260 mpol_equal include/linux/mempolicy.h105 [inline] vma_merge+0x4a1/0x1e60 mm/mmap.c1190 mbind_range+0xcc8/0x1e80 mm/mempolicy.c811 do_mbind+0xf42/0x15f0 mm/mempolicy.c1333 kernel_mbind mm/mempolicy.c1483 [inline] __do_sys_mbind mm/mempolicy.c1490 [inline] __se_sys_mbind+0x437/0xb80 mm/mempolicy.c1486 __x64_sys_mbind+0x19d/0x200 mm/mempolicy.c1486 do_syscall_x64 arch/x86/entry/common.c51 [inline] do_syscall_64+0x54/0xd0 arch/x86/entry/common.c82 entry_SYSCALL_64_after_hwframe+0x44/0xae Uninit was created at slab_alloc_node mm/slub.c3221 [inline] slab_alloc mm/slub.c3230 [inline] kmem_cache_alloc+0x751/0xff0 mm/slub.c3235 mpol_new mm/mempolicy.c293 [inline] do_mbind+0x912/0x15f0 mm/mempolicy.c1289 kernel_mbind mm/mempolicy.c1483 [i",
    "keyphrases": {
        "rootcause": "access to uninitialized memory",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "mm/mempolicy"
    }
}
