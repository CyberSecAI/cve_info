{
    "cveId": "CVE-2021-47399",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ixgbe Fix NULL pointer dereference in ixgbe_xdp_setup The ixgbe driver currently generates a NULL pointer dereference with some machine (online cpus ring_feature[RING_F_FDIR].limit = count It becomes 63. When user use xdp, ixgbe_set_rss_queues will set queues num. adapter->num_rx_queues = rss_i adapter->num_tx_queues = rss_i adapter->num_xdp_queues = ixgbe_xdp_queues(adapter) And rss_is value is from f = &adapter->ring_feature[RING_F_FDIR] rss_i = f->indices = f->limit So num_rx_queues > num_xdp_queues, when run to ixgbe_xdp_setup, for (i = 0 i num_rx_queues i++) if (adapter->xdp_ring[i]->xsk_umem) It leads to panic. Call trace [exception RIP ixgbe_xdp+368] RIP ffffffffc02a76a0 RSP ffff9fe16202f8d0 RFLAGS 00010297 RAX 0000000000000000 RBX 0000000000000020 RCX 0000000000000000 RDX 0000000000000000 RSI 000000000000001c RDI ffffffffa94ead90 RBP ffff92f8f24c0c18 R8 0000000000000000 R9 0000000000000000 R10 ffff9fe16202f830 R11 0000000000000000 R12 ffff92f8f24c0000 R13 ffff9fe16202fc01 R14 000000000000000a R15 ffffffffc02a7530 ORIG_RAX ffffffffffffffff CS 001"
}
