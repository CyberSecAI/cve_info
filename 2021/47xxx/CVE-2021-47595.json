{
    "cveId": "CVE-2021-47595",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net/sched sch_ets dont remove idle classes from the round-robin list Shuang reported that the following script 1) tc qdisc add dev ddd0 handle 10 parent 1 ets bands 8 strict 4 priomap 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 2) mausezahn ddd0 -A 10.10.10.1 -B 10.10.10.2 -c 0 -a own -b 00c1a0c1a000 -t udp & 3) tc qdisc change dev ddd0 handle 10 ets bands 4 strict 2 quanta 2500 2500 priomap 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 crashes systematically when line 2) is commented list_del corruption, ffff8e028404bd30->next is LIST_POISON1 (dead000000000100) ------------[ cut here ]------------ kernel BUG at lib/list_debug.c47! invalid opcode 0000 [#1] PREEMPT SMP NOPTI CPU 0 PID 954 Comm tc Not tainted 5.16.0-rc4+ #478 Hardware name Red Hat KVM, BIOS 1.11.1-4.module+el8.1.0+4066+0f1aadab 04/01/2014 RIP 0010__list_del_entry_valid.cold.1+0x12/0x47 Code fe ff 0f 0b 48 89 c1 4c 89 c6 48 c7 c7 08 42 1b 87 e8 1d c5 fe ff 0f 0b 48 89 fe 48 89 c2 48 c7 c7 98 42 1b 87 e8 09 c5 fe ff 0b 48 c7 c7 48 43 1b 87 e8 fb c4 fe ff 0f 0b 48 89 f2 48 89 fe RSP 0018ffffae46807a3888 EFLAGS 00010246 RAX 000000000000004e RBX 0000000000000007 RCX 0000000000000202 RDX 0000000000000000 RSI ffffffff871ac536 RDI 00000000ffffffff RBP ffffae46807a3a10 R08 0000000000000000 R09 c0000000ffff7fff R10 0000000000000001 R11 ffffae46807a36a8 R12 ffff8e028404b800 R13 ffff8e028404bd30 R14 dead000000000100",
    "keyphrases": {
        "rootcause": "",
        "weakness": "list_del corruption",
        "impact": "",
        "vector": "specific network configuration",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net/sched sch_ets"
    }
}
