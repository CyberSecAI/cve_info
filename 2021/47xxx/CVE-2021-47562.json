{
    "cveId": "CVE-2021-47562",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ice fix vsi->txq_map sizing The approach of having XDP queue per CPU regardless of users setting exposed a hidden bug that could occur in case when Rx queue count differ from Tx queue count. Currently vsi->txq_maps size is equal to the doubled vsi->alloc_txq, which is not correct due to the fact that XDP rings were previously based on the Rx queue count. Below splat can be seen when ethtool -L is used and XDP rings are configured [ 682.875339] BUG kernel NULL pointer dereference, address 000000000000000f [ 682.883403] #PF supervisor read access in kernel mode [ 682.889345] #PF error_code(0x0000) - not-present page [ 682.895289] PGD 0 P4D 0 [ 682.898218] Oops 0000 [#1] PREEMPT SMP PTI [ 682.903055] CPU 42 PID 2878 Comm ethtool Tainted G OE 5.15.0-rc5+ #1 [ 682.912214] Hardware name Intel Corp. GRANTLEY/GRANTLEY, BIOS GRRFCRB1.86B.0276.D07.1605190235 05/19/2016 [ 682.923380] RIP 0010devres_remove+0x44/0x130 [ 682.928527] Code 49 89 f4 55 48 89 fd 4c 89 ff 53 48 83 ec 10 e8 92 b9 49 00 48 8b 9d a8 02 00 00 48 8d 8d a0 02 00 00 49 89 c2 48 39 cb 74 0f 3b 63 10 74 25 48 8b 5b 08 48 39 cb 75 f1 4c 89 ff 4c 89 d6 e8 [ 682.950237] RSP 0018ffffc90006a679f0 EFLAGS 00010002 [ 682.956285] RAX 0000000000000286 RBX ffffffffffffffff RCX ffff88908343a370 [ 682.964538] RDX 0000000000000001 RSI ffffffff81690d60 RDI 0000000000000000 [ 682.972789] RBP ffff88908343a0d0",
    "keyphrases": {
        "rootcause": "vsi->txq_map sizing approach",
        "weakness": "",
        "impact": "hidden bug",
        "vector": "ethtool -L",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "XDP rings"
    }
}
