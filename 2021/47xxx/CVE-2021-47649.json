{
    "cveId": "CVE-2021-47649",
    "version": "1.0.0",
    "timestamp": "2025-07-04T16:12:41.853043+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved udmabuf validate ubuf->pagecount Syzbot has reported GPF in sg_alloc_append_table_from_pages(). The problem was in ubuf->pages == ZERO_PTR. ubuf->pagecount is calculated from arguments passed from user-space. If user creates udmabuf with list.size == 0 then ubuf->pagecount will be also equal to zero it causes kmalloc_array() to return ZERO_PTR. Fix it by validating ubuf->pagecount before passing it to kmalloc_array().",
    "keyphrases": {
        "rootcause": "ubuf->pages == ZERO_PTR",
        "weakness": "",
        "impact": "GPF in sg_alloc_append_table_from_pages()",
        "vector": "create udmabuf with list.size == 0",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "udmabuf"
    }
}
