{
    "cveId": "CVE-2021-47418",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved net_sched fix NULL deref in fifo_set_limit() syzbot reported another NULL deref in fifo_set_limit() [1] I could repro the issue with unshare -n tc qd add dev lo root handle 10 tbf limit 200000 burst 70000 rate 100Mbit tc qd replace dev lo parent 10 pfifo_fast tc qd change dev lo root handle 10 tbf limit 300000 burst 70000 rate 100Mbit pfifo_fast does not have a change() operation. Make fifo_set_limit() more robust about this. [1] BUG kernel NULL pointer dereference, address 0000000000000000 PGD 1cf99067 P4D 1cf99067 PUD 7ca49067 PMD 0 Oops 0010 [#1] PREEMPT SMP KASAN CPU 1 PID 14443 Comm syz-executor959 Not tainted 5.15.0-rc3-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011 RIP 00100x0 Code Unable to access opcode bytes at RIP 0xffffffffffffffd6. RSP 0018ffffc9000e2f7310 EFLAGS 00010246 RAX dffffc0000000000 RBX ffffffff8d6ecc00 RCX 0000000000000000 RDX 0000000000000000 RSI ffff888024c27910 RDI ffff888071e34000 RBP ffff888071e34000 R08 0000000000000001 R09 ffffffff8fcfb947 R10 0000000000000001 R11 0000000000000000 R12 ffff888024c27910 R13 ffff888071e34018 R14 0000000000000000 R15 ffff88801ef74800 FS 00007f321d897700(0000) GSffff8880b9d00000(0000) knlGS0000000000000000 CS 0010 DS 0000 ES 0000 CR0 0000000080050033 CR2 ffffffffffffffd6 CR3 00000000722c3000 CR4 00000000003506e0 DR0 0000000000000000 DR1 000000",
    "keyphrases": {
        "rootcause": "NULL dereference",
        "weakness": "",
        "impact": "",
        "vector": "unshare -n tc qd add dev lo root handle 10 tbf limit 200000 burst 70000 rate 100Mbit",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "net_sched"
    }
}
