{
    "cveId": "CVE-2021-47106",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved netfilter nf_tables fix use-after-free in nft_set_catchall_destroy() We need to use list_for_each_entry_safe() iterator because we can not access @catchall after kfree_rcu() call. syzbot reported BUG KASAN use-after-free in nft_set_catchall_destroy net/netfilter/nf_tables_api.c4486 [inline] BUG KASAN use-after-free in nft_set_destroy net/netfilter/nf_tables_api.c4504 [inline] BUG KASAN use-after-free in nft_set_destroy+0x3fd/0x4f0 net/netfilter/nf_tables_api.c4493 Read of size 8 at addr ffff8880716e5b80 by task syz-executor.3/8871 CPU 1 PID 8871 Comm syz-executor.3 Not tainted 5.16.0-rc5-syzkaller #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011 Call Trace __dump_stack lib/dump_stack.c88 [inline] dump_stack_lvl+0xcd/0x134 lib/dump_stack.c106 print_address_description.constprop.0.cold+0x8d/0x2ed mm/kasan/report.c247 __kasan_report mm/kasan/report.c433 [inline] kasan_report.cold+0x83/0xdf mm/kasan/report.c450 nft_set_catchall_destroy net/netfilter/nf_tables_api.c4486 [inline] nft_set_destroy net/netfilter/nf_tables_api.c4504 [inline] nft_set_destroy+0x3fd/0x4f0 net/netfilter/nf_tables_api.c4493 __nft_release_table+0x79f/0xcd0 net/netfilter/nf_tables_api.c9626 nft_rcv_nl_event+0x4f8/0x670 net/netfilter/nf_tables_api.c9688 notifier_call_chain+0xb5/0x200 kernel/notifier.c83 blocking_notifier_call_chain kernel/notifier.c"
}
