{
    "cveId": "CVE-2021-47292",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedio_uring fix memleak in io_init_wq_offload()I got memory leak report when doing fuzz testBUG memory leakunreferenced object 0xffff888107310a80 (size 96)comm syz-executor.6, pid 4610, jiffies 4295140240 (age 20.135s)hex dump (first 32 bytes)01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00 .....N..........backtrace[] kmalloc include/linux/slab.h591 [inline][] kzalloc include/linux/slab.h721 [inline][] io_init_wq_offload fs/io_uring.c7920 [inline][] io_uring_alloc_task_context+0x466/0x640 fs/io_uring.c7955[] __io_uring_add_tctx_node+0x256/0x360 fs/io_uring.c9016[] io_uring_add_tctx_node fs/io_uring.c9052 [inline][] __do_sys_io_uring_enter fs/io_uring.c9354 [inline][] __se_sys_io_uring_enter fs/io_uring.c9301 [inline][] __x64_sys_io_uring_enter+0xabc/0xc20 fs/io_uring.c9301[] do_syscall_x64 arch/x86/entry/common.c50 [inline][] do_syscall_64+0x3b/0x90 arch/x86/entry/common.c80[] entry_SYSCALL_64_after_hwframe+0x44/0xaeCPU0 CPU1io_uring_enter io_uring_enterio_uring_add_tctx_node io_uring_add_tctx_node__io_uring_add_tctx_node __io_uring_add_tctx_nodeio_uring_alloc_task_context io_uring_alloc_task_contextio_init_wq_offload io_init_wq_offloadhash = kzalloc hash = kzallocctx->hash_map = hash ctx->hash_map = hash <- one of the hash is leakedWhen calling io_uring_enter() in parallel, the hash_map will be leaked,add uring_lock to protect hash_map.",
    "keyphrases": {
        "rootcause": "The hash_map in io_uring_alloc_task_context is leaked due to a race condition when calling io_uring_enter() in parallel.",
        "weakness": "Race condition in io_uring_enter() when allocating hash_map.",
        "impact": "Memory leak.",
        "vector": "Parallel calls to io_uring_enter()",
        "attacker": "Local user",
        "product": "Linux Kernel",
        "version": "",
        "component": "io_uring"
    }
}
