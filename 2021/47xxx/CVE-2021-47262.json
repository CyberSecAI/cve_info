{
    "cveId": "CVE-2021-47262",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved KVM x86 Ensure liveliness of nested VM-Enter fail tracepoint message Use the __string() machinery provided by the tracing subystem to make a copy of the string literals consumed by the nested VM-Enter failed tracepoint. A complete copy is necessary to ensure that the tracepoint cant outlive the data/memory it consumes and deference stale memory. Because the tracepoint itself is defined by kvm, if kvm-intel and/or kvm-amd are built as modules, the memory holding the string literals defined by the vendor modules will be freed when the module is unloaded, whereas the tracepoint and its data in the ring buffer will live until kvm is unloaded (or indefinitely if kvm is built-in). This bug has existed since the tracepoint was added, but was recently exposed by a new check in tracing to detect exactly this type of bug. fmt %s%s current_buffer vmx_dirty_log_t-140127 [003] .... kvm_nested_vmenter_failed WARNING CPU 3 PID 140134 at kernel/trace/trace.c3759 trace_check_vprintf+0x3be/0x3e0 CPU 3 PID 140134 Comm less Not tainted 5.13.0-rc1-ce2e73ce600a-req #184 Hardware name ASUS Q87M-E/Q87M-E, BIOS 1102 03/03/2014 RIP 0010trace_check_vprintf+0x3be/0x3e0 Code 0b 44 8b 4c 24 1c e9 a9 fe ff ff c6 44 02 ff 00 49 8b 97 b0 20 RSP 0018ffffa895cc37bcb0 EFLAGS 00010282 RAX 0000000000000000 RBX ffffa895cc37bd08 RCX 0000000000000027 RDX 0000000000000027 RSI 000000"
}
