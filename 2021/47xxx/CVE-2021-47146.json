{
    "cveId": "CVE-2021-47146",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved mld fix panic in mld_newpack() mld_newpack() doesnt allow to allocate high order page, only order-0 allocation is allowed. If headroom size is too large, a kernel panic could occur in skb_put(). Test commands ip netns del A ip netns del B ip netns add A ip netns add B ip link add veth0 type veth peer name veth1 ip link set veth0 netns A ip link set veth1 netns B ip netns exec A ip link set lo up ip netns exec A ip link set veth0 up ip netns exec A ip -6 a a 2001db801/64 dev veth0 ip netns exec B ip link set lo up ip netns exec B ip link set veth1 up ip netns exec B ip -6 a a 2001db802/64 dev veth1 for i in {1..99} do let A=$i-1 ip netns exec A ip link add ip6gre$i type ip6gre \\ local 2001db8$A1 remote 2001db8$A2 encaplimit 100 ip netns exec A ip -6 a a 2001db8$i1/64 dev ip6gre$i ip netns exec A ip link set ip6gre$i up ip netns exec B ip link add ip6gre$i type ip6gre \\ local 2001db8$A2 remote 2001db8$A1 encaplimit 100 ip netns exec B ip -6 a a 2001db8$i2/64 dev ip6gre$i ip netns exec B ip link set ip6gre$i up done Splat looks like kernel BUG at net/core/skbuff.c110! invalid opcode 0000 [#1] SMP DEBUG_PAGEALLOC KASAN PTI CPU 0 PID 7 Comm kworker/01 Not tainted 5.12.0+ #891 Workqueue ipv6_addrconf addrconf_dad_work RIP 0010skb_panic+0x15d/0x15f",
    "keyphrases": {
        "rootcause": "",
        "weakness": "If headroom size is too large",
        "impact": "kernel panic",
        "vector": "large headroom",
        "attacker": "",
        "product": "Linux kernel",
        "version": "5.12.0+",
        "component": "mld_newpack()"
    }
}
