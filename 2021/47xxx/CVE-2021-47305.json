{
    "cveId": "CVE-2021-47305",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved dma-buf/sync_file Dont leak fences on merge failure Each add_fence() call does a dma_fence_get() on the relevant fence. In the error path, we werent calling dma_fence_put() so all those fences got leaked. Also, in the krealloc_array failure case, we werent freeing the fences array. Instead, ensure that i and fences are always zero-initialized and dma_fence_put() all the fences and kfree(fences) on every error path.",
    "keyphrases": {
        "rootcause": "lack of dma_fence_put() on the error path and in krealloc_array failure case",
        "weakness": "",
        "impact": "memory leak",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "dma-buf/sync_file"
    }
}
