{
  "cveId": "CVE-2021-47328",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved scsi iscsi Fix conn use after free during resets If we havent done a unbind target call we can race where iscsi_conn_teardown wakes up the EH thread and then frees the conn while those threads are still accessing the conn ehwait. We can only do one TMF per session so this just moves the TMF fields from the conn to the session. We can then rely on the iscsi_session_teardown->iscsi_remove_session->__iscsi_unbind_session call to remove the target and its devices, and know after that point there is no device or scsi-ml callout trying to access the session.",
  "keyphrases": {
    "rootcause": [
      "race condition",
      "use after free"
    ],
    "weakness": "",
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "scsi iscsi"
  },
  "mitreTechnicalImpacts": []
}