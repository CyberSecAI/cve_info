{
  "cveId": "CVE-2021-47492",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved mm, thp bail out early in collapse_file for writeback page Currently collapse_file does not explicitly check PG_writeback, instead, page_has_private and try_to_release_page are used to filter writeback pages. This does not work for xfs with blocksize equal to or larger than pagesize, because in such case xfs has no page->private. This makes collapse_file bail out early for writeback page. Otherwise, xfs end_page_writeback will panic as follows. pagefffffe00201bcc80 refcount0 mapcount0 mappingffff0003f88c86a8 index0x0 pfn0x84ef32 aopsxfs_address_space_operations [xfs] ino30000b7 dentry namelibtest.so flags 0x57fffe0000008027(locked|referenced|uptodate|active|writeback) raw 57fffe0000008027 ffff80001b48bc28 ffff80001b48bc28 ffff0003f88c86a8 raw 0000000000000000 0000000000000000 00000000ffffffff ffff0000c3e9a000 page dumped because VM_BUG_ON_PAGE(((unsigned int) page_ref_count(page) + 127u mem_cgroupffff0000c3e9a000 ------------[ cut here ]------------ kernel BUG at include/linux/mm.h1212! Internal error Oops - BUG 0 [#1] SMP Modules linked in BUG Bad page state in process khugepaged pfn84ef32 xfs(E) pagefffffe00201bcc80 refcount0 mapcount0 mapping0 index0x0 pfn0x84ef32 libcrc32c(E) rfkill(E) aes_ce_blk(E) crypto_simd(E) ... CPU 25 PID 0 Comm swapper/25 Kdump loaded Tainted ... pstate 60400005 (nZCv daif +PAN -UAO -TCO",
  "keyphrases": {
    "rootcause": "improper writeback page filtering",
    "weakness": "",
    "impact": [
      "Oops",
      "kernel BUG",
      "panic"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "mm"
  },
  "mitreTechnicalImpacts": []
}