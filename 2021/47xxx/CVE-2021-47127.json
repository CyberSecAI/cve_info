{
    "cveId": "CVE-2021-47127",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved ice track AF_XDP ZC enabled queues in bitmap Commit c7a219048e45 (ice Remove xsk_buff_pool from VSI structure) silently introduced a regression and broke the Tx side of AF_XDP in copy mode. xsk_pool on ice_ring is set only based on the existence of the XDP prog on the VSI which in turn picks ice_clean_tx_irq_zc to be executed. That is not something that should happen for copy mode as it should use the regular data path ice_clean_tx_irq. This results in a following splat when xdpsock is run in txonly or l2fwd scenarios in copy mode [ 106.050195] BUG kernel NULL pointer dereference, address 0000000000000030 [ 106.057269] #PF supervisor read access in kernel mode [ 106.062493] #PF error_code(0x0000) - not-present page [ 106.067709] PGD 0 P4D 0 [ 106.070293] Oops 0000 [#1] PREEMPT SMP NOPTI [ 106.074721] CPU 61 PID 0 Comm swapper/61 Not tainted 5.12.0-rc2+ #45 [ 106.081436] Hardware name Intel Corporation S2600WFT/S2600WFT, BIOS SE5C620.86B.02.01.0008.031920191559 03/19/2019 [ 106.092027] RIP 0010xp_raw_get_dma+0x36/0x50 [ 106.096551] Code 74 14 48 b8 ff ff ff ff ff ff 00 00 48 21 f0 48 c1 ee 30 48 01 c6 48 8b 87 90 00 00 00 48 89 f2 81 e6 ff 0f 00 00 48 c1 ea 0c 8b 04 d0 48 83 e0 fe 48 01 f0 c3 66 66 2e 0f 1f 84 00 00 00 00 [ 106.115588] RSP 0018ffffc9000d694e50 EFLAGS 00010206 [ 106.120893] RAX 0000000000000000 RBX ffff88984b8c8a00 RCX ffff889852581800 [ 106.12",
    "keyphrases": {
        "rootcause": "regression in ice_clean_tx_irq_zc",
        "weakness": "",
        "impact": "kernel panic",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "ice track AF_XDP ZC enabled queues"
    }
}
