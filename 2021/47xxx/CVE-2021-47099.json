{
    "cveId": "CVE-2021-47099",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved veth ensure skb entering GRO are not cloned. After commit d3256efd8e8b (veth allow enabling NAPI even without XDP), if GRO is enabled on a veth device and TSO is disabled on the peer device, TCP skbs will go through the NAPI callback. If there is no XDP program attached, the veth code does not perform any share check, and shared/cloned skbs could enter the GRO engine. Ignat reported a BUG triggered later-on due to the above condition [ 53.970529][ C1] kernel BUG at net/core/skbuff.c3574! [ 53.981755][ C1] invalid opcode 0000 [#1] PREEMPT SMP KASAN PTI [ 53.982634][ C1] CPU 1 PID 19 Comm ksoftirqd/1 Not tainted 5.16.0-rc5+ #25 [ 53.982634][ C1] Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 0.0.0 02/06/2015 [ 53.982634][ C1] RIP 0010skb_shift+0x13ef/0x23b0 [ 53.982634][ C1] Code ea 03 0f b6 04 02 48 89 fa 83 e2 07 38 d0 7f 08 84 c0 0f 85 41 0c 00 00 41 80 7f 02 00 4d 8d b5 d0 00 00 00 0f 85 74 f5 ff ff 0b 4d 8d 77 20 be 04 00 00 00 4c 89 44 24 78 4c 89 f7 4c 89 8c [ 53.982634][ C1] RSP 0018ffff8881008f7008 EFLAGS 00010246 [ 53.982634][ C1] RAX 0000000000000000 RBX ffff8881180b4c80 RCX 0000000000000000 [ 53.982634][ C1] RDX 0000000000000002 RSI ffff8881180b4d3c RDI ffff88810bc9cac2 [ 53.982634][ C1] RBP ffff8881008f70b8 R08 ffff8881180b4cf4 R09 ffff8881180b4cf0 [ 53.982634][ C1] R10 ffffed1022999e5c R11 00000000",
    "keyphrases": {
        "rootcause": "invalid opcode",
        "weakness": "",
        "impact": "kernel BUG",
        "vector": "shared/cloned skbs could enter the GRO engine",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "veth"
    }
}
