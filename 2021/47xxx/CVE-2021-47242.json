{
    "cveId": "CVE-2021-47242",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedmptcp fix soft lookup in subflow_error_report()Maxim reported a soft lookup in subflow_error_report() watchdog BUG soft lockup - CPU#0 stuck for 22s! [swapper/00] RIP 0010native_queued_spin_lock_slowpath RSP 0018ffffa859c0003bc0 EFLAGS 00000202 RAX 0000000000000101 RBX 0000000000000001 RCX 0000000000000000 RDX ffff9195c2772d88 RSI 0000000000000000 RDI ffff9195c2772d88 RBP ffff9195c2772d00 R08 00000000000067b0 R09 c6e31da9eb1e44f4 R10 ffff9195ef379700 R11 ffff9195edb50710 R12 ffff9195c2772d88 R13 ffff9195f500e3d0 R14 ffff9195ef379700 R15 ffff9195ef379700 FS 0000000000000000(0000) GSffff91961f400000(0000) knlGS0000000000000000 CS 0010 DS 0000 ES 0000 CR0 0000000080050033 CR2 000000c000407000 CR3 0000000002988000 CR4 00000000000006f0 Call Trace _raw_spin_lock_bh subflow_error_report mptcp_subflow_data_available __mptcp_move_skbs_from_subflow mptcp_data_ready tcp_data_queue tcp_rcv_established tcp_v4_do_rcv tcp_v4_rcv ip_protocol_deliver_rcu ip_local_deliver_finish __netif_receive_skb_one_core netif_receive_skb rtl8139_poll 8139too __napi_poll net_rx_action __do_softirq __irq_exit_rcu common_interrupt The calling function - mptcp_subflow_data_available() - can be invokedfrom different contexts- plain ssk socket lock- ssk socket lock + mptcp_data_lock- ssk socket lock + mptcp_data_lock + msk socket lock.Since subflow_error_report() tries to acquire the mptcp_data_lock, thelatter two call chains will cause soft lookup.This change addresses the issue moving the error reporting call toouter functions, where the held locks list is known and the we canacquire only the needed one.",
    "keyphrases": {
        "rootcause": "soft lookup in subflow_error_report() due to incorrect locking order",
        "weakness": "incorrect locking order causing deadlock",
        "impact": "system hang or denial of service due to soft lockup",
        "vector": "network traffic triggering the vulnerable code path",
        "attacker": "unspecified, could be a remote attacker sending network packets",
        "product": "Linux Kernel",
        "version": "unspecified",
        "component": "mptcp"
    }
}
