{
  "cveId": "CVE-2021-47197",
  "version": "1.0.0",
  "timestamp": "2024-12-06T11:32:07.789868+00:00",
  "description": "In the Linux kernel, the following vulnerability has been resolved net/mlx5e nullify cq->dbg pointer in mlx5_debug_cq_remove() Prior to this patch in case mlx5_core_destroy_cq() failed it proceeds to rest of destroy operations. mlx5_core_destroy_cq() could be called again by user and cause additional call of mlx5_debug_cq_remove(). cq->dbg was not nullify in previous call and cause the crash. Fix it by nullify cq->dbg pointer after removal. Also proceed to destroy operations only if FW return 0 for MLX5_CMD_OP_DESTROY_CQ command. general protection fault, probably for non-canonical address 0x2000300004058 0000 [#1] SMP PTI CPU 5 PID 1228 Comm python Not tainted 5.15.0-rc5_for_upstream_min_debug_2021_10_14_11_06 #1 Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014 RIP 0010lockref_get+0x1/0x60 Code 5d e9 53 ff ff ff 48 8d 7f 70 e8 0a 2e 48 00 c7 85 d0 00 00 00 02 00 00 00 c6 45 70 00 fb 5d c3 c3 cc cc cc cc cc cc cc cc 53 8b 17 48 89 fb 85 d2 75 3d 48 89 d0 bf 64 00 00 00 48 89 c1 48 RSP 0018ffff888137dd7a38 EFLAGS 00010206 RAX 0000000000000000 RBX ffff888107d5f458 RCX 00000000fffffffe RDX 000000000002c2b0 RSI ffffffff8155e2e0 RDI 0002000300004058 RBP ffff888137dd7a88 R08 0002000300004058 R09 ffff8881144a9f88 R10 0000000000000000 R11 0000000000000000 R12 ffff8881141d4000 R13 ffff888137dd7c68 R14 ffff888137dd7d58 R15 ffff888137dd7cc0 FS 00007f4644f2a4c0(0000) GSffff8887a2d40000",
  "keyphrases": {
    "rootcause": "cq->dbg was not nullify in previous call",
    "weakness": "crash",
    "impact": [
      "crash",
      "general protection fault"
    ],
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "net/mlx5e"
  },
  "mitreTechnicalImpacts": []
}