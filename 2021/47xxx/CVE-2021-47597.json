{
    "cveId": "CVE-2021-47597",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved inet_diag fix kernel-infoleak for UDP sockets KMSAN reported a kernel-infoleak [1], that can exploited by unpriv users. After analysis it turned out UDP was not initializing r->idiag_expires. Other users of inet_sk_diag_fill() might make the same mistake in the future, so fix this in inet_sk_diag_fill(). [1] BUG KMSAN kernel-infoleak in instrument_copy_to_user include/linux/instrumented.h121 [inline] BUG KMSAN kernel-infoleak in copyout lib/iov_iter.c156 [inline] BUG KMSAN kernel-infoleak in _copy_to_iter+0x69d/0x25c0 lib/iov_iter.c670 instrument_copy_to_user include/linux/instrumented.h121 [inline] copyout lib/iov_iter.c156 [inline] _copy_to_iter+0x69d/0x25c0 lib/iov_iter.c670 copy_to_iter include/linux/uio.h155 [inline] simple_copy_to_iter+0xf3/0x140 net/core/datagram.c519 __skb_datagram_iter+0x2cb/0x1280 net/core/datagram.c425 skb_copy_datagram_iter+0xdc/0x270 net/core/datagram.c533 skb_copy_datagram_msg include/linux/skbuff.h3657 [inline] netlink_recvmsg+0x660/0x1c60 net/netlink/af_netlink.c1974 sock_recvmsg_nosec net/socket.c944 [inline] sock_recvmsg net/socket.c962 [inline] sock_read_iter+0x5a9/0x630 net/socket.c1035 call_read_iter include/linux/fs.h2156 [inline] new_sync_read fs/read_write.c400 [inline] vfs_read+0x1631/0x1980 fs/read_write.c481 ksys_read+0x28c/0x520 fs/read_write.c619 __do_sys_read fs/read_write.c629 [inline] __se_sys_read fs/read_write.",
    "keyphrases": {
        "rootcause": "UDP was not initializing r->idiag_expires",
        "weakness": "",
        "impact": "kernel-infoleak",
        "vector": "",
        "attacker": "unpriv users",
        "product": "Linux kernel",
        "version": "",
        "component": "inet_diag"
    }
}
