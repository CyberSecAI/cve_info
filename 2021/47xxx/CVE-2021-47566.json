{
    "cveId": "CVE-2021-47566",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved proc/vmcore fix clearing user buffer by properly using clear_user() To clear a user buffer we cannot simply use memset, we have to use clear_user(). With a virtio-mem device that registers a vmcore_cb and has some logically unplugged memory inside an added Linux memory block, I can easily trigger a BUG by copying the vmcore via cp systemd[1] Starting Kdump Vmcore Save Service... kdump[420] Kdump is using the default log level(3). kdump[453] saving to /sysroot/var/crash/127.0.0.1-2021-11-11-145922/ kdump[458] saving vmcore-dmesg.txt to /sysroot/var/crash/127.0.0.1-2021-11-11-145922/ kdump[465] saving vmcore-dmesg.txt complete kdump[467] saving vmcore BUG unable to handle page fault for address 00007f2374e01000 #PF supervisor write access in kernel mode #PF error_code(0x0003) - permissions violation PGD 7a523067 P4D 7a523067 PUD 7a528067 PMD 7a525067 PTE 800000007048f867 Oops 0003 [#1] PREEMPT SMP NOPTI CPU 0 PID 468 Comm cp Not tainted 5.15.0+ #6 Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.14.0-27-g64f37cc530f1-prebuilt.qemu.org 04/01/2014 RIP 0010read_from_oldmem.part.0.cold+0x1d/0x86 Code ff ff ff e8 05 ff fe ff e9 b9 e9 7f ff 48 89 de 48 c7 c7 38 3b 60 82 e8 f1 fe fe ff 83 fd 08 72 3c 49 8d 7d 08 4c 89 e9 89 e8 c7 45 00 00 00 00 00 49 c7 44 05 f8 00 00 00 00 48 83 e7 f81 RSP 0018ffffc9000073be08 EFLAGS 00010212 RAX 00",
    "keyphrases": {
        "rootcause": "improper use of clear_user() to clear user buffer",
        "weakness": "",
        "impact": "BUG (kernel panic)",
        "vector": "copying vmcore via cp command",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "proc/vmcore"
    }
}
