{
    "cveId": "CVE-2021-30159",
    "version": "1.0.0",
    "timestamp": "2024-12-15T20:24:27.876763+00:00",
    "description": "An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x before 1.35.2. Users can bypass intended restrictions on deleting pages in certain fast double move situations. MovePageisValidMoveTarget() uses FOR UPDATE, but its only called if TitlegetArticleID() returns non-zero with no special flags. Next, MovePagemoveToInternal() will delete the page if getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in the replica DB, isValidMove() will return true, and then moveToInternal() will unconditionally delete the page if it can be found in the master.",
    "keyphrases": {
        "rootcause": "",
        "weakness": "bypass intended restrictions on deleting pages",
        "impact": "delete pages in certain fast double move situations",
        "vector": "",
        "attacker": "",
        "product": "MediaWiki",
        "version": "before 1.31.12 and 1.32.x through 1.35.x before 1.35.2",
        "component": ""
    }
}
