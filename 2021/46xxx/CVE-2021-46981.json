{
    "cveId": "CVE-2021-46981",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved nbd Fix NULL pointer in flush_workqueue Open /dev/nbdX first, the config_refs will be 1 and the pointers in nbd_device are still null. Disconnect /dev/nbdX, then reference a null recv_workq. The protection by config_refs in nbd_genl_disconnect is useless. [ 656.366194] BUG kernel NULL pointer dereference, address 0000000000000020 [ 656.368943] #PF supervisor write access in kernel mode [ 656.369844] #PF error_code(0x0002) - not-present page [ 656.370717] PGD 10cc87067 P4D 10cc87067 PUD 1074b4067 PMD 0 [ 656.371693] Oops 0002 [#1] SMP [ 656.372242] CPU 5 PID 7977 Comm nbd-client Not tainted 5.11.0-rc5-00040-g76c057c84d28 #1 [ 656.373661] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS ?-20190727_073836-buildvm-ppc64le-16.ppc.fedoraproject.org-3.fc31 04/01/2014 [ 656.375904] RIP 0010mutex_lock+0x29/0x60 [ 656.376627] Code 00 0f 1f 44 00 00 55 48 89 fd 48 83 05 6f d7 fe 08 01 e8 7a c3 ff ff 48 83 05 6a d7 fe 08 01 31 c0 65 48 8b 14 25 00 6d 01 00 48 0f b1 55 d [ 656.378934] RSP 0018ffffc900005eb9b0 EFLAGS 00010246 [ 656.379350] RAX 0000000000000000 RBX 0000000000000000 RCX 0000000000000000 [ 656.379915] RDX ffff888104cf2600 RSI ffffffffaae8f452 RDI 0000000000000020 [ 656.380473] RBP 0000000000000020 R08 0000000000000000 R09 ffff88813bd6b318 [ 656.381039] R10 00000000000000c7 R11 fefefefefefefeff R12 ffff888102710b40 [ 656.381599] R13 ffffc900005eb9e0",
    "keyphrases": {
        "rootcause": "NULL pointer dereference",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "flush_workqueue in nbd"
    }
}
