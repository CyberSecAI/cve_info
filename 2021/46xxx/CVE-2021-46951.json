{
    "cveId": "CVE-2021-46951",
    "version": "1.0.0",
    "timestamp": "2024-12-19T22:22:49.126128+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolvedtpm efi Use local variable for calculating final log sizeWhen tpm_read_log_efi is called multiple times, which happens whenone loads and unloads a TPM2 driver multiple times, then the globalvariable efi_tpm_final_log_size will at some point become a negativenumber due to the subtraction of final_events_preboot_size occurringeach time. Use a local variable to avoid this integer underflow.The following issue is now resolvedMar 8 153512 hibinst kernel Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 0.0.0 02/06/2015Mar 8 153512 hibinst kernel Workqueue tpm-vtpm vtpm_proxy_work [tpm_vtpm_proxy]Mar 8 153512 hibinst kernel RIP 0010__memcpy+0x12/0x20Mar 8 153512 hibinst kernel Code 00 b8 01 00 00 00 85 d2 74 0a c7 05 44 7b ef 00 0f 00 00 00 c3 cc cc cc 66 66 90 66 90 48 89 f8 48 89 d1 48 c1 e9 03 83 e2 07 48 a5 89 d1 f3 a4 c3 66 0f 1f 44 00 00 48 89 f8 48 89 d1 f3 a4Mar 8 153512 hibinst kernel RSP 0018ffff9ac4c0fcfde0 EFLAGS 00010206Mar 8 153512 hibinst kernel RAX ffff88f878cefed5 RBX ffff88f878ce9000 RCX 1ffffffffffffe0fMar 8 153512 hibinst kernel RDX 0000000000000003 RSI ffff9ac4c003bff9 RDI ffff88f878cf0e4dMar 8 153512 hibinst kernel RBP ffff9ac4c003b000 R08 0000000000001000 R09 000000007e9d6073Mar 8 153512 hibinst kernel R10 ffff9ac4c003b000 R11 ffff88f879ad3500 R12 0000000000000ed5Mar 8 153512 hibinst kernel R13 ffff88f878ce9760 R14 0000000000000002 R15 ffff88f77de7f018Mar 8 153512 hibinst kernel FS 0000000000000000(0000) GSffff88f87bd00000(0000) knlGS0000000000000000Mar 8 153512 hibinst kernel CS 0010 DS 0000 ES 0000 CR0 0000000080050033Mar 8 153512 hibinst kernel CR2 ffff9ac4c003c000 CR3 00000001785a6004 CR4 0000000000060ee0Mar 8 153512 hibinst kernel Call TraceMar 8 153512 hibinst kernel tpm_read_log_efi+0x152/0x1a7Mar 8 153512 hibinst kernel tpm_bios_log_setup+0xc8/0x1c0Mar 8 153512 hibinst kernel tpm_chip_register+0x8f/0x260Mar 8 153512 hibinst kernel vtpm_proxy_work+0x16/0x60 [tpm_vtpm_proxy]Mar 8 153512 hibinst kernel process_one_work+0x1b4/0x370Mar 8 153512 hibinst kernel worker_thread+0x53/0x3e0Mar 8 153512 hibinst kernel ? process_one_work+0x370/0x370",
    "keyphrases": {
        "rootcause": "Integer underflow in the calculation of the final log size within the tpm_read_log_efi function.",
        "weakness": "Global variable efi_tpm_final_log_size being decremented multiple times without proper reset, leading to a negative value.",
        "impact": "Potential memory corruption or other undefined behavior due to incorrect log size calculation, leading to a kernel crash.",
        "vector": "Multiple calls to the tpm_read_log_efi function, triggered by loading and unloading the TPM2 driver multiple times.",
        "attacker": "A local attacker could potentially exploit this by repeatedly loading and unloading the TPM2 driver.",
        "product": "Linux Kernel",
        "version": "Not specified, but exists in version prior to fix",
        "component": "TPM Driver"
    }
}
