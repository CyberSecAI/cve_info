{
    "cveId": "CVE-2021-46947",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved sfc adjust efx->xdp_tx_queue_count with the real number of initialized queues efx->xdp_tx_queue_count is initially initialized to num_possible_cpus() and is later used to allocate and traverse efx->xdp_tx_queues lookup array. However, we may end up not initializing all the array slots with real queues during probing. This results, for example, in a NULL pointer dereference, when running # ethtool -S , similar to below [2570283.664955][T4126959] BUG kernel NULL pointer dereference, address 00000000000000f8 [2570283.681283][T4126959] #PF supervisor read access in kernel mode [2570283.695678][T4126959] #PF error_code(0x0000) - not-present page [2570283.710013][T4126959] PGD 0 P4D 0 [2570283.721649][T4126959] Oops 0000 [#1] SMP PTI [2570283.734108][T4126959] CPU 23 PID 4126959 Comm ethtool Tainted G O 5.10.20-cloudflare-2021.3.1 #1 [2570283.752641][T4126959] Hardware name [2570283.781408][T4126959] RIP 0010efx_ethtool_get_stats+0x2ca/0x330 [sfc] [2570283.796073][T4126959] Code 00 85 c0 74 39 48 8b 95 a8 0f 00 00 48 85 d2 74 2d 31 c0 eb 07 48 8b 95 a8 0f 00 00 48 63 c8 49 83 c4 08 83 c0 01 48 8b 14 ca 8b 92 f8 00 00 00 49 89 54 24 f8 39 85 a0 0f 00 00 77 d7 48 8b [2570283.831259][T4126959] RSP 0018ffffb79a77657ce8 EFLAGS 00010202 [2570283.845121][T4126959] RAX 0000000000000019 RBX ffffb799cd0c9280 RCX 0000000000000018 [2570283.860872][T4126959] RDX 00",
    "keyphrases": {
        "rootcause": "",
        "weakness": "NULL pointer dereference",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": ""
    }
}
