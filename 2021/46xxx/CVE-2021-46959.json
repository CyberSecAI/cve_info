{
    "cveId": "CVE-2021-46959",
    "version": "1.0.0",
    "timestamp": "2024-12-06T11:32:07.789868+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved spi Fix use-after-free with devm_spi_alloc_* We cant rely on the contents of the devres list during spi_unregister_controller(), as the list is already torn down at the time we perform devres_find() for devm_spi_release_controller. This causes devices registered with devm_spi_alloc_{master,slave}() to be mistakenly identified as legacy, non-devm managed devices and have their reference counters decremented below 0. ------------[ cut here ]------------ WARNING CPU 1 PID 660 at lib/refcount.c28 refcount_warn_saturate+0x108/0x174 [] (refcount_warn_saturate) from [] (kobject_put+0x90/0x98) [] (kobject_put) from [] (put_device+0x20/0x24) r4b6700140 [] (put_device) from [] (devm_spi_release_controller+0x3c/0x40) [] (devm_spi_release_controller) from [] (release_nodes+0x84/0xc4) r5b6700180 r4b6700100 [] (release_nodes) from [] (devres_release_all+0x5c/0x60) r8b1638c54 r7b117ad94 r6b1638c10 r5b117ad94 r4b163dc10 [] (devres_release_all) from [] (__device_release_driver+0x144/0x1ec) r5b117ad94 r4b163dc10 [] (__device_release_driver) from [] (device_driver_detach+0x84/0xa0) r900000000 r800000000 r7b117ad94 r6b163dc54 r5b1638c10 r4b163dc10 [] (device_driver_detach) from [] (unbind_store+0xe4/0xf8) Instead, determine the devm allocati",
    "keyphrases": {
        "rootcause": "use-after-free",
        "weakness": "",
        "impact": "",
        "vector": "",
        "attacker": "",
        "product": "Linux kernel",
        "version": "",
        "component": "spi"
    }
}
