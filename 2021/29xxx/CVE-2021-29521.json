{
    "cveId": "CVE-2021-29521",
    "version": "1.0.0",
    "timestamp": "2024-12-15T20:24:27.876763+00:00",
    "description": "TensorFlow is an end-to-end open source platform for machine learning. Specifying a negative dense shape in `tf.raw_ops.SparseCountSparseOutput` results in a segmentation fault being thrown out from the standard library as `stdvector` invariants are broken. This is because the implementation(https//github.com/tensorflow/tensorflow/blob/8f7b60ee8c0206a2c99802e3a4d1bb55d2bc0624/tensorflow/core/kernels/count_ops.cc#L199-L213) assumes the first element of the dense shape is always positive and uses it to initialize a `BatchedMap` (i.e., `stdvector>`(https//github.com/tensorflow/tensorflow/blob/8f7b60ee8c0206a2c99802e3a4d1bb55d2bc0624/tensorflow/core/kernels/count_ops.cc#L27)) data structure. If the `shape` tensor has more than one element, `num_batches` is the first value in `shape`. Ensuring that the `dense_shape` argument is a valid tensor shape (that is, all elements are non-negative) solves this issue. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2 and TensorFlow 2.3.3.",
    "keyphrases": {
        "rootcause": "broken stdvector invariants",
        "weakness": "",
        "impact": "segmentation fault",
        "vector": "negative dense shape in tf.raw_ops.SparseCountSparseOutput",
        "attacker": "",
        "product": "TensorFlow",
        "version": "before 2.5.0",
        "component": "SparseCountSparseOutput"
    }
}
